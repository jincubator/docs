<!doctype html>
<html lang="en" data-vocs>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="/initializeTheme.iife.js"></script>&lt;script src=&quot;/zoom-mermaid.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;<link rel="preload" as="image" href="/images/jincubator.png"/><link rel="preload" as="image" href="https://hackmd.io/_uploads/ByIAaIhwel.png"/><link rel="preload" as="image" href="https://hackmd.io/_uploads/B1XQRU3wex.png"/><link rel="preload" as="image" href="https://hackmd.io/_uploads/HyRf1vnwgl.png"/><link rel="preload" as="image" href="https://hackmd.io/_uploads/HkytJP3Plg.png"/><link rel="preload" as="image" href="https://hackmd.io/_uploads/ByKclv3Del.png"/><link rel="preload" as="image" href="https://hackmd.io/_uploads/ry6slPnvxg.png"/><link rel="preload" as="image" href="https://hackmd.io/_uploads/BkDBWwhDee.png"/><link rel="preload" as="image" href="https://hackmd.io/_uploads/S12jGDhPge.png"/><link rel="preload" as="image" href="https://hackmd.io/_uploads/HJ-pzD3Peg.png"/><link rel="preload" as="image" href="https://hackmd.io/_uploads/HydB7D3Pxe.png"/><link rel="preload" as="image" href="https://hackmd.io/_uploads/Hkg8QPnvee.png"/><link rel="preload" as="image" href="https://hackmd.io/_uploads/S1tqDDhvgg.png"/><title>No Liquidity Solving (Tycho 1inch) – Jincubator</title><link rel="icon" href="/images/jincubator.png" type="image/png"/><meta property="og:type" content="website"/><meta property="og:title" content="No Liquidity Solving (Tycho 1inch)"/><meta property="og:url" content="/"/><meta property="og:image" content="https://vocs.dev/api/og?logo=//images/jincubator.png&title=No Liquidity Solving (Tycho 1inch)&description="/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:image" content="https://vocs.dev/api/og?logo=//images/jincubator.png&title=No%20Liquidity%20Solving%20(Tycho%201inch)&description=undefined"/>
    <script type="module" crossorigin src="/assets/index-B3aGu-ft.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/style-CgUDpFKq.css">
  </head>
  <body>
    <div id="app"><base href="/"/><div class="vocs_DocsLayout" data-layout="docs"><a class="vocs_SkipLink vocs_utils_visuallyHidden" href="/research/solving/tycho1inchNOL#vocs-content">Skip to content</a><div class="vocs_DocsLayout_gutterLeft"><aside class="vocs_Sidebar vocs_DocsLayout_sidebar"><div><div class="vocs_Sidebar_logoWrapper"><div class="vocs_Sidebar_logo"><a style="align-items:center;display:flex;height:100%" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/images/jincubator.png"/></a></div><div class="vocs_Sidebar_divider"></div></div><nav class="vocs_Sidebar_navigation"><div class="vocs_Sidebar_group"><section class="vocs_Sidebar_section"><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/intro" variant="styleless" data-discover="true">Research</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Solving and Arbitrage (2025)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/solving" variant="styleless" data-discover="true">High Performance Route Evaluation</a><a data-active="true" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/tycho1inchNOL" variant="styleless" data-discover="true">No Liquidity Solving (Tycho 1inch)</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/near" variant="styleless" data-discover="true">Near Contract Development (1inch Contracts)</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/Intents/protocol" variant="styleless" data-discover="true">Liquidity Management with ERC-6909 Vault</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/intent-management-hook" variant="styleless" data-discover="true">Uniswap V4 - Intent Management Hook</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader" role="button" tabindex="0"><div class="vocs_Sidebar_sectionTitle">Layer 1 Platforms (2022/2023)</div><div role="button" tabindex="0"><div aria-label="toggle section" class="vocs_Icon vocs_Sidebar_sectionCollapse" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Right</title><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/intro" variant="styleless" data-discover="true">Layer 1 Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/avalanche" variant="styleless" data-discover="true">Avalanche</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/binance" variant="styleless" data-discover="true">Binance Smart Chain</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/cosmos" variant="styleless" data-discover="true">Cosmos</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/ethereum-1-0" variant="styleless" data-discover="true">Ethereum 1.0</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/ethereum" variant="styleless" data-discover="true">Ethereum</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/NEAR" variant="styleless" data-discover="true">NEAR</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/harmony" variant="styleless" data-discover="true">Harmony</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/polkadot" variant="styleless" data-discover="true">Polkadot</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/polygon" variant="styleless" data-discover="true">Polygon</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Code Reviews (2022/2023)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/intro" variant="styleless" data-discover="true">Code Review Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/horizon" variant="styleless" data-discover="true">Horizon Bridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/ethereum-near" variant="styleless" data-discover="true">Ethereum Near Bridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/ethereum" variant="styleless" data-discover="true">Ethereum</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Cross Chain Bridges (2022/2023)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/intro" variant="styleless" data-discover="true">Bridging Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/cosmos-ibc" variant="styleless" data-discover="true">Cosmos IBC</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/harmony-horizon" variant="styleless" data-discover="true">Harmony Horizon</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/isomorph" variant="styleless" data-discover="true">Isomorph</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/near-rainbow" variant="styleless" data-discover="true">Near Rainbow Bridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/polymerlabs" variant="styleless" data-discover="true">Polymer Labs</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/snowbridge" variant="styleless" data-discover="true">Snowbridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/succinct" variant="styleless" data-discover="true">Succint</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Zero Knowledge (2022/2023)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/intro" variant="styleless" data-discover="true">Zero Knowledge Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/zkpos" variant="styleless" data-discover="true">ZK Proof of Stake</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/zksnarks" variant="styleless" data-discover="true">zk-Snarks</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/axiom" variant="styleless" data-discover="true">Axiom</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Primitives (2022/2023)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/intro" variant="styleless" data-discover="true">Primitives Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/fraud-proofs" variant="styleless" data-discover="true">Fraud Proofs</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/light-clients" variant="styleless" data-discover="true">Light Clients</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/primitives" variant="styleless" data-discover="true">Cryptogaphic Primitives</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/weak-subjectivity" variant="styleless" data-discover="true">Weak Subjectivity</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/signatures" variant="styleless" data-discover="true">Signature Schemes</a></div></section></div></nav></div><div class="vocs_Sidebar_footer"><div class="vocs_Sidebar_footerCurtain"></div><div class="vocs_Sidebar_footerContent"><div class="vocs_Socials"><a class="vocs_Socials_button" href="https://github.com/jincubator" target="_blank" rel="noopener noreferrer"><div aria-label="GitHub" class="vocs_Icon vocs_Socials_icon" role="img" style="--vocs_Icon_size:17px"><svg width="100%" height="100%" viewBox="0 0 98 96" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z" fill="currentColor"></path></svg></div></a><div style="width:1px;margin-top:var(--vocs-space_4);margin-bottom:var(--vocs-space_4);background-color:var(--vocs-color_border)"></div><a class="vocs_Socials_button" href="https://twitter.com/jincubatorX" target="_blank" rel="noopener noreferrer"><div aria-label="X (Twitter)" class="vocs_Icon vocs_Socials_icon" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg"><title>X</title><path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="currentColor"></path></svg></div></a><div style="width:1px;margin-top:var(--vocs-space_4);margin-bottom:var(--vocs-space_4);background-color:var(--vocs-color_border)"></div><a class="vocs_Socials_button" href="https://t.me/jincubator" target="_blank" rel="noopener noreferrer"><div aria-label="Telegram" class="vocs_Icon vocs_Socials_icon" role="img" style="--vocs_Icon_size:17px"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 50 50"><title>Telegram</title><path d="M25 2c12.703 0 23 10.297 23 23S37.703 48 25 48 2 37.703 2 25 12.297 2 25 2zm7.934 32.375c.423-1.298 2.405-14.234 2.65-16.783.074-.772-.17-1.285-.648-1.514-.578-.278-1.434-.139-2.427.219-1.362.491-18.774 7.884-19.78 8.312-.954.405-1.856.847-1.856 1.487 0 .45.267.703 1.003.966.766.273 2.695.858 3.834 1.172 1.097.303 2.346.04 3.046-.395.742-.461 9.305-6.191 9.92-6.693.614-.502 1.104.141.602.644-.502.502-6.38 6.207-7.155 6.997-.941.959-.273 1.953.358 2.351.721.454 5.906 3.932 6.687 4.49.781.558 1.573.811 2.298.811.725 0 1.107-.955 1.468-2.064z" fill="currentColor"></path></svg></div></a></div></div></div></aside></div><div class="vocs_DocsLayout_gutterTop vocs_DocsLayout_gutterTop_offsetLeftGutter"><div class="vocs_DesktopTopNav"><button class="vocs_DesktopSearch_search" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«Rlj»" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-top:2px"><path d="M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>Search...<div class="vocs_DesktopSearch_searchCommand"><div style="background:currentColor;transform:rotate(45deg);width:1.5px;border-radius:2px;height:100%"></div></div></button><div class="vocs_DesktopTopNav_logoWrapper"><div class="vocs_DesktopTopNav_logo"><a style="align-items:center;display:flex;height:56px;margin-top:4px" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/images/jincubator.png"/></a></div></div><div class="vocs_DesktopTopNav_section"></div><div class="vocs_DesktopTopNav_section"><div class="vocs_DesktopTopNav_group"><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="vocs_NavigationMenu"><div style="position:relative"><ul data-orientation="horizontal" class="vocs_NavigationMenu_list" dir="ltr"><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/research/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Research</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/proposals/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Proposals</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/product/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Product</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/partnerships/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Partnerships</a></ul></div></nav></div></div></div><div class="vocs_MobileTopNav"><div class="vocs_MobileTopNav_section"><div class="vocs_MobileTopNav_group"><div class="vocs_MobileTopNav_logo"><a style="align-items:center;display:flex;height:100%" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/images/jincubator.png"/></a></div></div><div class="vocs_MobileTopNav_group"><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="vocs_MobileTopNav_navigation vocs_NavigationMenu"><div style="position:relative"><ul data-orientation="horizontal" class="vocs_NavigationMenu_list" dir="ltr"><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/research/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Research</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/proposals/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Proposals</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/product/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Product</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/partnerships/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Partnerships</a></ul></div></nav><div class="vocs_MobileTopNav_navigation vocs_MobileTopNav_navigation_compact"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«Rkpj»" data-state="closed" class="vocs_MobileTopNav_menuTrigger vocs_MobileTopNav_navigationItem">Menu<div aria-label="Menu" class="vocs_Icon" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Down</title><path d="M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="vocs_MobileTopNav_section"><div class="vocs_MobileTopNav_group" style="margin-right:-8px"><button class="vocs_MobileSearch_searchButton" type="button" aria-label="Search" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«R19j»" data-state="closed"><svg width="21" height="21" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div></div></div></div><div class="vocs_DocsLayout_gutterTopCurtain vocs_DocsLayout_gutterTopCurtain_withSidebar"><div class="vocs_DesktopTopNav_curtain"></div><div class="vocs_MobileTopNav_curtain"><div class="vocs_MobileTopNav_curtainGroup"><div class="vocs_MobileTopNav_curtainItem"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«Rqj»" data-state="closed" class="vocs_MobileTopNav_menuTrigger"><div aria-label="Menu" class="vocs_Icon" role="img" style="--vocs_Icon_size:13px"><svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 79 48" fill="none"><title>Menu</title><path fill="currentColor" d="M19.528 47.232h40.87c1.952 0 3.515-1.562 3.515-3.564a3.5 3.5 0 0 0-3.516-3.516H19.528a3.501 3.501 0 0 0-3.515 3.516c0 2.002 1.562 3.564 3.515 3.564ZM12.057 27.262h55.81a3.501 3.501 0 0 0 3.516-3.516 3.501 3.501 0 0 0-3.515-3.515h-55.81a3.501 3.501 0 0 0-3.516 3.515 3.501 3.501 0 0 0 3.515 3.516ZM4.391 7.34H75.29c2.002 0 3.515-1.563 3.515-3.516 0-2.002-1.513-3.564-3.515-3.564H4.39C2.438.26.876 1.822.876 3.824A3.501 3.501 0 0 0 4.39 7.34Z"></path></svg></div><div class="vocs_MobileTopNav_menuTitle">No Liquidity Solving (Tycho 1inch)</div></button></div></div><div class="vocs_MobileTopNav_curtainGroup"><div class="vocs_MobileTopNav_curtainItem"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«R5aj»" data-state="closed" class="vocs_MobileTopNav_outlineTrigger">On this page<div aria-label="On this page" class="vocs_Icon" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Right</title><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button></div></div></div></div><div class="vocs_DocsLayout_gutterRight vocs_DocsLayout_gutterRight_withSidebar"></div><div id="vocs-content" class="vocs_DocsLayout_content vocs_DocsLayout_content_withSidebar vocs_DocsLayout_content_withTopNav"><article class="vocs_Content"><header class="vocs_Header"><h1 class="vocs_H1 vocs_Heading"><div id="no-liquidity-solving-tycho-1inch" class="vocs_Heading_slugTarget"></div>No Liquidity Solving (Tycho 1inch)<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#no-liquidity-solving-tycho-1inch" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h1></header>
<h2 class="vocs_H2 vocs_Heading"><div id="no-liquidity-solving-walkthrough" class="vocs_Heading_slugTarget"></div>No Liquidity Solving Walkthrough<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#no-liquidity-solving-walkthrough" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">This research was conducted as part of <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://ethglobal.com/showcase/defiunite-jincubator-g1h0p" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Unite DeFi</a></p>
<iframe src="https://www.loom.com/embed/c59e1a9eb2064d4a855cabab3941a514" frameborder="0" allow="autoplay; encrypted-media" style="width:100%;height:500px;border-radius:12px"></iframe>
<p class="vocs_Paragraph">The following Actions are Taken</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Mary has one ETH</li>
<li class="vocs_ListItem">Chainlink Oracle has 1ETH = 2000DAI</li>
<li class="vocs_ListItem">Mary creates a an order 1ETH for 2000DAI</li>
<li class="vocs_ListItem">Tabatha using Tycho finds Uniswap V2 will swap 1ETH for 2018DAI</li>
<li class="vocs_ListItem">Tabatha Takes the Order</li>
<li class="vocs_ListItem">Order Settles</li>
</ol>
<strong class="vocs_Strong">Additional Notes</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">*This uses a modified version of 1inch Limit Order Protocol which allows TychoSwapExecutor to settle the Makers Funds</li>
<li class="vocs_ListItem">**Mary approves 1ETH to be used by Limit-Order-Protocol (and Tycho Swap Router)</li>
<li class="vocs_ListItem">**Mary’s 1ETH is used for the swap - No Liquidity is provided by Tabatha - Transaction reverts if &lt; 2000 DAI is returned</li>
<li class="vocs_ListItem">***Taking and Settling the order is an atomic transaction integrating TychoSwapExecutor.sol as a TakerInteraction in LimitOrderProtocol.sol</li>
</ul>
<table class="vocs_Table"><thead><tr class="vocs_TableRow"><th class="vocs_TableHeader">Action</th><th class="vocs_TableHeader">Mary Maker</th><th class="vocs_TableHeader">Limit Order Protocol</th><th class="vocs_TableHeader">Tabatha Tycho Taker</th><th class="vocs_TableHeader">Jincubator Protocol</th><th class="vocs_TableHeader">Tycho Simulation</th></tr></thead><tbody><tr class="vocs_TableRow"><td class="vocs_TableCell">1</td><td class="vocs_TableCell">1 ETH</td><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">2</td><td class="vocs_TableCell">1 ETH</td><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">3</td><td class="vocs_TableCell">1ETH</td><td class="vocs_TableCell"><em>1ETH*</em></td><td class="vocs_TableCell"></td><td class="vocs_TableCell">OrderCalculator.sol integrates price oracles for creating spread orders</td><td class="vocs_TableCell"></td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">4</td><td class="vocs_TableCell">1ETH</td><td class="vocs_TableCell"><em>1ETH*</em></td><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td><td class="vocs_TableCell">Tycho Indexing and Simulation (Off Chain Price Discovery)</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">5</td><td class="vocs_TableCell"></td><td class="vocs_TableCell">2018DAI**</td><td class="vocs_TableCell"></td><td class="vocs_TableCell">TychoExecutor.sol executes the trade on UniswapV3</td><td class="vocs_TableCell">TychoRouter is called by TychoSwapRouter to execute the trade</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">6</td><td class="vocs_TableCell">200DAI</td><td class="vocs_TableCell"></td><td class="vocs_TableCell">18DAI</td><td class="vocs_TableCell">LimitOrderProtocol.sol sends Mary 2000 DAI from Tabatha</td><td class="vocs_TableCell"></td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td><td class="vocs_TableCell"></td></tr></tbody></table>
<h2 class="vocs_H2 vocs_Heading"><div id="jincubator-limit-order-protocol" class="vocs_Heading_slugTarget"></div>Jincubator Limit Order Protocol<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#jincubator-limit-order-protocol" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">This protocol implements four key enhancements to the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/1inch/limit-order-protocol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">1inch Limit Order Protocol</a>:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Enhanced Swap Execution</strong>: <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/protocol/tree/main/src/TychoSwapExecutor.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">TychoSwapExecutor.sol</a> integrates <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/propeller-heads/tycho-execution" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Tycho Execution</a> to enable complex swaps across multiple DEXs without upfront liquidity</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Stop Loss and Profit Taking Orders</strong>: <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/protocol/tree/main/src/OracleCalculator.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">OracleIntegration.sol</a> Oracle-based (starting with chainlink) pricing calculator for advanced order strategies</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Treasury Management</strong>: <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/protocol/tree/main/src/RebalancerInteraction.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">RebalancerInteraction.sol</a> enables makers and takers to immediately balance their funds to a treasury (and moving forward more advanced asset management strategies).</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Resource Management</strong>: <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/protocol/tree/main/src/CompactInteraction.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">CompactInteraction.sol</a> integrates the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/1inch/limit-order-protocol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">1inch Limit Order Protocol</a> with <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/uniswap/the-compact" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">The Compact</a> for <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://eips.ethereum.org/EIPS/eip-6909" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ERC-6909</a> support and moving forward integration with additional cross chain intent standards such as <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://www.erc7683.org/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ERC-7683</a> leveraging <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://www.jincubator.com/research/solving/protocol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Mandates and Solver Payloads</a> and <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://www.jincubator.com/research/solving/resources" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Advanced Resource Locking</a>.</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="enhanced-swap-execution" class="vocs_Heading_slugTarget"></div>Enhanced Swap Execution<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#enhanced-swap-execution" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">We integrate with Tycho&#x27;s indexing, simulation and execution via a TcyhoSwapExecutor which allows Solvers to provide a payload with complex routing solutions across multiple liquidity protocols. The design for United Defi allows the taker to submit a Payload with Call Data which will be executed as part of the TakerInteraction flow. This allows, if permitted by the maker, the solver to use the takers tokens and execute the trade without providing any upfront capital.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="stop-loss-and-profit-taking-orders" class="vocs_Heading_slugTarget"></div>Stop Loss and Profit Taking Orders<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#stop-loss-and-profit-taking-orders" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The OracleCalculator extension is a powerful addition to the 1inch Limit Order Protocol that enables dynamic pricing based on Chainlink oracle data. This extension allows orders to be filled at prices that are calculated on-chain using real-time oracle feeds, making it possible to create orders that automatically adjust to market conditions.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="treasury-management" class="vocs_Heading_slugTarget"></div>Treasury Management<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#treasury-management" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Implemented as an IPostInteraction the RebalancerInteraction contract allows both makers and takers to instantly move their funds to their Treasury of choice.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="resource-management" class="vocs_Heading_slugTarget"></div>Resource Management<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#resource-management" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">We Implemented integration with an ERC-6909 compliant locking mechanism enabling advanced resource management capabilities and laying the foundation to extend the 1inch Limit Order Protocol to open standards such as ERC-7683.</p>
<h2 class="vocs_H2 vocs_Heading"><div id="near-fusion-smart-contract-development" class="vocs_Heading_slugTarget"></div>NEAR FUSION+ Smart Contract Development<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#near-fusion-smart-contract-development" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">NEAR Fusion+ is a comprehensive DeFi protocol that migrates 1inch&#x27;s proven Limit Order Protocol and Cross-Chain Swap functionality to the NEAR blockchain. The system provides two primary capabilities: advanced limit order trading with partial fills and extensible features, and atomic cross-chain swaps secured by time-locked escrow contracts.</p>
<h2 class="vocs_H2 vocs_Heading"><div id="implementation-limit-order-protocol" class="vocs_Heading_slugTarget"></div>Implementation Limit Order Protocol<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#implementation-limit-order-protocol" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="core-components" class="vocs_Heading_slugTarget"></div>Core Components<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#core-components" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Compact</strong>: ERC-6909 enabled Chainlink calculator for price discovery</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">ResourceManager</strong>: Manages resource locks for ERC-6909 integration</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">TychoSwapExecutor</strong>: Executes complex swaps using Tycho Execution</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">CompactInteraction</strong>: Post-interaction handler for resource allocation</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">RebalancerInteraction</strong>: Treasury management and portfolio rebalancing</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">OracleCalculator</strong>: Price oracle integration for advanced order strategies</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="key-features" class="vocs_Heading_slugTarget"></div>Key Features<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#key-features" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Resource Locking</strong>: ERC-6909 compliant resource management</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Multi-DEX Execution</strong>: Cross-platform swap execution via Tycho</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Advanced Order Types</strong>: Stop-loss and take-profit orders</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Treasury Management</strong>: Automated portfolio rebalancing</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Oracle Integration</strong>: Chainlink price feeds for accurate pricing</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="key-technology-enhancements" class="vocs_Heading_slugTarget"></div>Key Technology Enhancements<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#key-technology-enhancements" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Solidity based tests including a migration from <code class="vocs_Code">OrderUtils.js</code> to solidity based <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/protocol/tree/main/test/utils/orderUtils/README_OrderUtils.md" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">OrderUtils</a></li>
<li class="vocs_ListItem">Solidity <code class="vocs_Code">^0.8.30</code> compatibility provided by creating an interface <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/protocol/tree/main/src/interfaces/1inch/ILimitOrderProtocol.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">ILimitOrderProtocol.sol</a> and introducing <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/protocol/tree/main/test/helpers/LimitOrderProtocolManager.sol" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">LimitOrderProtocolManager</a> for testing.</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="architecture" class="vocs_Heading_slugTarget"></div>Architecture<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#architecture" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><img src="https://hackmd.io/_uploads/ByIAaIhwel.png" alt="Architecture"/></p>
<h3 class="vocs_H3 vocs_Heading"><div id="interactions" class="vocs_Heading_slugTarget"></div>Interactions<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#interactions" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><img src="https://hackmd.io/_uploads/B1XQRU3wex.png" alt="Interactions"/></p>
<h2 class="vocs_H2 vocs_Heading"><div id="enhanced-swap-execution-1" class="vocs_Heading_slugTarget"></div>Enhanced Swap Execution<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#enhanced-swap-execution-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="tycho-execution-flow" class="vocs_Heading_slugTarget"></div>Tycho Execution Flow<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#tycho-execution-flow" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><img src="https://hackmd.io/_uploads/HyRf1vnwgl.png" alt="TychoFlow"/></p>
<h3 class="vocs_H3 vocs_Heading"><div id="tycho-components" class="vocs_Heading_slugTarget"></div>Tycho Components<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#tycho-components" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><img src="https://hackmd.io/_uploads/HkytJP3Plg.png" alt="TychoComponents"/></p>
<h3 class="vocs_H3 vocs_Heading"><div id="actors" class="vocs_Heading_slugTarget"></div>Actors<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#actors" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Maker<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Creates orders specifying the spread price they are looking for (currently using chainlink Oracle)</li>
</ol>
</li>
<li class="vocs_ListItem">Solver Service<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Monitors 1inch Intents created</li>
<li class="vocs_ListItem">Monitors Liquidity Positions on Chain using Tycho-indexer</li>
<li class="vocs_ListItem">Simulates Solves for Orders (to see if profitable)</li>
<li class="vocs_ListItem">Calls Resolver Contract to execute the Swap<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Solver Payload - encoded to call TychoResolver a modified version of Tycho Execution</li>
</ol>
</li>
<li class="vocs_ListItem">Calls Order Fill passing<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">target: TychoResolver address</li>
<li class="vocs_ListItem">interaction: SolverPayload</li>
</ol>
</li>
</ol>
</li>
<li class="vocs_ListItem">Resolver Contract (modified version combining ResolverCrossChain and Tycho Dispatcher)<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Called by LimitOrderProtocol as part of Order.fill</li>
<li class="vocs_ListItem">Executes swap using Makers Tokens</li>
<li class="vocs_ListItem">Provides TakerToken to Relayer to pass back to Taker</li>
<li class="vocs_ListItem">Transfers excess maker (or taker) tokens to Treasury</li>
</ol>
</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="implementation-approach" class="vocs_Heading_slugTarget"></div>Implementation Approach<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#implementation-approach" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">TychoFillPredicate.sol (Predicate): copied from OracleCalculator.sol</li>
<li class="vocs_ListItem">TychoFillInteraction.sol : copied from RebalancerInteraction.sol</li>
<li class="vocs_ListItem">TychoResolver.sol: Copied from ResolverCrossChain.sol and Dispatcher.sol</li>
<li class="vocs_ListItem">Tests copied from RebalancerInteraction.t.sol and enhanced with<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Creation of Swap (MakerTokens to TakerTokens) similar to</li>
<li class="vocs_ListItem">Call of Fill Contract passing<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">target: TychoResolver address</li>
<li class="vocs_ListItem">interaction: SolverPayload</li>
</ol>
</li>
<li class="vocs_ListItem">Checking of Treasurer Balances after swap is executed</li>
</ol>
</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="flow" class="vocs_Heading_slugTarget"></div>Flow<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#flow" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<h4 class="vocs_H4 vocs_Heading"><div id="interactions-1" class="vocs_Heading_slugTarget"></div>Interactions<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#interactions-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">Interactions are callbacks that enable the execution of arbitrary code, which is provided by the maker’s order or taker’s fill execution.</p>
<p class="vocs_Paragraph">The order execution logic includes several steps that also involve interaction calls:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Validate the order</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">Call the maker&#x27;s pre-interaction</strong>
</li>
<li class="vocs_ListItem">Transfer the maker&#x27;s asset to the taker</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">Call the taker&#x27;s interaction</strong>
</li>
<li class="vocs_ListItem">Transfer the taker&#x27;s asset to the maker</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">Call the maker&#x27;s post-interaction</strong>
</li>
<li class="vocs_ListItem">Emit the OrderFilled event</li>
</ol>
<p class="vocs_Paragraph">Calls are executed in the context of the limit order protocol. The target contract should implement the <code class="vocs_Code">IPreInteraction</code> or <code class="vocs_Code">IPostInteraction</code> interfaces for the maker&#x27;s pre- and post-interactions and the <code class="vocs_Code">ITakerInteraction</code> interface for the taker&#x27;s interaction. These interfaces declare the single callback function for maker and taker interactions, respectively.</p>
<p class="vocs_Paragraph">Here is how the maker’s pre- &amp; post- interactions and the taker’s interaction are defined in the interfaces:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">//Maker&#x27;s pre-interaction</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">function</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> preInteraction</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        IOrderMixin</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">Order</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> calldata</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> order</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        bytes32</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> orderHash</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        address</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> taker</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> makingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> takingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> remainingMakingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> calldata</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> extraData</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    ) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">external</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">//Maker&#x27;s post-interaction</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">function</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> postInteraction</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        IOrderMixin</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">Order</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> calldata</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> order</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        bytes32</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> orderHash</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        address</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> taker</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> makingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> takingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> remainingMakingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> calldata</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> extraData</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    ) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">external</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">//Taker&#x27;s interaction</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">function</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> takerInteraction</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        IOrderMixin</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">Order</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> calldata</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> order</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        bytes32</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> orderHash</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        address</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> taker</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> makingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> takingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> remainingMakingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> calldata</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> extraData</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    ) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">external</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> returns</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> offeredTakingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span></code></pre></div></div>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Resolver Contract executes calls to Tycho Dispatcher or Router</li>
<li class="vocs_ListItem">Three functions<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">preInteraction: used in OracleCalculator (to ensure price before swap)</li>
<li class="vocs_ListItem">takerInteraction used in SwapExecutor to Execute Swap by Taker</li>
<li class="vocs_ListItem">postInteraction used in Rebalancer to Send Funds to Treasury</li>
</ul>
</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="design-questions" class="vocs_Heading_slugTarget"></div>Design Questions<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#design-questions" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Interface Compatibility</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">How will the TychoResolver interface be defined to ensure compatibility with the LimitOrderProtocol bytecode deployment approach?</li>
<li class="vocs_ListItem">Should we create a custom interface for TychoResolver or use the concrete type like the working project?</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Predicate Logic</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">What predicate logic will TychoFill.sol use? Will it be similar to OracleCalculator.sol with price comparisons?</li>
<li class="vocs_ListItem">How will the predicate determine when a solve is profitable vs. when it should execute?</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Solver Payload Structure</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">What data structure will the SolverPayload contain? Will it include target addresses, amounts, and execution parameters?</li>
<li class="vocs_ListItem">How will the payload be encoded/decoded between the Solver Service and TychoResolver?</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Treasury Integration</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">How will excess tokens be calculated and transferred to Treasury?</li>
<li class="vocs_ListItem">What mechanism will prevent MEV attacks on the treasury transfers?</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Error Handling</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">How will failed solves be handled? Will orders be cancelled or retried?</li>
<li class="vocs_ListItem">What happens if the TychoResolver execution fails during the order fill?</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Gas Optimization</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">How will the solver service optimize gas costs across multiple orders?</li>
<li class="vocs_ListItem">Will batch processing be implemented for multiple orders?</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Oracle Integration</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Will TychoFill use the same Chainlink oracle approach as OracleCalculator ?</li>
<li class="vocs_ListItem">How will price feeds be validated and updated?</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Cross-Chain Considerations</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">How will the ResolverCrossChain functionality be integrated with Tycho Dispatcher?</li>
<li class="vocs_ListItem">What bridge mechanisms will be used for cross-chain swaps?</li>
</ul>
</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="implementation-plan" class="vocs_Heading_slugTarget"></div>Implementation Plan<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#implementation-plan" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">
<strong class="vocs_Strong">Phase 1: Core Contract Development</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Create <code class="vocs_Code">TychoFill.sol</code> based on <code class="vocs_Code">OracleCalculator.sol</code></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Implement predicate logic for profitable solve detection</li>
<li class="vocs_ListItem">Add Tycho-specific price calculation methods</li>
<li class="vocs_ListItem">Ensure interface compatibility with LimitOrderProtocol</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph">Create <code class="vocs_Code">TychoFillInteraction.sol</code> based on <code class="vocs_Code">RebalancerInteraction.sol</code></p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Implement post-interaction logic for treasury transfers</li>
<li class="vocs_ListItem">Add balance validation and excess token calculation</li>
<li class="vocs_ListItem">Integrate with TychoResolver for swap execution</li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">Phase 2: Resolver Contract Development</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Create <code class="vocs_Code">TychoResolver.sol</code> combining ResolverCrossChain and Dispatcher functionality<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Implement swap execution using maker tokens</li>
<li class="vocs_ListItem">Add taker token provision for relayer</li>
<li class="vocs_ListItem">Integrate treasury transfer logic</li>
<li class="vocs_ListItem">Ensure proper error handling and revert conditions</li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">Phase 3: Testing Framework</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Create comprehensive test suite based on <code class="vocs_Code">RebalancerInteraction.t.sol</code>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Test order creation with Tycho-specific predicates</li>
<li class="vocs_ListItem">Test solver payload encoding/decoding</li>
<li class="vocs_ListItem">Test treasury balance validation</li>
<li class="vocs_ListItem">Test cross-chain swap scenarios</li>
<li class="vocs_ListItem">Test error conditions and edge cases</li>
</ul>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">Phase 4: Integration Testing</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Test end-to-end flow from order creation to execution</li>
<li class="vocs_ListItem">Validate predicate execution with bytecode deployment</li>
<li class="vocs_ListItem">Test solver service integration with Tycho-indexer</li>
<li class="vocs_ListItem">Verify treasury transfers and balance calculations</li>
</ul>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">Phase 5: Optimization and Security</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Implement gas optimization strategies</li>
<li class="vocs_ListItem">Add comprehensive error handling</li>
<li class="vocs_ListItem">Implement MEV protection mechanisms</li>
<li class="vocs_ListItem">Add monitoring and logging capabilities</li>
</ul>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">Phase 6: Deployment and Monitoring</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Deploy contracts with proper bytecode generation</li>
<li class="vocs_ListItem">Set up monitoring for solver service</li>
<li class="vocs_ListItem">Implement alerting for failed solves</li>
<li class="vocs_ListItem">Add analytics for treasury performance</li>
</ul>
</li>
</ol>
<h2 class="vocs_H2 vocs_Heading"><div id="stop-loss-and-profit-taking-orders-1" class="vocs_Heading_slugTarget"></div>Stop Loss and Profit Taking Orders<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#stop-loss-and-profit-taking-orders-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="oracle-example-order" class="vocs_Heading_slugTarget"></div>Oracle Example Order<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#oracle-example-order" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><img src="https://hackmd.io/_uploads/ByKclv3Del.png" alt="OracleExampleOrder"/></p>
<h3 class="vocs_H3 vocs_Heading"><div id="oracle-order-integration" class="vocs_Heading_slugTarget"></div>Oracle Order Integration<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#oracle-order-integration" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><img src="https://hackmd.io/_uploads/ry6slPnvxg.png" alt="OracleIntegration"/></p>
<h3 class="vocs_H3 vocs_Heading"><div id="overview" class="vocs_Heading_slugTarget"></div>Overview<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#overview" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The OracleCalculator extension is a powerful addition to the 1inch Limit Order Protocol that enables dynamic pricing based on Chainlink oracle data. This extension allows orders to be filled at prices that are calculated on-chain using real-time oracle feeds, making it possible to create orders that automatically adjust to market conditions.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="1-what-the-oraclecalculator-extension-does" class="vocs_Heading_slugTarget"></div>1. What the OracleCalculator Extension Does<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#1-what-the-oraclecalculator-extension-does" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The OracleCalculator extension serves as an <code class="vocs_Code">IAmountGetter</code> implementation that:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Calculates dynamic exchange rates</strong> using Chainlink oracle data</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Supports both single and double oracle pricing</strong> for different token pairs</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Applies configurable spreads</strong> to provide maker/taker incentives</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Handles inverse pricing</strong> for tokens quoted in different base currencies</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Validates oracle freshness</strong> to ensure price data is current (within 4 hours)</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Integrates with predicates</strong> for conditional order execution</li>
</ul>
<h4 class="vocs_H4 vocs_Heading"><div id="key-features-1" class="vocs_Heading_slugTarget"></div>Key Features:<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#key-features-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Single Oracle Pricing</strong>: Uses one oracle to price a token relative to ETH or USD</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Double Oracle Pricing</strong>: Uses two oracles to price custom token pairs (e.g., INCH/DAI)</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Spread Application</strong>: Applies maker and taker spreads to create profitable order books</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Inverse Flag Support</strong>: Handles cases where oracle prices need to be inverted</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Oracle Freshness Check</strong>: Ensures oracle data is not stale (within 4 hours TTL)</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="2-types-of-orders-that-can-be-created" class="vocs_Heading_slugTarget"></div>2. Types of Orders That Can Be Created<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#2-types-of-orders-that-can-be-created" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<h4 class="vocs_H4 vocs_Heading"><div id="a-single-oracle-orders" class="vocs_Heading_slugTarget"></div>A. Single Oracle Orders<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#a-single-oracle-orders" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">Orders that use one Chainlink oracle to price a token relative to ETH or USD:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">ETH → DAI</strong>: Using DAI/ETH oracle</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">DAI → ETH</strong>: Using DAI/ETH oracle with inverse flag</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">WETH → USDC</strong>: Using USDC/ETH oracle</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">USDC → WETH</strong>: Using USDC/ETH oracle with inverse flag</li>
</ul>
<h4 class="vocs_H4 vocs_Heading"><div id="b-double-oracle-orders" class="vocs_Heading_slugTarget"></div>B. Double Oracle Orders<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#b-double-oracle-orders" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">Orders that use two oracles to price custom token pairs:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">INCH → DAI</strong>: Using INCH/ETH and DAI/ETH oracles</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">DAI → INCH</strong>: Using DAI/ETH and INCH/ETH oracles</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Custom Token Pairs</strong>: Any combination of tokens with available oracles</li>
</ul>
<h4 class="vocs_H4 vocs_Heading"><div id="c-conditional-orders-predicates" class="vocs_Heading_slugTarget"></div>C. Conditional Orders (Predicates)<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#c-conditional-orders-predicates" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">Orders that only execute under specific oracle conditions:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Stop-Loss Orders</strong>: Execute only when price falls below threshold</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Take-Profit Orders</strong>: Execute only when price rises above threshold</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Range Orders</strong>: Execute only within specific price ranges</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="3-fields-passed-to-the-extension-and-how-they-are-populated" class="vocs_Heading_slugTarget"></div>3. Fields Passed to the Extension and How They Are Populated<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#3-fields-passed-to-the-extension-and-how-they-are-populated" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<h4 class="vocs_H4 vocs_Heading"><div id="extension-data-structure" class="vocs_Heading_slugTarget"></div>Extension Data Structure<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#extension-data-structure" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The extension data is passed as <code class="vocs_Code">bytes calldata extraData</code> to the <code class="vocs_Code">getMakingAmount</code> and <code class="vocs_Code">getTakingAmount</code> functions:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">function</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> getMakingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    IOrderMixin</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">Order</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> calldata</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> order</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> calldata</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> extension</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes32</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> orderHash</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> taker</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> takingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> remainingMakingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> calldata</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> extraData</span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">  // ← Extension data here</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">external</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> view</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> returns</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span></code></pre></div></div>
<h4 class="vocs_H4 vocs_Heading"><div id="single-oracle-data-format" class="vocs_Heading_slugTarget"></div>Single Oracle Data Format<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#single-oracle-data-format" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">For single oracle pricing, the <code class="vocs_Code">extraData</code> contains:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">1 byte flags</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">][</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">20 bytes oracle address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">][32 bytes spread]</span></span></code></pre></div></div>
<strong class="vocs_Strong">Flags Byte:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Bit 7 (0x80): Inverse flag - if set, invert the oracle price</li>
<li class="vocs_ListItem">Bit 6 (0x40): Double price flag - if set, use double oracle mode</li>
<li class="vocs_ListItem">Bits 0-5: Reserved</li>
</ul>
<strong class="vocs_Strong">Example:</strong>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// DAI/ETH oracle at 0x1234... with 0.99 spread, no inverse</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> memory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> data </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> abi</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encodePacked</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes1</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0x00</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),           </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// flags: no inverse, no double price</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(daiOracle),      </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// oracle address</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">990000000</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)       </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// spread: 0.99 (990000000 / 1e9)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span></code></pre></div></div>
<h4 class="vocs_H4 vocs_Heading"><div id="double-oracle-data-format" class="vocs_Heading_slugTarget"></div>Double Oracle Data Format<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#double-oracle-data-format" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">For double oracle pricing, the <code class="vocs_Code">extraData</code> contains:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">1 byte flags</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">][</span><span style="color:#032F62;text-decoration:underline;--shiki-dark:#96D0FF;--shiki-dark-text-decoration:inherit" class="vocs_Span">20 bytes oracle1</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">][20 bytes oracle2][32 bytes decimalsScale][32 bytes spread]</span></span></code></pre></div></div>
<strong class="vocs_Strong">Example:</strong>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// INCH/DAI pricing using INCH/ETH and DAI/ETH oracles</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> memory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> data </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> abi</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encodePacked</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes1</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0x40</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),           </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// flags: double price mode</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(inchOracle),     </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// oracle1: INCH/ETH</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(daiOracle),      </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// oracle2: DAI/ETH</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    int256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),              </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// decimalsScale: no adjustment</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">1010000000</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)     </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// spread: 1.01 (1010000000 / 1e9)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span></code></pre></div></div>
<h4 class="vocs_H4 vocs_Heading"><div id="how-fields-are-populated" class="vocs_Heading_slugTarget"></div>How Fields Are Populated<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#how-fields-are-populated" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Oracle Addresses</strong>: Retrieved from Chainlink&#x27;s oracle registry or deployment</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Spreads</strong>: Calculated based on desired maker/taker incentives (typically 0.99 for maker, 1.01 for taker)</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Flags</strong>: Set based on pricing requirements (inverse needed, double oracle needed)</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Decimals Scale</strong>: Used to adjust for different oracle decimal precisions</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="4-test-case-walkthrough" class="vocs_Heading_slugTarget"></div>4. Test Case Walkthrough<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#4-test-case-walkthrough" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<h4 class="vocs_H4 vocs_Heading"><div id="test-case-1-eth--dai-chainlink-order" class="vocs_Heading_slugTarget"></div>Test Case 1: ETH → DAI Chainlink Order<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#test-case-1-eth--dai-chainlink-order" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Scenario</strong>: Maker wants to sell 1 ETH for DAI at oracle price with spreads</p>
<strong class="vocs_Strong">Order Details:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Maker: makerAddr</li>
<li class="vocs_ListItem">Taker: takerAddr</li>
<li class="vocs_ListItem">Maker Asset: WETH (1 ether)</li>
<li class="vocs_ListItem">Taker Asset: DAI (4000 ether)</li>
<li class="vocs_ListItem">Oracle: DAI/ETH at 0.00025 ETH per DAI (1 ETH = 4000 DAI)</li>
</ul>
<strong class="vocs_Strong">Extension Data:</strong>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Making amount data (maker spread: 0.99)</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> memory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> makingAmountData </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> abi</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encodePacked</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    chainlinkCalcAddress,    </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Calculator address</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes1</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0x00</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),           </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// No inverse flag</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    oracleAddress,           </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// DAI oracle</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">990000000</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)       </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// 0.99 spread</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Taking amount data (taker spread: 1.01)</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> memory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> takingAmountData </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> abi</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encodePacked</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    chainlinkCalcAddress,    </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Calculator address</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes1</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0x80</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),           </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Inverse flag set</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    oracleAddress,           </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// DAI oracle</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">1010000000</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)     </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// 1.01 spread</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span></code></pre></div></div>
<strong class="vocs_Strong">Execution Flow:</strong>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Taker calls <code class="vocs_Code">fillOrderArgs</code> with 4000 DAI</li>
<li class="vocs_ListItem">Protocol calls <code class="vocs_Code">getTakingAmount</code> with 4000 DAI</li>
<li class="vocs_ListItem">Calculator applies 1.01 spread: 4000 * 1.01 = 4040 DAI</li>
<li class="vocs_ListItem">Protocol calls <code class="vocs_Code">getMakingAmount</code> with 4040 DAI</li>
<li class="vocs_ListItem">Calculator applies 0.99 spread: 4040 * 0.99 / 4000 = 0.99 ETH</li>
<li class="vocs_ListItem">Order executes: taker receives 0.99 ETH, maker receives 4000 DAI</li>
</ol>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Result</strong>: Taker pays 4000 DAI, receives 0.99 ETH (effective rate: 1 ETH = 4040.4 DAI)</p>
<h4 class="vocs_H4 vocs_Heading"><div id="test-case-2-dai--eth-chainlink-order" class="vocs_Heading_slugTarget"></div>Test Case 2: DAI → ETH Chainlink Order<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#test-case-2-dai--eth-chainlink-order" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Scenario</strong>: Maker wants to sell 4000 DAI for ETH at oracle price</p>
<strong class="vocs_Strong">Order Details:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Maker: makerAddr</li>
<li class="vocs_ListItem">Taker: takerAddr</li>
<li class="vocs_ListItem">Maker Asset: DAI (4000 ether)</li>
<li class="vocs_ListItem">Taker Asset: WETH (1 ether)</li>
<li class="vocs_ListItem">Oracle: DAI/ETH at 0.00025 ETH per DAI</li>
</ul>
<strong class="vocs_Strong">Extension Data:</strong>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Making amount data (inverse + maker spread)</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> memory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> makingAmountData </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> abi</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encodePacked</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    chainlinkCalcAddress,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes1</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0x80</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),           </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Inverse flag</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    oracleAddress,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">990000000</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)       </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// 0.99 spread</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Taking amount data (no inverse + taker spread)</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> memory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> takingAmountData </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> abi</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encodePacked</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    chainlinkCalcAddress,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes1</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0x00</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),           </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// No inverse flag</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    oracleAddress,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">1010000000</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)     </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// 1.01 spread</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span></code></pre></div></div>
<strong class="vocs_Strong">Execution Flow:</strong>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Taker calls with <code class="vocs_Code">makingAmount</code> flag set to true</li>
<li class="vocs_ListItem">Protocol calls <code class="vocs_Code">getMakingAmount</code> with 4000 DAI</li>
<li class="vocs_ListItem">Calculator applies inverse + 0.99 spread: 4000 * 0.99 / 4000 = 0.99 ETH</li>
<li class="vocs_ListItem">Protocol calls <code class="vocs_Code">getTakingAmount</code> with 0.99 ETH</li>
<li class="vocs_ListItem">Calculator applies 1.01 spread: 0.99 * 1.01 = 1.01 ETH</li>
<li class="vocs_ListItem">Order executes: taker receives 4000 DAI, maker receives 1.01 ETH</li>
</ol>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Result</strong>: Taker pays 1.01 ETH, receives 4000 DAI (effective rate: 1 ETH = 3960.4 DAI)</p>
<h4 class="vocs_H4 vocs_Heading"><div id="test-case-3-inch--dai-double-oracle-order" class="vocs_Heading_slugTarget"></div>Test Case 3: INCH → DAI Double Oracle Order<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#test-case-3-inch--dai-double-oracle-order" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Scenario</strong>: Maker wants to sell 100 INCH for DAI using double oracle pricing</p>
<strong class="vocs_Strong">Order Details:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Maker: makerAddr</li>
<li class="vocs_ListItem">Taker: takerAddr</li>
<li class="vocs_ListItem">Maker Asset: INCH (100 ether)</li>
<li class="vocs_ListItem">Taker Asset: DAI (632 ether)</li>
<li class="vocs_ListItem">Oracles: INCH/ETH (0.0001577615249227853 ETH) and DAI/ETH (0.00025 ETH)</li>
</ul>
<strong class="vocs_Strong">Extension Data:</strong>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Making amount data (double oracle + maker spread)</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> memory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> makingAmountData </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> abi</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encodePacked</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    chainlinkCalcAddress,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes1</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0x40</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),           </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Double price flag</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(daiOracle),      </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Oracle1: DAI/ETH</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(inchOracle),     </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Oracle2: INCH/ETH</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    int256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),              </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// No decimals adjustment</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">990000000</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)       </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// 0.99 spread</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Taking amount data (double oracle + taker spread)</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> memory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> takingAmountData </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> abi</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encodePacked</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    chainlinkCalcAddress,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes1</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0x40</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),           </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Double price flag</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(inchOracle),     </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Oracle1: INCH/ETH</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(daiOracle),      </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Oracle2: DAI/ETH</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    int256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),              </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// No decimals adjustment</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">1010000000</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)     </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// 1.01 spread</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span></code></pre></div></div>
<strong class="vocs_Strong">Execution Flow:</strong>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Taker calls with <code class="vocs_Code">makingAmount</code> flag set to true</li>
<li class="vocs_ListItem">Protocol calls <code class="vocs_Code">getMakingAmount</code> with 100 INCH</li>
<li class="vocs_ListItem">Calculator applies double oracle calculation:<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">INCH price in ETH: 0.0001577615249227853</li>
<li class="vocs_ListItem">DAI price in ETH: 0.00025</li>
<li class="vocs_ListItem">INCH/DAI rate: 0.0001577615249227853 / 0.00025 = 0.631046</li>
<li class="vocs_ListItem">With 0.99 spread: 100 _ 0.631046 _ 0.99 = 62.47 DAI</li>
</ul>
</li>
<li class="vocs_ListItem">Protocol calls <code class="vocs_Code">getTakingAmount</code> with 62.47 DAI</li>
<li class="vocs_ListItem">Calculator applies inverse calculation with 1.01 spread</li>
<li class="vocs_ListItem">Order executes with calculated amounts</li>
</ol>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Result</strong>: Complex pricing based on two oracle feeds with spread adjustments</p>
<h4 class="vocs_H4 vocs_Heading"><div id="test-case-4-stop-loss-order-with-predicate" class="vocs_Heading_slugTarget"></div>Test Case 4: Stop-Loss Order with Predicate<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#test-case-4-stop-loss-order-with-predicate" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Scenario</strong>: Maker wants to sell INCH for DAI only if INCH/DAI price falls below 6.32</p>
<strong class="vocs_Strong">Order Details:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Maker: makerAddr</li>
<li class="vocs_ListItem">Taker: takerAddr</li>
<li class="vocs_ListItem">Maker Asset: INCH (100 ether)</li>
<li class="vocs_ListItem">Taker Asset: DAI (631 ether)</li>
<li class="vocs_ListItem">Predicate: INCH/DAI price &lt; 6.32</li>
</ul>
<strong class="vocs_Strong">Predicate Construction:</strong>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Build price call for predicate</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> memory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> priceCall </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> abi</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encodeWithSelector</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    OracleCalculator .doublePrice.selector,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    inchOracle,    </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// INCH/ETH oracle</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    daiOracle,     </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// DAI/ETH oracle</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    int256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),     </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// No decimals adjustment</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    1</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> ether</span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Base amount</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Build predicate call</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> memory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> predicate </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> abi</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encodeWithSelector</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    swap.lt.selector,        </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Less than comparison</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    6.32</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> ether</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,             </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Threshold: 6.32</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    abi</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encodeWithSelector</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        swap.arbitraryStaticCall.selector,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(oracleCalculator ),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        priceCall</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    )</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span></code></pre></div></div>
<strong class="vocs_Strong">Execution Flow:</strong>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Order fill is attempted</li>
<li class="vocs_ListItem">Protocol evaluates predicate before execution</li>
<li class="vocs_ListItem">Predicate calls <code class="vocs_Code">OracleCalculator .doublePrice()</code> with oracle data</li>
<li class="vocs_ListItem">Calculated INCH/DAI price is compared to 6.32 threshold</li>
<li class="vocs_ListItem">If price &lt; 6.32: order executes normally</li>
<li class="vocs_ListItem">If price ≥ 6.32: order reverts with predicate failure</li>
</ol>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Result</strong>: Order only executes when INCH/DAI price is below the specified threshold</p>
<h4 class="vocs_H4 vocs_Heading"><div id="test-case-5-simple-order-without-extension" class="vocs_Heading_slugTarget"></div>Test Case 5: Simple Order Without Extension<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#test-case-5-simple-order-without-extension" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Scenario</strong>: Basic order without any Chainlink integration</p>
<strong class="vocs_Strong">Order Details:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Maker: makerAddr</li>
<li class="vocs_ListItem">Taker: takerAddr</li>
<li class="vocs_ListItem">Maker Asset: WETH (1 ether)</li>
<li class="vocs_ListItem">Taker Asset: DAI (4000 ether)</li>
<li class="vocs_ListItem">No extensions or predicates</li>
</ul>
<strong class="vocs_Strong">Execution Flow:</strong>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Taker calls <code class="vocs_Code">fillOrderArgs</code> with 4000 DAI</li>
<li class="vocs_ListItem">No extension data provided</li>
<li class="vocs_ListItem">Protocol uses default proportional calculation</li>
<li class="vocs_ListItem">Order executes at fixed 1:4000 ratio</li>
</ol>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Result</strong>: Simple fixed-rate order execution without dynamic pricing</p>
<h3 class="vocs_H3 vocs_Heading"><div id="key-implementation-details" class="vocs_Heading_slugTarget"></div>Key Implementation Details<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#key-implementation-details" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<h4 class="vocs_H4 vocs_Heading"><div id="oracle-freshness-check" class="vocs_Heading_slugTarget"></div>Oracle Freshness Check<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#oracle-freshness-check" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (updatedAt </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">+</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> _ORACLE_TTL </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&lt;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> block</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.timestamp) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">revert</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> StaleOraclePrice</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">();</span></span></code></pre></div></div>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Ensures oracle data is not older than 4 hours</li>
<li class="vocs_ListItem">Prevents execution with stale price data</li>
</ul>
<h4 class="vocs_H4 vocs_Heading"><div id="spread-application" class="vocs_Heading_slugTarget"></div>Spread Application<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#spread-application" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">return</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> spread </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> amount </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> latestAnswer.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">toUint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">() </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">/</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">10</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> **</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> oracle.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">decimals</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">/</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> _SPREAD_DENOMINATOR;</span></span></code></pre></div></div>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Spreads are applied as multipliers (e.g., 990000000 = 0.99)</li>
<li class="vocs_ListItem"><code class="vocs_Code">_SPREAD_DENOMINATOR = 1e9</code> for 9-decimal precision</li>
</ul>
<h4 class="vocs_H4 vocs_Heading"><div id="double-oracle-calculation" class="vocs_Heading_slugTarget"></div>Double Oracle Calculation<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#double-oracle-calculation" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">result </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> amount </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> latestAnswer1.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">toUint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">();</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (decimalsScale </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    result </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 10</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> **</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> decimalsScale.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">toUint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">();</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">} </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">else</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (decimalsScale </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&lt;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    result </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">/=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 10</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> **</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">decimalsScale).</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">toUint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">();</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">result </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">/=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> latestAnswer2.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">toUint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">();</span></span></code></pre></div></div>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Calculates cross-oracle pricing for custom token pairs</li>
<li class="vocs_ListItem">Handles decimal precision adjustments between oracles</li>
</ul>
<p class="vocs_Paragraph">This extension enables sophisticated DeFi applications that can automatically adjust to market conditions while providing liquidity providers with profitable spreads.</p>
<h2 class="vocs_H2 vocs_Heading"><div id="treasury-management-1" class="vocs_Heading_slugTarget"></div>Treasury Management<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#treasury-management-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="treasury-management-flow" class="vocs_Heading_slugTarget"></div>Treasury Management Flow<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#treasury-management-flow" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><img src="https://hackmd.io/_uploads/BkDBWwhDee.png" alt="TreasuryInteraction"/></p>
<h3 class="vocs_H3 vocs_Heading"><div id="rebalancer-requirements" class="vocs_Heading_slugTarget"></div>Rebalancer Requirements<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#rebalancer-requirements" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Create an Interaction Contract called RebalancerInteraction.sol (in the src directory)</li>
<li class="vocs_ListItem">Create a test contract called RebalancerInteraction.t.sol (in the test directory)</li>
<li class="vocs_ListItem">In RebalancerInteraction.t.sol<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Create test scenarios the same as in OracleCalculator .t.sol</li>
<li class="vocs_ListItem">Add to that an Interaction using RebalancerInteraction.sol which<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Takes the output tokens the taker receives</li>
<li class="vocs_ListItem">Transfers them to a third wallet (addr3) which is a treasurer</li>
<li class="vocs_ListItem">If the transfer fails reject the order.</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="rebalancer-implementation" class="vocs_Heading_slugTarget"></div>Rebalancer Implementation<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#rebalancer-implementation" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The Rebalancer implementation has been successfully completed with the following components:</p>
<h3 class="vocs_H3 vocs_Heading"><div id="1-rebalancerinteractionsol-src-directory" class="vocs_Heading_slugTarget"></div>1. RebalancerInteraction.sol (src directory)<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#1-rebalancerinteractionsol-src-directory" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Purpose</strong>: Post-interaction contract that transfers output tokens to a treasurer wallet after successful order execution.</p>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Key Features</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Implements <code class="vocs_Code">IPostInteraction</code> interface for Limit Order Protocol integration</li>
<li class="vocs_ListItem">Transfers the taker&#x27;s received tokens (maker asset) to a designated treasurer address</li>
<li class="vocs_ListItem">Uses <code class="vocs_Code">SafeERC20</code> for secure token transfers with proper error handling</li>
<li class="vocs_ListItem">Reverts the entire order if transfer fails, ensuring atomic execution</li>
<li class="vocs_ListItem">Emits <code class="vocs_Code">TokensTransferredToTreasurer</code> events for successful transfers</li>
<li class="vocs_ListItem">Validates treasurer address in constructor to prevent zero address usage</li>
</ul>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Core Functionality</strong>:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">function</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> postInteraction</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    IOrderMixin</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">.</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">Order</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> calldata</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> order</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes32</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> orderHash</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> taker</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> makingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> takingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> remainingMakingAmount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> calldata</span><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span"> extraData</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">external</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> override</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> outputToken </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> order.makerAsset;</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> outputAmount </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> makingAmount;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    try</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> IERC20</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(outputToken).</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">safeTransferFrom</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(taker, treasurer, outputAmount) {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        emit</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> TokensTransferredToTreasurer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(outputToken, taker, treasurer, outputAmount);</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    } </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">catch</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        revert</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> TransferFailed</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">();</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="2-rebalancerinteractiontsol-test-directory" class="vocs_Heading_slugTarget"></div>2. RebalancerInteraction.t.sol (test directory)<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#2-rebalancerinteractiontsol-test-directory" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Purpose</strong>: Comprehensive test suite that replicates all OracleCalculator scenarios with added treasurer functionality.</p>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Test Coverage</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Single Oracle Orders</strong>: ETH→DAI, DAI→ETH with treasurer receiving output tokens</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Double Oracle Orders</strong>: INCH→DAI with complex pricing and treasurer transfer</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Conditional Orders</strong>: Stop-loss orders with predicate validation and treasurer transfer</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Simple Orders</strong>: Basic orders without Chainlink but with treasurer transfer</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Failure Scenarios</strong>: Tests unauthorized transfers that should revert</li>
</ul>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Test Scenarios Implemented</strong>:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><code class="vocs_Code">test_eth_to_dai_chainlink_order_with_rebalancer()</code> - Single oracle ETH→DAI</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_dai_to_eth_chainlink_order_with_rebalancer()</code> - Single oracle DAI→ETH with inverse</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_dai_to_1inch_chainlink_order_takingAmountData_with_rebalancer()</code> - Double oracle INCH→DAI</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_dai_to_1inch_chainlink_order_makingAmountData_with_rebalancer()</code> - Double oracle with making amount</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_dai_to_1inch_stop_loss_order_with_rebalancer()</code> - Conditional order with predicate</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_dai_to_1inch_stop_loss_order_predicate_invalid_with_rebalancer()</code> - Invalid predicate test</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_eth_to_dai_stop_loss_order_with_rebalancer()</code> - ETH→DAI with stop-loss</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_simple_order_without_extension_with_rebalancer()</code> - Basic order with treasurer</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_simple_order_with_different_amounts_with_rebalancer()</code> - Partial amounts</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_rebalancer_transfer_failure()</code> - Failure scenario testing</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="3-key-implementation-details" class="vocs_Heading_slugTarget"></div>3. Key Implementation Details<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#3-key-implementation-details" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<h4 class="vocs_H4 vocs_Heading"><div id="post-interaction-integration" class="vocs_Heading_slugTarget"></div><strong class="vocs_Strong">Post-Interaction Integration</strong><a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#post-interaction-integration" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Each test includes <code class="vocs_Code">buildPostInteractionCalldata(address(rebalancerInteraction))</code></li>
<li class="vocs_ListItem">Post-interaction data is added to order extensions via <code class="vocs_Code">PostInteractionData</code></li>
<li class="vocs_ListItem">Treasurer (addr3) receives the output tokens after successful order execution</li>
</ul>
<h4 class="vocs_H4 vocs_Heading"><div id="transfer-logic" class="vocs_Heading_slugTarget"></div><strong class="vocs_Strong">Transfer Logic</strong><a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#transfer-logic" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Takes output tokens</strong>: The tokens the taker receives (maker asset from the order)</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Transfers to treasurer</strong>: Moves tokens to addr3 (treasurer wallet) using <code class="vocs_Code">safeTransferFrom</code></li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Rejects order on failure</strong>: If transfer fails, entire order reverts with <code class="vocs_Code">TransferFailed</code> error</li>
</ul>
<h4 class="vocs_H4 vocs_Heading"><div id="test-verification" class="vocs_Heading_slugTarget"></div><strong class="vocs_Strong">Test Verification</strong><a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#test-verification" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">Each test verifies:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Order executes successfully</strong> with Chainlink pricing (where applicable)</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Treasurer receives tokens</strong>: <code class="vocs_Code">assertEq(token.balanceOf(addr3), expectedAmount)</code></li>
<li class="vocs_ListItem"><strong class="vocs_Strong">All balances are correct</strong> for maker, taker, and treasurer</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Failure scenarios revert</strong> when transfers are unauthorized</li>
</ol>
<h4 class="vocs_H4 vocs_Heading"><div id="error-handling" class="vocs_Heading_slugTarget"></div><strong class="vocs_Strong">Error Handling</strong><a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#error-handling" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">TransferFailed</strong>: Reverts entire order if <code class="vocs_Code">safeTransferFrom</code> fails</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">InvalidTreasurer</strong>: Prevents deployment with zero address treasurer</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Predicate failures</strong>: Orders with invalid predicates revert before interaction</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="4-integration-with-limit-order-protocol" class="vocs_Heading_slugTarget"></div>4. Integration with Limit Order Protocol<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#4-integration-with-limit-order-protocol" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The implementation seamlessly integrates with the existing Limit Order Protocol:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Extension System</strong>: Uses <code class="vocs_Code">PostInteractionData</code> extension for post-execution callbacks</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Order Flow</strong>: Maintains existing order execution flow while adding treasurer transfer</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Atomic Execution</strong>: Ensures either complete success (order + transfer) or complete failure</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Event Emission</strong>: Provides transparency through <code class="vocs_Code">TokensTransferredToTreasurer</code> events</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="5-security-considerations" class="vocs_Heading_slugTarget"></div>5. Security Considerations<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#5-security-considerations" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">SafeERC20</strong>: Uses OpenZeppelin&#x27;s SafeERC20 for secure token transfers</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Try-Catch</strong>: Graceful error handling prevents partial state changes</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Address Validation</strong>: Constructor validates treasurer address</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Atomic Operations</strong>: Order reverts entirely if transfer fails</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Authorization</strong>: Relies on existing token approval mechanisms</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="6-use-cases" class="vocs_Heading_slugTarget"></div>6. Use Cases<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#6-use-cases" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">This implementation enables:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Automated Treasury Management</strong>: Automatic transfer of trading profits to treasury</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Risk Management</strong>: Centralized control of trading outputs</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Compliance</strong>: Regulatory requirements for fund segregation</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Portfolio Rebalancing</strong>: Systematic reallocation of trading proceeds</li>
</ul>
<p class="vocs_Paragraph">The Rebalancer implementation successfully meets all requirements from the specification and provides a robust, secure, and comprehensive solution for automated treasury management in limit order trading.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="test-results" class="vocs_Heading_slugTarget"></div>Test Results<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#test-results" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<strong class="vocs_Strong">10 out of 10 tests passing (100% success rate)</strong>
<h4 class="vocs_H4 vocs_Heading"><div id="-all-tests-passing" class="vocs_Heading_slugTarget"></div>✅ <strong class="vocs_Strong">All Tests Passing:</strong><a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#-all-tests-passing" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><code class="vocs_Code">test_eth_to_dai_chainlink_order_with_rebalancer()</code> - Single oracle ETH→DAI</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_dai_to_eth_chainlink_order_with_rebalancer()</code> - Single oracle DAI→ETH with inverse</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_eth_to_dai_stop_loss_order_with_rebalancer()</code> - Stop-loss with predicate</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_simple_order_without_extension_with_rebalancer()</code> - Basic order without extensions</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_simple_order_with_different_amounts_with_rebalancer()</code> - Different order amounts</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_rebalancer_transfer_failure()</code> - Transfer failure handling</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_dai_to_1inch_stop_loss_order_predicate_invalid_with_rebalancer()</code> - Invalid predicate</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_dai_to_1inch_chainlink_order_makingAmountData_with_rebalancer()</code> - Double oracle with making amount</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_dai_to_1inch_chainlink_order_takingAmountData_with_rebalancer()</code> - Double oracle with taking amount</li>
<li class="vocs_ListItem"><code class="vocs_Code">test_dai_to_1inch_stop_loss_order_with_rebalancer()</code> - Complex double oracle with stop-loss predicate</li>
</ol>
<h4 class="vocs_H4 vocs_Heading"><div id="-core-functionality-verified" class="vocs_Heading_slugTarget"></div>🎯 <strong class="vocs_Strong">Core Functionality Verified:</strong><a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#-core-functionality-verified" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">✅ Post-interaction transfers tokens to treasurer</li>
<li class="vocs_ListItem">✅ Proper token approvals and transfers</li>
<li class="vocs_ListItem">✅ Balance verification accounting for treasurer transfers</li>
<li class="vocs_ListItem">✅ Error handling with transfer failures</li>
<li class="vocs_ListItem">✅ Atomic execution (orders either complete fully or revert entirely)</li>
<li class="vocs_ListItem">✅ Support for multiple token types (WETH, DAI, INCH)</li>
<li class="vocs_ListItem">✅ Complex oracle-based pricing scenarios</li>
</ul>
<h2 class="vocs_H2 vocs_Heading"><div id="resource-management-1" class="vocs_Heading_slugTarget"></div>Resource Management<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#resource-management-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="resource-management-architecture" class="vocs_Heading_slugTarget"></div>Resource Management Architecture<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#resource-management-architecture" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><img src="https://hackmd.io/_uploads/S12jGDhPge.png" alt="ResourceArchitecture"/></p>
<h3 class="vocs_H3 vocs_Heading"><div id="resource-management-components" class="vocs_Heading_slugTarget"></div>Resource Management Components<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#resource-management-components" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><img src="https://hackmd.io/_uploads/HJ-pzD3Peg.png" alt="ResourceComponents"/></p>
<h3 class="vocs_H3 vocs_Heading"><div id="requirements" class="vocs_Heading_slugTarget"></div>Requirements<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#requirements" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Read lib\the-compact\README.md (open in editor) to understand how the compact works</li>
<li class="vocs_ListItem">We are looking to create an end to end flow where<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">We register a new contract ResourceManager.sol as a ResourceManager</li>
<li class="vocs_ListItem">We Register ChainLinkCompactInteraction.sol as the Arbiter</li>
<li class="vocs_ListItem">The Maker (the Swapper in compact terms signs permission for their tokens (or ETH) to be stored in the-compact as ERC-6909)</li>
<li class="vocs_ListItem">ChainLinkCompact.sol checks that the we have a ResourceLock for the amount required.</li>
<li class="vocs_ListItem">ChainLinkCompact then executes the trade using the same logic that was in ChainLinkCalculator and creates a resource lock for their (tokens/ETH)</li>
<li class="vocs_ListItem">ChainLinkCompactInteraction is copied from RebalancerInteraction it takes the output tokens provided by the Taker and</li>
<li class="vocs_ListItem">If they are &gt;= TakerAmount then it calls the ResourceManager to lock the funds</li>
<li class="vocs_ListItem">It then does the token transfer to the treasurer the same as it was done in the original RebalancerInteraction</li>
</ol>
</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="design-questions-1" class="vocs_Heading_slugTarget"></div>Design Questions<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#design-questions-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Resource Manager Registration</strong>: How should we register the LimitOrderProtocol as a ResourceManager in The Compact? Should it be a separate contract or integrated directly?</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Answer: We are registering it as a separate contract let&#x27;s call it ResourceManager.sol and this contract will be called by ChainLinkCompact to lock the resources before calling the swap on LimitOrderProtocl</li>
</ol>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Arbiter Implementation</strong>: Should ChainLinkCompactInteraction.sol be a standalone arbiter or integrated with existing ChainLinkCalculator logic?</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Answer: It should be Standalone ChainLinkCalculator and RebalancerInteraction remain unchanged</li>
</ol>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Token Locking Strategy</strong>: Should makers lock their entire balance upfront or lock tokens dynamically when orders are matched?</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Answer: Initially Lock their whole balance</li>
</ol>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Resource Lock Scope</strong>: Should resource locks be chain-specific or multichain for cross-chain order execution?</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Answer: Chain-specific</li>
</ol>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Allocator Selection</strong>: Which allocator should we use for the resource locks? Should we create a custom allocator or use existing ones like Smallocator/Autocator?</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Answer: Create a custom Allocator based on Autocator(which is used for End User signing which is the Maker in our case)</li>
<li class="vocs_ListItem">The logic for calling this should be in ChainLinkCompact.t.sol</li>
<li class="vocs_ListItem">Moving forward we will also create a custom Smallocator used when smart contract call this</li>
</ol>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">EIP-712 Signature Structure</strong>: How should we structure the EIP-712 signatures for the compact agreements? Should we include mandate data for additional conditions?</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Answer: For Phase 1 we do not need to add mandate data or Solver Payloads we will incorporate those in a later phase</li>
</ol>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Fallback Mechanisms</strong>: What should happen if the arbiter fails to process a claim? Should we implement emissary fallbacks?</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">If an arbiter fails to process the claim the swap should revert</li>
</ol>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Gas Optimization</strong>: How can we optimize gas usage for the ERC-6909 integration, especially for batch operations?</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">We will optimize gas in phase 2</li>
</ol>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Error Handling</strong>: How should we handle cases where resource locks are insufficient or expired?</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">We revert the transaction with custom errors stating the reason for the failure</li>
</ol>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Integration Points</strong>: Should the ERC-6909 functionality be optional (opt-in) or mandatory for all orders?</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Optional set by a boolean ERC-6909 flag for now</li>
<li class="vocs_ListItem">Later this may move to an enum with additional swap types</li>
</ol>
</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="implementation" class="vocs_Heading_slugTarget"></div>Implementation<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#implementation" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<h4 class="vocs_H4 vocs_Heading"><div id="phase-1-core-contract-development" class="vocs_Heading_slugTarget"></div>Phase 1: Core Contract Development<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#phase-1-core-contract-development" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Create ResourceManager.sol</strong> - New contract</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Register as ResourceManager in The Compact</li>
<li class="vocs_ListItem">Handle resource lock creation and management for makers</li>
<li class="vocs_ListItem">Implement allocator integration for order validation</li>
<li class="vocs_ListItem">Called by ChainLinkCompact to lock resources before swap execution</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Create ChainLinkCompact.sol</strong> - Copy from ChainLinkCalculator.sol</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Add ERC-6909 flag for optional functionality</li>
<li class="vocs_ListItem">Integrate with The Compact for resource lock verification</li>
<li class="vocs_ListItem">Add ERC-6909 token validation before order execution</li>
<li class="vocs_ListItem">Call ResourceManager.sol to lock resources before LimitOrderProtocol execution</li>
<li class="vocs_ListItem">Implement custom error handling for insufficient/expired locks</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Create ChainLinkCompactInteraction.sol</strong> - Copy from RebalancerInteraction.sol</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Implement IArbiter interface for The Compact</li>
<li class="vocs_ListItem">Add resource lock creation for taker&#x27;s output tokens</li>
<li class="vocs_ListItem">Maintain treasurer transfer functionality</li>
<li class="vocs_ListItem">Add EIP-712 signature verification for compact agreements</li>
<li class="vocs_ListItem">Revert entire transaction if arbiter fails to process claim</li>
</ul>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Create Custom Allocator</strong> - Based on Autocator</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Implement IAllocator interface</li>
<li class="vocs_ListItem">Handle end-user (Maker) signing authorization</li>
<li class="vocs_ListItem">Add nonce management for compact claims</li>
<li class="vocs_ListItem">Implement claim authorization logic</li>
<li class="vocs_ListItem">Logic for calling this should be in ChainLinkCompact.t.sol</li>
</ul>
</li>
</ol>
<h4 class="vocs_H4 vocs_Heading"><div id="phase-2-integration--testing" class="vocs_Heading_slugTarget"></div>Phase 2: Integration &amp; Testing<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#phase-2-integration--testing" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ol start="5" class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">
<strong class="vocs_Strong">Compact Registration System</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Implement EIP-712 signature generation for makers (no mandate data for Phase 1)</li>
<li class="vocs_ListItem">Create compact registration functions</li>
<li class="vocs_ListItem">Add chain-specific resource lock scope</li>
<li class="vocs_ListItem">Implement upfront token locking strategy</li>
</ul>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">Testing Suite</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Unit tests for each contract</li>
<li class="vocs_ListItem">Integration tests for end-to-end flow</li>
<li class="vocs_ListItem">Test ERC-6909 flag functionality</li>
<li class="vocs_ListItem">Test custom error handling scenarios</li>
</ul>
</li>
</ol>
<h4 class="vocs_H4 vocs_Heading"><div id="phase-3-advanced-features" class="vocs_Heading_slugTarget"></div>Phase 3: Advanced Features<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#phase-3-advanced-features" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ol start="7" class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">
<strong class="vocs_Strong">Gas Optimization</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Optimize gas usage for ERC-6909 integration</li>
<li class="vocs_ListItem">Implement batch operations optimization</li>
<li class="vocs_ListItem">Profile and optimize critical paths</li>
</ul>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">Enhanced Features</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Add mandate data structure for order conditions</li>
<li class="vocs_ListItem">Implement multichain support</li>
<li class="vocs_ListItem">Create custom Smallocator for smart contract calls</li>
<li class="vocs_ListItem">Add emissary fallback mechanisms</li>
<li class="vocs_ListItem">Implement enum for additional swap types beyond boolean flag</li>
</ul>
</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="technical-architecture" class="vocs_Heading_slugTarget"></div>Technical Architecture<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#technical-architecture" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<strong class="vocs_Strong">Core Flow:</strong>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Maker deposits tokens into The Compact (creates ERC-6909 resource lock)</li>
<li class="vocs_ListItem">Maker signs EIP-712 compact agreement with arbiter (ChainLinkCompactInteraction)</li>
<li class="vocs_ListItem">Order is posted to LimitOrderProtocol with ERC-6909 extension</li>
<li class="vocs_ListItem">Taker fills order through ChainLinkCompact.sol</li>
<li class="vocs_ListItem">ChainLinkCompactInteraction processes claim:<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Verifies resource lock availability</li>
<li class="vocs_ListItem">Executes trade using ChainLinkCalculator logic</li>
<li class="vocs_ListItem">Creates new resource lock for taker&#x27;s output tokens</li>
<li class="vocs_ListItem">Transfers tokens to treasurer</li>
<li class="vocs_ListItem">Calls ResourceManager to lock funds</li>
</ul>
</li>
</ol>
<strong class="vocs_Strong">Key Interfaces:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">ITheCompact</code> - For resource lock management</li>
<li class="vocs_ListItem"><code class="vocs_Code">IAllocator</code> - For claim authorization</li>
<li class="vocs_ListItem"><code class="vocs_Code">IArbiter</code> - For claim processing</li>
<li class="vocs_ListItem"><code class="vocs_Code">IEmissary</code> - For fallback verification</li>
</ul>
<strong class="vocs_Strong">Data Structures:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">Compact</code> - EIP-712 payload for single resource lock</li>
<li class="vocs_ListItem"><code class="vocs_Code">BatchCompact</code> - EIP-712 payload for multiple resource locks</li>
<li class="vocs_ListItem"><code class="vocs_Code">Mandate</code> - Witness data for order conditions</li>
<li class="vocs_ListItem"><code class="vocs_Code">Claim</code> - Claim payload for processing</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="future-test-enhancements" class="vocs_Heading_slugTarget"></div>Future Test Enhancements<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#future-test-enhancements" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">For ERC-6909 integration, additional test categories will be needed:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">
<strong class="vocs_Strong">ERC-6909 Resource Lock Tests</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Resource lock creation and validation</li>
<li class="vocs_ListItem">Insufficient lock handling</li>
<li class="vocs_ListItem">Lock expiration scenarios</li>
</ul>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">Compact Integration Tests</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">EIP-712 signature verification</li>
<li class="vocs_ListItem">Compact agreement validation</li>
<li class="vocs_ListItem">Arbiter claim processing</li>
</ul>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">Resource Manager Tests</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Lock management functionality</li>
<li class="vocs_ListItem">Allocator integration</li>
<li class="vocs_ListItem">Error handling for resource conflicts</li>
</ul>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">End-to-End Flow Tests</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Complete maker-to-taker flow</li>
<li class="vocs_ListItem">Treasurer integration</li>
<li class="vocs_ListItem">Cross-contract interaction validation</li>
</ul>
</li>
</ol>
<h2 class="vocs_H2 vocs_Heading"><div id="near-fusion-smart-contract-development-1" class="vocs_Heading_slugTarget"></div>NEAR FUSION+ Smart Contract Development<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#near-fusion-smart-contract-development-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="near-smart-contract-architecture" class="vocs_Heading_slugTarget"></div>NEAR Smart Contract Architecture<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#near-smart-contract-architecture" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><img src="https://hackmd.io/_uploads/HydB7D3Pxe.png" alt="NEARArchitecture"/></p>
<h3 class="vocs_H3 vocs_Heading"><div id="near-limit-order-protocol-contracts" class="vocs_Heading_slugTarget"></div>NEAR Limit Order Protocol Contracts<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#near-limit-order-protocol-contracts" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><img src="https://hackmd.io/_uploads/Hkg8QPnvee.png" alt="NEARLimitOrder"/></p>
<h3 class="vocs_H3 vocs_Heading"><div id="near-escrow-smart-contracts" class="vocs_Heading_slugTarget"></div>NEAR Escrow Smart Contracts<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#near-escrow-smart-contracts" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph"><img src="https://hackmd.io/_uploads/S1tqDDhvgg.png" alt="NEAR Escrow"/></p>
<h3 class="vocs_H3 vocs_Heading"><div id="overview-1" class="vocs_Heading_slugTarget"></div>Overview<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#overview-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">NEAR Fusion+ is a comprehensive DeFi protocol that migrates 1inch&#x27;s Limit Order Protocol and Cross-Chain Swap functionality to the NEAR blockchain. This project implements advanced trading features including limit orders, cross-chain atomic swaps, and sophisticated escrow mechanisms.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="architecture-1" class="vocs_Heading_slugTarget"></div>Architecture<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#architecture-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The protocol consists of several interconnected smart contracts that work together to provide a complete DeFi trading experience:</p>
<h4 class="vocs_H4 vocs_Heading"><div id="core-components-1" class="vocs_Heading_slugTarget"></div>Core Components<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#core-components-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Limit Order Protocol</strong> - Handles limit order creation, execution, and management</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Cross-Chain Swap</strong> - Enables atomic swaps across different blockchains</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Escrow System</strong> - Manages secure fund escrow for cross-chain operations</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Fee Management</strong> - Handles fee collection and distribution</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Merkle Validation</strong> - Provides proof validation for complex order structures</li>
</ol>
<h4 class="vocs_H4 vocs_Heading"><div id="contract-structure" class="vocs_Heading_slugTarget"></div>Contract Structure<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#contract-structure" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">src/</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">├── limit-order-protocol/     # Main limit order functionality</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">├── cross-chain-swap/         # Cross-chain atomic swap implementation</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">├── base-escrow-factory/      # Advanced escrow factory with Merkle validation</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">├── escrow-factory/           # Standard escrow factory</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">├── escrow-src/              # Source chain escrow contract</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">├── escrow-dst/              # Destination chain escrow contract</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">├── fee-taker/               # Fee collection and management</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">└── merkle-storage-invalidator/ # Merkle proof validation</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="key-features-2" class="vocs_Heading_slugTarget"></div>Key Features<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#key-features-2" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Limit Orders</strong>: Advanced limit order protocol with partial fills and multiple execution strategies</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Cross-Chain Swaps</strong>: Atomic swaps between different blockchains with time-locked escrows</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Merkle Proofs</strong>: Efficient validation for complex order structures</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Fee Management</strong>: Flexible fee collection and distribution mechanisms</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Security</strong>: Comprehensive validation and timelock mechanisms</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="documentation-sections" class="vocs_Heading_slugTarget"></div>Documentation Sections<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#documentation-sections" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/near-fusion-plus/protocol/tree/main/docs.architecture.md" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Architecture Overview</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/near-fusion-plus/protocol/tree/main/docs.contracts/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Contract Documentation</a>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/near-fusion-plus/protocol/tree/main/docs.contracts/limit-order-protocol.md" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Limit Order Protocol</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/near-fusion-plus/protocol/tree/main/docs.contracts/cross-chain-swap.md" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Cross-Chain Swap</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/near-fusion-plus/protocol/tree/main/docs.contracts/escrow-system.md" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Escrow System</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/near-fusion-plus/protocol/tree/main/docs.contracts/fee-taker.md" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Fee Taker</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/near-fusion-plus/protocol/tree/main/docs.contracts/merkle-storage-invalidator.md" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Merkle Storage Invalidator</a></li>
</ul>
</li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/near-fusion-plus/protocol/tree/main/docs.integration.md" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Integration Guide</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/near-fusion-plus/protocol/tree/main/docs.security.md" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Security Considerations</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/near-fusion-plus/protocol/tree/main/docs.api-reference.md" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">API Reference</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/near-fusion-plus/protocol/tree/main/docs.deployment.md" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Deployment Guide</a></li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="quick-start" class="vocs_Heading_slugTarget"></div>Quick Start<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#quick-start" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Build Contracts</strong>: <code class="vocs_Code">cargo near build</code></li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Run Tests</strong>: <code class="vocs_Code">cargo test</code></li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Deploy</strong>: Use the deployment scripts in <code class="vocs_Code">deployment-scripts/</code></li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="development" class="vocs_Heading_slugTarget"></div>Development<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#development" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Rust Version</strong>: See <code class="vocs_Code">rust-toolchain.toml</code></li>
<li class="vocs_ListItem"><strong class="vocs_Strong">NEAR SDK</strong>: v5.15.1</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Testing</strong>: Integration tests in <code class="vocs_Code">integration-tests/</code></li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="contributing" class="vocs_Heading_slugTarget"></div>Contributing<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/tycho1inchNOL#contributing" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Please refer to the main <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator-united-defi-2025/near-fusion-plus/blob/main/README.md" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">README.md</a> for development setup and contribution guidelines.</p></article><footer class="vocs_Footer" data-layout="docs"><div class="vocs_Footer_container"></div></footer></div><div data-bottom-observer="true"></div></div></div>
  </body>
</html>
