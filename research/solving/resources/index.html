<!doctype html>
<html lang="en" data-vocs>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="/initializeTheme.iife.js"></script><link rel="preload" as="image" href="/images/jincubator.png"/><title>Resource Management – Jincubator</title><link rel="icon" href="/images/jincubator.png" type="image/png"/><meta property="og:type" content="website"/><meta property="og:title" content="Resource Management"/><meta property="og:url" content="/"/><meta property="og:image" content="https://vocs.dev/api/og?logo=//images/jincubator.png&title=Resource Management&description="/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:image" content="https://vocs.dev/api/og?logo=//images/jincubator.png&title=Resource%20Management&description=undefined"/>
    <script type="module" crossorigin src="/assets/index-CsmQaVFF.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/style-CgUDpFKq.css">
  </head>
  <body>
    <div id="app"><base href="/"/><div class="vocs_DocsLayout" data-layout="docs"><a class="vocs_SkipLink vocs_utils_visuallyHidden" href="/research/solving/resources#vocs-content">Skip to content</a><div class="vocs_DocsLayout_gutterLeft"><aside class="vocs_Sidebar vocs_DocsLayout_sidebar"><div><div class="vocs_Sidebar_logoWrapper"><div class="vocs_Sidebar_logo"><a style="align-items:center;display:flex;height:100%" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/images/jincubator.png"/></a></div><div class="vocs_Sidebar_divider"></div></div><nav class="vocs_Sidebar_navigation"><div class="vocs_Sidebar_group"><section class="vocs_Sidebar_section"><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/intro" variant="styleless" data-discover="true">Research</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Solving and Arbitrage (2025)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/intro" variant="styleless" data-discover="true">Design Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/architecture" variant="styleless" data-discover="true">Architecture</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/protocol" variant="styleless" data-discover="true">Protocol</a><a data-active="true" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/resources" variant="styleless" data-discover="true">Resource Management</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/flow" variant="styleless" data-discover="true">IntentSwap Flow</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/hooks" variant="styleless" data-discover="true">Hook Design - WIP</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader" role="button" tabindex="0"><div class="vocs_Sidebar_sectionTitle">Layer 1 Platforms (2022/2023)</div><div role="button" tabindex="0"><div aria-label="toggle section" class="vocs_Icon vocs_Sidebar_sectionCollapse" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Right</title><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/intro" variant="styleless" data-discover="true">Layer 1 Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/avalanche" variant="styleless" data-discover="true">Avalanche</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/binance" variant="styleless" data-discover="true">Binance Smart Chain</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/cosmos" variant="styleless" data-discover="true">Cosmos</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/ethereum-1-0" variant="styleless" data-discover="true">Ethereum 1.0</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/ethereum" variant="styleless" data-discover="true">Ethereum</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/NEAR" variant="styleless" data-discover="true">NEAR</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/harmony" variant="styleless" data-discover="true">Harmony</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/polkadot" variant="styleless" data-discover="true">Polkadot</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/polygon" variant="styleless" data-discover="true">Polygon</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Code Reviews (2022/2023)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/intro" variant="styleless" data-discover="true">Code Review Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/horizon" variant="styleless" data-discover="true">Horizon Bridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/ethereum-near" variant="styleless" data-discover="true">Ethereum Near Bridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/ethereum" variant="styleless" data-discover="true">Ethereum</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Cross Chain Bridges (2022/2023)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/intro" variant="styleless" data-discover="true">Bridging Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/cosmos-ibc" variant="styleless" data-discover="true">Cosmos IBC</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/harmony-horizon" variant="styleless" data-discover="true">Harmony Horizon</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/isomorph" variant="styleless" data-discover="true">Isomorph</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/near-rainbow" variant="styleless" data-discover="true">Near Rainbow Bridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/polymerlabs" variant="styleless" data-discover="true">Polymer Labs</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/snowbridge" variant="styleless" data-discover="true">Snowbridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/succinct" variant="styleless" data-discover="true">Succint</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Zero Knowledge (2022/2023)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/intro" variant="styleless" data-discover="true">Zero Knowledge Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/zkpos" variant="styleless" data-discover="true">ZK Proof of Stake</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/zksnarks" variant="styleless" data-discover="true">zk-Snarks</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/axiom" variant="styleless" data-discover="true">Axiom</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Primitives (2022/2023)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/intro" variant="styleless" data-discover="true">Primitives Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/fraud-proofs" variant="styleless" data-discover="true">Fraud Proofs</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/light-clients" variant="styleless" data-discover="true">Light Clients</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/primitives" variant="styleless" data-discover="true">Cryptogaphic Primitives</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/weak-subjectivity" variant="styleless" data-discover="true">Weak Subjectivity</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/signatures" variant="styleless" data-discover="true">Signature Schemes</a></div></section></div></nav></div><div class="vocs_Sidebar_footer"><div class="vocs_Sidebar_footerCurtain"></div><div class="vocs_Sidebar_footerContent"></div></div></aside></div><div class="vocs_DocsLayout_gutterTop vocs_DocsLayout_gutterTop_offsetLeftGutter"><div class="vocs_DesktopTopNav"><button class="vocs_DesktopSearch_search" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«Rlj»" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-top:2px"><path d="M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>Search...<div class="vocs_DesktopSearch_searchCommand"><div style="background:currentColor;transform:rotate(45deg);width:1.5px;border-radius:2px;height:100%"></div></div></button><div class="vocs_DesktopTopNav_logoWrapper"><div class="vocs_DesktopTopNav_logo"><a style="align-items:center;display:flex;height:56px;margin-top:4px" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/images/jincubator.png"/></a></div></div><div class="vocs_DesktopTopNav_section"></div><div class="vocs_DesktopTopNav_section"><div class="vocs_DesktopTopNav_group"><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="vocs_NavigationMenu"><div style="position:relative"><ul data-orientation="horizontal" class="vocs_NavigationMenu_list" dir="ltr"><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/research/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Research</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/hackathons/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Hackathons</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/products/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Products</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/partnerships/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Partnerships</a></ul></div></nav></div></div></div><div class="vocs_MobileTopNav"><div class="vocs_MobileTopNav_section"><div class="vocs_MobileTopNav_group"><div class="vocs_MobileTopNav_logo"><a style="align-items:center;display:flex;height:100%" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/images/jincubator.png"/></a></div></div><div class="vocs_MobileTopNav_group"><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="vocs_MobileTopNav_navigation vocs_NavigationMenu"><div style="position:relative"><ul data-orientation="horizontal" class="vocs_NavigationMenu_list" dir="ltr"><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/research/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Research</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/hackathons/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Hackathons</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/products/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Products</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/partnerships/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Partnerships</a></ul></div></nav><div class="vocs_MobileTopNav_navigation vocs_MobileTopNav_navigation_compact"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«Rkpj»" data-state="closed" class="vocs_MobileTopNav_menuTrigger vocs_MobileTopNav_navigationItem">Menu<div aria-label="Menu" class="vocs_Icon" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Down</title><path d="M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="vocs_MobileTopNav_section"><div class="vocs_MobileTopNav_group" style="margin-right:-8px"><button class="vocs_MobileSearch_searchButton" type="button" aria-label="Search" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«R19j»" data-state="closed"><svg width="21" height="21" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div></div></div></div><div class="vocs_DocsLayout_gutterTopCurtain vocs_DocsLayout_gutterTopCurtain_withSidebar"><div class="vocs_DesktopTopNav_curtain"></div><div class="vocs_MobileTopNav_curtain"><div class="vocs_MobileTopNav_curtainGroup"><div class="vocs_MobileTopNav_curtainItem"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«Rqj»" data-state="closed" class="vocs_MobileTopNav_menuTrigger"><div aria-label="Menu" class="vocs_Icon" role="img" style="--vocs_Icon_size:13px"><svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 79 48" fill="none"><title>Menu</title><path fill="currentColor" d="M19.528 47.232h40.87c1.952 0 3.515-1.562 3.515-3.564a3.5 3.5 0 0 0-3.516-3.516H19.528a3.501 3.501 0 0 0-3.515 3.516c0 2.002 1.562 3.564 3.515 3.564ZM12.057 27.262h55.81a3.501 3.501 0 0 0 3.516-3.516 3.501 3.501 0 0 0-3.515-3.515h-55.81a3.501 3.501 0 0 0-3.516 3.515 3.501 3.501 0 0 0 3.515 3.516ZM4.391 7.34H75.29c2.002 0 3.515-1.563 3.515-3.516 0-2.002-1.513-3.564-3.515-3.564H4.39C2.438.26.876 1.822.876 3.824A3.501 3.501 0 0 0 4.39 7.34Z"></path></svg></div><div class="vocs_MobileTopNav_menuTitle">Resource Management</div></button></div></div><div class="vocs_MobileTopNav_curtainGroup"><div class="vocs_MobileTopNav_curtainItem"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-«R5aj»" data-state="closed" class="vocs_MobileTopNav_outlineTrigger">On this page<div aria-label="On this page" class="vocs_Icon" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Right</title><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button></div></div></div></div><div class="vocs_DocsLayout_gutterRight vocs_DocsLayout_gutterRight_withSidebar"></div><div id="vocs-content" class="vocs_DocsLayout_content vocs_DocsLayout_content_withSidebar vocs_DocsLayout_content_withTopNav"><article class="vocs_Content"><header class="vocs_Header"><h1 class="vocs_H1 vocs_Heading"><div id="resource-management" class="vocs_Heading_slugTarget"></div>Resource Management<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#resource-management" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h1></header>
<h2 class="vocs_H2 vocs_Heading"><div id="overview" class="vocs_Heading_slugTarget"></div>Overview<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#overview" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">The Protocol leverages an expansive locking system from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator/the-compact/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">the-compact</a>. We have incorporated <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="/protocol" data-discover="true">Mandates and Solver Payloads</a> to allow Intents to be solved on a single chain without provisioning up front capital as we arbiters can confirm mandates have been met by solvers at execution time, thus solvers may use the swappers locked funds for execution.</p>
<blockquote class="vocs_Blockquote">
<p class="vocs_Paragraph">As of July 25th the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/jincubator/the-compact/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">the-compact</a> we are developing on has been forked from <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://github.com/Uniswap/the-compact/tree/v1" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Uniswap the-compact</a> v1 branch which has not as yet been deployed.</p>
</blockquote>
<h2 class="vocs_H2 vocs_Heading"><div id="summary" class="vocs_Heading_slugTarget"></div>Summary<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#summary" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">The Compact is an ownerless ERC6909 contract that facilitates the voluntary formation and mediation of reusable <strong class="vocs_Strong">resource locks</strong>. It enables tokens to be credibly committed to be spent in exchange for performing actions across arbitrary, asynchronous environments, and claimed once the specified conditions have been met.</p>
<p class="vocs_Paragraph">Resource locks are entered into by ERC20 or native token holders (called the <strong class="vocs_Strong">depositor</strong>). Once a resource lock has been established, the owner of the ERC6909 token representing a resource lock can act as a <strong class="vocs_Strong">sponsor</strong> and create a <strong class="vocs_Strong">compact</strong>. A compact is a commitment allowing interested parties to claim their tokens through the sponsor&#x27;s indicated <strong class="vocs_Strong">arbiter</strong>. The arbiter is then responsible for processing the claim once it has attested to the specified conditions of the compact having been met.</p>
<p class="vocs_Paragraph">When depositing into a resource lock, the depositor assigns an <strong class="vocs_Strong">allocator</strong> and a <strong class="vocs_Strong">reset period</strong> for that lock. The allocator is tasked with providing additional authorization whenever the owner of the lock wishes to transfer their 6909 tokens, withdraw the underlying locked assets, or sponsor a compact utilizing the lock. Their primary role is essentially to protect <strong class="vocs_Strong">claimants</strong>—entities that provide proof of having met the conditions and subsequently make a claim against a compact—by ensuring the credibility of commitments, such as preventing &quot;double-spends&quot; involving previously-committed locked balances.</p>
<p class="vocs_Paragraph">Allocators can be purely onchain abstractions, or can involve hybrid (onchain + offchain) mechanics as part of their authorization procedure. Should an allocator erroneously or maliciously fail to authorize the use of an unallocated resource lock balance, the depositor can initiate a <strong class="vocs_Strong">forced withdrawal</strong> for the lock in question; after waiting for the reset period indicated when depositing into the lock, they can withdraw their underlying balance at will <em>without</em> the allocator&#x27;s explicit permission.</p>
<p class="vocs_Paragraph">Sponsors can also optionally assign an <strong class="vocs_Strong">emissary</strong> to act as a fallback signer for authorizing claims against their compacts. This is particularly helpful for smart contract accounts or other scenarios where signing keys might change.</p>
<p class="vocs_Paragraph">The Compact effectively &quot;activates&quot; any deposited tokens to be instantly spent or swapped across arbitrary, asynchronous environments as long as:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Claimants are confident that the allocator is sound and will not leave the resource lock underallocated.</li>
<li class="vocs_ListItem">Sponsors are confident that the allocator will not unduly censor fully allocated requests.</li>
<li class="vocs_ListItem">Sponsors are confident that the arbiter is sound and will not process claims where the conditions were not successfully met.</li>
<li class="vocs_ListItem">Claimants are confident that the arbiter is sound and will not <em>fail</em> to process claims where the conditions <em>were</em> successfully met.</li>
</ul>
<h2 class="vocs_H2 vocs_Heading"><div id="key-concepts" class="vocs_Heading_slugTarget"></div>Key Concepts<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#key-concepts" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="resource-locks" class="vocs_Heading_slugTarget"></div>Resource Locks<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#resource-locks" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Resource locks are the fundamental building blocks of The Compact protocol. They are created when a depositor places tokens (either native tokens or ERC20 tokens) into The Compact. Each resource lock has four key properties:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">The <strong class="vocs_Strong">underlying token</strong> held in the resource lock.</li>
<li class="vocs_ListItem">The <strong class="vocs_Strong">allocator</strong> tasked with cosigning on claims against the resource locks (see <a class="vocs_Anchor" href="/research/solving/resources#allocators">Allocators</a>).</li>
<li class="vocs_ListItem">The <strong class="vocs_Strong">scope</strong> of the resource lock (either spendable on any chain or limited to a single chain).</li>
<li class="vocs_ListItem">The <strong class="vocs_Strong">reset period</strong> for forcibly exiting the lock (see <a class="vocs_Anchor" href="/research/solving/resources#forced-withdrawals">Forced Withdrawals</a>) and for emissary reassignment timelocks (see <a class="vocs_Anchor" href="/research/solving/resources#emissaries">Emissaries</a>).</li>
</ol>
<p class="vocs_Paragraph">Each unique combination of these four properties is represented by a fungible ERC6909 tokenID. The owner of these ERC6909 tokens can act as a sponsor and create compacts.</p>
<p class="vocs_Paragraph">The <code class="vocs_Code">scope</code>, <code class="vocs_Code">resetPeriod</code>, and the <code class="vocs_Code">allocatorId</code> (obtained when an allocator is registered) are packed into a <code class="vocs_Code">bytes12 lockTag</code>. A resource lock&#x27;s specific ID (the ERC6909 <code class="vocs_Code">tokenId</code>) is a concatenation of this <code class="vocs_Code">lockTag</code> and the underlying <code class="vocs_Code">token</code> address, represented as a <code class="vocs_Code">uint256</code> for ERC6909 compatibility. This <code class="vocs_Code">lockTag</code> is used throughout various interfaces to succinctly identify the parameters of a lock.</p>
<strong class="vocs_Strong">Fee-on-Transfer and Rebasing Token Handling:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Fee-on-Transfer:</strong> The Compact correctly handles fee-on-transfer tokens for both deposits and withdrawals. The amount of ERC6909 tokens minted or burned is based on the <em>actual balance change</em> in The Compact contract, not just the specified amount. This ensures ERC6909 tokens accurately represent the underlying assets.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Rebasing Tokens:</strong> <strong class="vocs_Strong">Rebasing tokens (e.g., stETH) are NOT supported in The Compact V1.</strong> Any yield or other balance changes occurring <em>after</em> deposit will not accrue to the depositor&#x27;s ERC6909 tokens. For such assets, use their wrapped, non-rebasing counterparts (e.g., wstETH) to avoid loss of value.</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="allocators" class="vocs_Heading_slugTarget"></div>Allocators<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#allocators" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Each resource lock is mediated by an <strong class="vocs_Strong">allocator</strong>. Their primary responsibilities include:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Preventing Double-Spending:</strong> Ensuring sponsors don&#x27;t commit the same tokens to multiple compacts or transfer away committed funds.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Validating Transfers:</strong> Attesting to standard ERC6909 transfers of resource lock tokens (via <code class="vocs_Code">IAllocator.attest</code>).</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Authorizing Claims:</strong> Validating claims against resource locks (via <code class="vocs_Code">IAllocator.authorizeClaim</code>).</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Nonce Management:</strong> Ensuring nonces are not reused for claims and (optionally) consuming nonces directly on The Compact using <code class="vocs_Code">consume</code>.</li>
</ol>
<p class="vocs_Paragraph">Allocators must be registered with The Compact via <code class="vocs_Code">__registerAllocator</code> before they can be assigned to locks. They must implement the <code class="vocs_Code">IAllocator</code> interface and operate under specific <a class="vocs_Anchor" href="/research/solving/resources#trust-assumptions">trust assumptions</a>.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="arbiters" class="vocs_Heading_slugTarget"></div>Arbiters<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#arbiters" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Arbiters are responsible for verifying and submitting claims. When a sponsor creates a compact, they designate an arbiter who will:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Verify that the specified conditions of the compact have been met (these conditions can be implicitly understood or explicitly defined via witness data).</li>
<li class="vocs_ListItem">Process the claim by calling the appropriate function on The Compact (from <code class="vocs_Code">ITheCompactClaims</code>).</li>
<li class="vocs_ListItem">Specify which claimants are entitled to the committed resources and in what form each claimant&#x27;s portion will be issued (i.e., direct transfer, withdrawal, or conversion) as part of the claim payload.</li>
</ol>
<p class="vocs_Paragraph">Often, the entity fulfilling an off-chain condition (like a filler or solver) might interface directly with the arbiter. The <a class="vocs_Anchor" href="/research/solving/resources#trust-assumptions">trust assumptions</a> around arbiters are critical to understand.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="emissaries" class="vocs_Heading_slugTarget"></div>Emissaries<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#emissaries" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Emissaries provide a fallback verification mechanism for sponsors when authorizing claims. This is particularly useful for:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Smart contract accounts that might update their EIP-1271 signature verification logic.</li>
<li class="vocs_ListItem">Accounts using EIP-7702 delegation that leverages EIP-1271.</li>
<li class="vocs_ListItem">Situations where the sponsor wants to delegate claim verification to a trusted third party.</li>
</ol>
<p class="vocs_Paragraph">A sponsor assigns an emissary for a specific <code class="vocs_Code">lockTag</code> using <code class="vocs_Code">assignEmissary</code>. The emissary must implement the <code class="vocs_Code">IEmissary</code> interface, specifically the <code class="vocs_Code">verifyClaim</code> function.</p>
<p class="vocs_Paragraph">To change an emissary after one has been assigned, the sponsor must first call <code class="vocs_Code">scheduleEmissaryAssignment</code>, wait for the <code class="vocs_Code">resetPeriod</code> associated with the <code class="vocs_Code">lockTag</code> to elapse, and then call <code class="vocs_Code">assignEmissary</code> again with the new emissary&#x27;s address (or <code class="vocs_Code">address(0)</code> to remove).</p>
<h3 class="vocs_H3 vocs_Heading"><div id="compacts--eip-712-payloads" class="vocs_Heading_slugTarget"></div>Compacts &amp; EIP-712 Payloads<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#compacts--eip-712-payloads" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">A <strong class="vocs_Strong">compact</strong> is the agreement created by a sponsor that allows their locked resources to be claimed under specified conditions. The Compact protocol uses EIP-712 typed structured data for creating and verifying signatures for these agreements.</p>
<p class="vocs_Paragraph">There are three main EIP-712 payload types a sponsor can sign:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong"><code class="vocs_Code">Compact</code></strong>: For single resource lock operations on a single chain.</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Defined in src/types/EIP712Types.sol</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Compact</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> arbiter;    </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The account tasked with verifying and submitting the claim.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> sponsor;    </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The account to source the tokens from.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> nonce;      </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// A parameter to enforce replay protection, scoped to allocator.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> expires;    </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The time at which the claim expires.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes12</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> lockTag;    </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// A tag representing the allocator, reset period, and scope.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> token;      </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The locked token, or address(0) for native tokens.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> amount;     </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The amount of ERC6909 tokens to commit from the lock.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // (Optional) Witness data may follow:</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Mandate mandate;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong"><code class="vocs_Code">BatchCompact</code></strong>: For allocating multiple resource locks on a single chain.</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Defined in src/types/EIP712Types.sol</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> BatchCompact</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> arbiter;            </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The account tasked with verifying and submitting the claim.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> sponsor;            </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The account to source the tokens from.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> nonce;              </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// A parameter to enforce replay protection, scoped to allocator.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> expires;            </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The time at which the claim expires.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    Lock[] commitments;         </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The committed locks with lock tags, tokens, &amp; amounts.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // (Optional) Witness data may follow:</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Mandate mandate;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Lock</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes12</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> lockTag;    </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// A tag representing the allocator, reset period, and scope.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> token;      </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The locked token, or address(0) for native tokens.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> amount;     </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The maximum committed amount of tokens.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong"><code class="vocs_Code">MultichainCompact</code></strong>: For allocating one or more resource locks across multiple chains.</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Defined in src/types/EIP712Types.sol</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> MultichainCompact</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> sponsor; </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The account to source the tokens from.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> nonce; </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// A parameter to enforce replay protection, scoped to allocator.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> expires; </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The time at which the claim expires.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">Element[] elements; </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Arbiter, chainId, commitments, and mandate for each chain.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Defined in src/types/EIP712Types.sol</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Element</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> arbiter;            </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The account tasked with verifying and submitting the claim.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> chainId;            </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The chainId where the tokens are located.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        Lock[] commitments;         </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The committed locks with lock tags, tokens, &amp; amounts.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Witness data MUST follow (mandatory for multichain compacts):</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        Mandate mandate;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    ```</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">The `Mandate` </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> within</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> these payloads is </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">for</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> [Witness Structure](#witness</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">structure). The EIP</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">712</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> typehash </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">for</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> these structures is constructed dynamically; empty `Mandate` structs result in a typestring without witness data. Witness data is optional _except_ in a `MultichainCompact`; a multichain compact&#x27;s elements </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">**</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">must</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">**</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> include a witness.</span></span></code></pre></div></div>
</li>
</ol>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Permit2 Integration Payloads:</strong>
The Compact also supports integration with Permit2 for gasless deposits, using additional EIP-712 structures for witness data within Permit2 messages:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">CompactDeposit(bytes12 lockTag,address recipient)</code>: For basic Permit2 deposits.</li>
<li class="vocs_ListItem"><code class="vocs_Code">Activation(address activator,uint256 id,Compact compact)Compact(...)Mandate(...)</code>: Combines deposits with single compact registration.</li>
<li class="vocs_ListItem"><code class="vocs_Code">BatchActivation(address activator,uint256[] ids,Compact compact)Compact(...)Mandate(...)</code>: Combines deposits with batch compact registration.</li>
</ul>
<p class="vocs_Paragraph"><strong class="vocs_Strong">CompactCategory Enum:</strong>
The Compact introduces a <code class="vocs_Code">CompactCategory</code> enum to distinguish between different types of compacts when using Permit2 integration:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Defined in src/types/CompactCategory.sol</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">enum</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> CompactCategory</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    Compact</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    BatchCompact</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    MultichainCompact</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="witness-structure" class="vocs_Heading_slugTarget"></div>Witness Structure<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#witness-structure" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The witness mechanism (<code class="vocs_Code">Mandate</code> struct) allows extending compacts with additional data for specifying conditions or parameters for a claim. The Compact protocol itself doesn&#x27;t interpret the <code class="vocs_Code">Mandate</code>&#x27;s content; this is the responsibility of the arbiter. However, The Compact uses the hash of the witness data and its reconstructed EIP-712 typestring to derive the final claim hash for validation.</p>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Format:</strong>
The witness is always a <code class="vocs_Code">Mandate</code> struct appended to the compact.</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Compact</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(..., Mandate mandate)</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">Mandate</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> myArg, </span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">bytes32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> otherArg)</span></span></code></pre></div></div>
<p class="vocs_Paragraph">The <code class="vocs_Code">witnessTypestring</code> provided during a claim should be the arguments <em>inside</em> the <code class="vocs_Code">Mandate</code> struct (e.g., <code class="vocs_Code">uint256 myArg,bytes32 otherArg</code>), followed by any nested structs. Note that there are no assumptions made by the protocol about the shape of the <code class="vocs_Code">Mandate</code> or any nested structs within it.</p>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Nested Structs:</strong>
EIP-712 requires nested structs to be ordered alphanumerically after the top-level struct in the typestring. We recommend prefixing nested structs with &quot;Mandate&quot; (e.g., <code class="vocs_Code">MandateCondition</code>) to ensure correct ordering. Failure to do so will result in an <em>invalid</em> EIP-712 typestring.</p>
<p class="vocs_Paragraph">For example, the correct witness typestring for <code class="vocs_Code">Mandate(MandateCondition condition,uint256 arg)MandateCondition(bool flag,uint256 val)</code> would be <code class="vocs_Code">MandateCondition condition,uint256 arg)MandateCondition(bool flag,uint256 val</code> (<em>without</em> a closing parenthesis).</p>
<blockquote class="vocs_Blockquote">
<p class="vocs_Paragraph">☝️ Note the missing closing parenthesis in the above example. It will be added by the protocol during the dynamic typestring construction, so <strong class="vocs_Strong">do not include the closing parenthesis in your witness typestring.</strong> This is crucial, otherwise the generated typestring <em>will be invalid</em>.</p>
</blockquote>
<h3 class="vocs_H3 vocs_Heading"><div id="registration" class="vocs_Heading_slugTarget"></div>Registration<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#registration" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">As an alternative to sponsors signing EIP-712 payloads, compacts can be <em>registered</em> directly on The Compact contract. This involves submitting a <code class="vocs_Code">claimHash</code> (derived from the intended compact details) and its <code class="vocs_Code">typehash</code>.
This supports:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Sponsors without direct signing capabilities (e.g., DAOs, protocols).</li>
<li class="vocs_ListItem">Smart wallet / EIP-7702 enabled sponsors with alternative signature logic.</li>
<li class="vocs_ListItem">Chained deposit-and-register operations.</li>
</ul>
<p class="vocs_Paragraph">Registration can be done by the sponsor or a third party (if they provide the sponsor&#x27;s signature for <code class="vocs_Code">registerFor</code> type functions, or if they are providing the deposited tokens). Registrations do not expire, and registered compacts cannot be unregistered by the sponsor. Registrations can be invalidated by the allocator consuming the nonce, or by letting them expire. Once a claim is processed for a compact its registration state is cleared.</p>
<p class="vocs_Paragraph">The current registration status for a given claim can be queried via the <code class="vocs_Code">ITheCompact.isRegistered</code> function:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">bool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> isRegistered </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> theCompact.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">isRegistered</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(sponsor, claimHash, typehash);</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="claimant-processing--structure" class="vocs_Heading_slugTarget"></div>Claimant Processing &amp; Structure<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#claimant-processing--structure" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">When an arbiter submits a claim, they provide an array of <code class="vocs_Code">Component</code> structs. Each <code class="vocs_Code">Component</code> specifies an <code class="vocs_Code">amount</code> and a <code class="vocs_Code">claimant</code>.</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Defined in src/types/Components.sol</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Component</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> claimant; </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The lockTag + recipient of the transfer or withdrawal.</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> amount;   </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// The amount of tokens to transfer or withdraw.</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<p class="vocs_Paragraph">The <code class="vocs_Code">claimant</code> field encodes both the <code class="vocs_Code">recipient</code> address (lower 160 bits) and a <code class="vocs_Code">bytes12 lockTag</code> (upper 96 bits): <code class="vocs_Code">claimant = (lockTag &lt;&lt; 160) | recipient</code>.</p>
<p class="vocs_Paragraph">This encoding determines how The Compact processes each component of the claim:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Direct ERC6909 Transfer:</strong> If the encoded <code class="vocs_Code">lockTag</code> matches the <code class="vocs_Code">lockTag</code> of the resource lock being claimed, the <code class="vocs_Code">amount</code> of ERC6909 tokens is transferred directly to the <code class="vocs_Code">recipient</code>.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Convert Between Resource Locks:</strong> If the encoded <code class="vocs_Code">lockTag</code> is non-zero and <em>different</em> from the claimed lock&#x27;s tag, The Compact attempts to <em>convert</em> the claimed resource lock to a new one defined by the encoded <code class="vocs_Code">lockTag</code> for the <code class="vocs_Code">recipient</code>. This allows changing allocator, reset period, or scope.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Withdraw Underlying Tokens:</strong> If the encoded <code class="vocs_Code">lockTag</code> is <code class="vocs_Code">bytes12(0)</code>, The Compact attempts to withdraw the underlying tokens (native or ERC20) from the resource lock and send them to the <code class="vocs_Code">recipient</code>.</li>
</ol>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Withdrawal Fallback Mechanism:</strong>
To prevent griefing (e.g., via malicious receive hooks during withdrawals, or relayed claims that intentionally underpay the necessary amount of gas), The Compact first attempts withdrawals with half the available gas. If this fails (and sufficient gas remains above a benchmarked stipend), it falls back to a direct ERC6909 transfer to the recipient. Stipends can be queried via <code class="vocs_Code">getRequiredWithdrawalFallbackStipends</code>. Benchmarking for these stipends is done via a call to <code class="vocs_Code">__benchmark</code> post-deployment, which meters cold account access and typical ERC20 and native transfers. This benchmark can be re-run by anyone at any time.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="forced-withdrawals" class="vocs_Heading_slugTarget"></div>Forced Withdrawals<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#forced-withdrawals" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">This mechanism provides sponsors recourse if an allocator becomes unresponsive or censors requests.</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Enable:</strong> Sponsor calls <code class="vocs_Code">enableForcedWithdrawal(uint256 id)</code>.</p>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Wait:</strong> The <code class="vocs_Code">resetPeriod</code> for that resource lock must elapse.</p>
</li>
<li class="vocs_ListItem">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Withdraw:</strong> Sponsor calls <code class="vocs_Code">forcedWithdrawal(uint256 id, address recipient, uint256 amount)</code> to retrieve the underlying tokens.</p>
</li>
</ol>
<p class="vocs_Paragraph">The forced withdrawal state can be reversed with <code class="vocs_Code">disableForcedWithdrawal(uint256 id)</code>.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="signature-verification" class="vocs_Heading_slugTarget"></div>Signature Verification<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#signature-verification" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">When a claim is submitted for a non-registered compact (i.e., one relying on a sponsor&#x27;s signature), The Compact verifies the sponsor&#x27;s authorization in the following order:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Caller is Sponsor:</strong> If <code class="vocs_Code">msg.sender == sponsor</code>, authorization is granted.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">ECDSA Signature:</strong> Attempt standard ECDSA signature verification.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">EIP-1271 <code class="vocs_Code">isValidSignature</code>:</strong> If ECDSA fails, call <code class="vocs_Code">isValidSignature</code> on the sponsor&#x27;s address (if it&#x27;s a contract) with half the remaining gas.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Emissary <code class="vocs_Code">verifyClaim</code>:</strong> If EIP-1271 fails or isn&#x27;t applicable, and an emissary is assigned for the sponsor and <code class="vocs_Code">lockTag</code>, call the emissary&#x27;s <code class="vocs_Code">verifyClaim</code> function.</li>
</ol>
<p class="vocs_Paragraph">Sponsors cannot unilaterally cancel a signed compact; only allocators can effectively do so by consuming the nonce. This is vital to upholding the equivocation guarantees for claimants.</p>
<h2 class="vocs_H2 vocs_Heading"><div id="trust-assumptions" class="vocs_Heading_slugTarget"></div>Trust Assumptions<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#trust-assumptions" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">The Compact protocol operates under a specific trust model where different actors have varying levels of trust requirements:</p>
<strong class="vocs_Strong">Sponsor Trust Requirements:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Allocators</strong>: Sponsors must trust that allocators will not unduly censor valid requests against fully funded locks. However, sponsors retain the ability to initiate forced withdrawals if allocators become unresponsive.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Arbiters</strong>: Sponsors must trust that arbiters will not process claims where the specified conditions were not met. Arbiters have significant power in determining claim validity.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Emissaries</strong>: Sponsors must trust that emissaries (if assigned) will not authorize claims maliciously, as emissaries can act as fallback signers when other verification methods fail. Emissaries effectively have the same authorization power as the sponsor for claim verification.</li>
</ul>
<strong class="vocs_Strong">Claimant Trust Requirements:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Allocators</strong>: Claimants must trust that allocators are sound and will not allow resource locks to become underfunded through double-spending or other allocation failures.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Arbiters</strong>: Claimants must trust that arbiters will not fail to process claims where conditions were properly met.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Emissaries</strong>: Claimants must trust that emissaries (if assigned) will faithfully authorize valid claims if the sponsor is able to equivocate, or update their account to revoke their authorization on a previously authorized compact (as is the case with EIP-7702 sponsors and many smart contracts implementing EIP-1271). Therefore, claimants should require the use of one of a small set of known, &quot;canonical&quot; emissaries that enforce delays before allowing key rotation.</li>
</ul>
<h2 class="vocs_H2 vocs_Heading"><div id="key-events" class="vocs_Heading_slugTarget"></div>Key Events<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#key-events" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">The Compact emits several events to signal important state changes:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">Claim(address indexed sponsor, address indexed allocator, address indexed arbiter, bytes32 claimHash, uint256 nonce)</code>: Emitted when a claim is successfully processed via <code class="vocs_Code">ITheCompactClaims</code> functions.</li>
<li class="vocs_ListItem"><code class="vocs_Code">NonceConsumedDirectly(address indexed allocator, uint256 nonce)</code>: Emitted when an allocator directly consumes a nonce via <code class="vocs_Code">consume</code>.</li>
<li class="vocs_ListItem"><code class="vocs_Code">ForcedWithdrawalStatusUpdated(address indexed account, uint256 indexed id, bool activating, uint256 withdrawableAt)</code>: Emitted when <code class="vocs_Code">enableForcedWithdrawal</code> or <code class="vocs_Code">disableForcedWithdrawal</code> is called.</li>
<li class="vocs_ListItem"><code class="vocs_Code">CompactRegistered(address indexed sponsor, bytes32 claimHash, bytes32 typehash)</code>: Emitted when a compact is registered via <code class="vocs_Code">register</code>, <code class="vocs_Code">registerMultiple</code>, or combined deposit-and-register functions.</li>
<li class="vocs_ListItem"><code class="vocs_Code">AllocatorRegistered(uint96 allocatorId, address allocator)</code>: Emitted when a new allocator is registered via <code class="vocs_Code">__registerAllocator</code>.</li>
<li class="vocs_ListItem"><code class="vocs_Code">EmissaryAssigned(address indexed sponsor, bytes12 indexed lockTag, address emissary)</code>: Emitted when a sponsor assigns or changes an emissary via <code class="vocs_Code">assignEmissary</code>.</li>
</ul>
<p class="vocs_Paragraph">Standard <code class="vocs_Code">ERC6909.Transfer</code> events are also emitted for mints, burns, and transfers of resource lock tokens.</p>
<h2 class="vocs_H2 vocs_Heading"><div id="key-data-structures" class="vocs_Heading_slugTarget"></div>Key Data Structures<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/resources#key-data-structures" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">Many functions in The Compact use custom structs for their calldata. Here are some of the most important ones:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<strong class="vocs_Strong">For Claims (passed to <code class="vocs_Code">ITheCompactClaims</code> functions):</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">Claim</code>: For claims involving a single resource lock on a single chain.<!-- -->
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Defined in src/types/Claims.sol</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Claim</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> allocatorData;</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> sponsorSignature;</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> sponsor;</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> nonce;</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> expires;</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> witness;</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> witnessTypestring;</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> id;</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> allocatedAmount;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    Component[] claimants;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">BatchClaim</code>: For multiple resource locks on a single chain.</li>
<li class="vocs_ListItem"><code class="vocs_Code">MultichainClaim</code>: For single resource lock claims on the notarized (i.e., origin) chain of a multichain compact.</li>
<li class="vocs_ListItem"><code class="vocs_Code">ExogenousMultichainClaim</code>: For single resource lock claims on an exogenous chain (i.e., any chain <em>other than</em> the notarized chain).</li>
<li class="vocs_ListItem"><code class="vocs_Code">BatchMultichainClaim</code>: For multiple resource locks on the notarized chain.</li>
<li class="vocs_ListItem"><code class="vocs_Code">ExogenousBatchMultichainClaim</code>: For multiple resource locks on an exogenous chain.</li>
<li class="vocs_ListItem"><code class="vocs_Code">BatchClaimComponent</code>: Used within batch claim structs.<!-- -->
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Defined in src/types/Components.sol</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> BatchClaimComponent</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> id;</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> allocatedAmount;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    Component[] portions;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
</li>
</ul>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">For Allocated Transfers (passed to <code class="vocs_Code">ITheCompact.allocatedTransfer</code> etc.):</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">AllocatedTransfer</code>: For transferring a single ID to multiple recipients with allocator approval.<!-- -->
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Defined in src/types/Claims.sol</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> AllocatedTransfer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    bytes</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> allocatorData;</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> nonce;</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> expires;</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    uint256</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> id;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    Component[] recipients;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
</li>
<li class="vocs_ListItem"><code class="vocs_Code">AllocatedBatchTransfer</code>: For transferring multiple IDs.</li>
</ul>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">For Deposits (used with Permit2):</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">DepositDetails</code>: Helper for batch Permit2 deposits.</li>
</ul>
</li>
</ul></article><footer class="vocs_Footer" data-layout="docs"><div class="vocs_Footer_container"></div></footer></div><div data-bottom-observer="true"></div></div></div>
  </body>
</html>
