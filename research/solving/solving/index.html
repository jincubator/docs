<!doctype html>
<html lang="en" data-vocs>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="/initializeTheme.iife.js"></script>&lt;script src=&quot;/zoom-mermaid.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;<link rel="preload" as="image" href="/images/jincubator.png"/><title>Solving, Arbitrage &amp; Market Making ‚Äì Jincubator</title><link rel="icon" href="/images/jincubator.png" type="image/png"/><meta property="og:type" content="website"/><meta property="og:title" content="Solving, Arbitrage &amp; Market Making"/><meta property="og:url" content="/"/><meta property="og:image" content="https://vocs.dev/api/og?logo=//images/jincubator.png&title=Solving, Arbitrage & Market Making&description="/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:image" content="https://vocs.dev/api/og?logo=//images/jincubator.png&title=Solving%2C%20Arbitrage%20%26%20Market%20Making&description=undefined"/>
    <script type="module" crossorigin src="/assets/index-B3aGu-ft.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/style-CgUDpFKq.css">
  </head>
  <body>
    <div id="app"><base href="/"/><div class="vocs_DocsLayout" data-layout="docs"><a class="vocs_SkipLink vocs_utils_visuallyHidden" href="/research/solving/solving#vocs-content">Skip to content</a><div class="vocs_DocsLayout_gutterLeft"><aside class="vocs_Sidebar vocs_DocsLayout_sidebar"><div><div class="vocs_Sidebar_logoWrapper"><div class="vocs_Sidebar_logo"><a style="align-items:center;display:flex;height:100%" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/images/jincubator.png"/></a></div><div class="vocs_Sidebar_divider"></div></div><nav class="vocs_Sidebar_navigation"><div class="vocs_Sidebar_group"><section class="vocs_Sidebar_section"><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/intro" variant="styleless" data-discover="true">Research</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Solving and Arbitrage (2025)</div></div><div class="vocs_Sidebar_items"><a data-active="true" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/solving" variant="styleless" data-discover="true">High Performance Route Evaluation</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/tycho1inchNOL" variant="styleless" data-discover="true">No Liquidity Solving (Tycho 1inch)</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/near" variant="styleless" data-discover="true">Near Contract Development (1inch Contracts)</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/Intents/protocol" variant="styleless" data-discover="true">Liquidity Management with ERC-6909 Vault</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/solving/intent-management-hook" variant="styleless" data-discover="true">Uniswap V4 - Intent Management Hook</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader" role="button" tabindex="0"><div class="vocs_Sidebar_sectionTitle">Layer 1 Platforms (2022/2023)</div><div role="button" tabindex="0"><div aria-label="toggle section" class="vocs_Icon vocs_Sidebar_sectionCollapse" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Right</title><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/intro" variant="styleless" data-discover="true">Layer 1 Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/avalanche" variant="styleless" data-discover="true">Avalanche</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/binance" variant="styleless" data-discover="true">Binance Smart Chain</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/cosmos" variant="styleless" data-discover="true">Cosmos</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/ethereum-1-0" variant="styleless" data-discover="true">Ethereum 1.0</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/ethereum" variant="styleless" data-discover="true">Ethereum</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/NEAR" variant="styleless" data-discover="true">NEAR</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/harmony" variant="styleless" data-discover="true">Harmony</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/polkadot" variant="styleless" data-discover="true">Polkadot</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/chains/polygon" variant="styleless" data-discover="true">Polygon</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Code Reviews (2022/2023)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/intro" variant="styleless" data-discover="true">Code Review Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/horizon" variant="styleless" data-discover="true">Horizon Bridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/ethereum-near" variant="styleless" data-discover="true">Ethereum Near Bridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/code/ethereum" variant="styleless" data-discover="true">Ethereum</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Cross Chain Bridges (2022/2023)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/intro" variant="styleless" data-discover="true">Bridging Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/cosmos-ibc" variant="styleless" data-discover="true">Cosmos IBC</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/harmony-horizon" variant="styleless" data-discover="true">Harmony Horizon</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/isomorph" variant="styleless" data-discover="true">Isomorph</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/near-rainbow" variant="styleless" data-discover="true">Near Rainbow Bridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/polymerlabs" variant="styleless" data-discover="true">Polymer Labs</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/snowbridge" variant="styleless" data-discover="true">Snowbridge</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/bridge/succinct" variant="styleless" data-discover="true">Succint</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Zero Knowledge (2022/2023)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/intro" variant="styleless" data-discover="true">Zero Knowledge Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/zkpos" variant="styleless" data-discover="true">ZK Proof of Stake</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/zksnarks" variant="styleless" data-discover="true">zk-Snarks</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/zk/axiom" variant="styleless" data-discover="true">Axiom</a></div></section><section class="vocs_Sidebar_section vocs_Sidebar_level"><div class="vocs_Sidebar_sectionHeader"><div class="vocs_Sidebar_sectionTitle">Primitives (2022/2023)</div></div><div class="vocs_Sidebar_items"><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/intro" variant="styleless" data-discover="true">Primitives Intro</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/fraud-proofs" variant="styleless" data-discover="true">Fraud Proofs</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/light-clients" variant="styleless" data-discover="true">Light Clients</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/primitives" variant="styleless" data-discover="true">Cryptogaphic Primitives</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/weak-subjectivity" variant="styleless" data-discover="true">Weak Subjectivity</a><a data-active="false" class="vocs_Sidebar_item vocs_Link vocs_Link_styleless" href="/research/primitives/signatures" variant="styleless" data-discover="true">Signature Schemes</a></div></section></div></nav></div><div class="vocs_Sidebar_footer"><div class="vocs_Sidebar_footerCurtain"></div><div class="vocs_Sidebar_footerContent"><div class="vocs_Socials"><a class="vocs_Socials_button" href="https://github.com/jincubator" target="_blank" rel="noopener noreferrer"><div aria-label="GitHub" class="vocs_Icon vocs_Socials_icon" role="img" style="--vocs_Icon_size:17px"><svg width="100%" height="100%" viewBox="0 0 98 96" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z" fill="currentColor"></path></svg></div></a><div style="width:1px;margin-top:var(--vocs-space_4);margin-bottom:var(--vocs-space_4);background-color:var(--vocs-color_border)"></div><a class="vocs_Socials_button" href="https://twitter.com/jincubatorX" target="_blank" rel="noopener noreferrer"><div aria-label="X (Twitter)" class="vocs_Icon vocs_Socials_icon" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg"><title>X</title><path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="currentColor"></path></svg></div></a><div style="width:1px;margin-top:var(--vocs-space_4);margin-bottom:var(--vocs-space_4);background-color:var(--vocs-color_border)"></div><a class="vocs_Socials_button" href="https://t.me/jincubator" target="_blank" rel="noopener noreferrer"><div aria-label="Telegram" class="vocs_Icon vocs_Socials_icon" role="img" style="--vocs_Icon_size:17px"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 50 50"><title>Telegram</title><path d="M25 2c12.703 0 23 10.297 23 23S37.703 48 25 48 2 37.703 2 25 12.297 2 25 2zm7.934 32.375c.423-1.298 2.405-14.234 2.65-16.783.074-.772-.17-1.285-.648-1.514-.578-.278-1.434-.139-2.427.219-1.362.491-18.774 7.884-19.78 8.312-.954.405-1.856.847-1.856 1.487 0 .45.267.703 1.003.966.766.273 2.695.858 3.834 1.172 1.097.303 2.346.04 3.046-.395.742-.461 9.305-6.191 9.92-6.693.614-.502 1.104.141.602.644-.502.502-6.38 6.207-7.155 6.997-.941.959-.273 1.953.358 2.351.721.454 5.906 3.932 6.687 4.49.781.558 1.573.811 2.298.811.725 0 1.107-.955 1.468-2.064z" fill="currentColor"></path></svg></div></a></div></div></div></aside></div><div class="vocs_DocsLayout_gutterTop vocs_DocsLayout_gutterTop_offsetLeftGutter"><div class="vocs_DesktopTopNav"><button class="vocs_DesktopSearch_search" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-¬´Rlj¬ª" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-top:2px"><path d="M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg>Search...<div class="vocs_DesktopSearch_searchCommand"><div style="background:currentColor;transform:rotate(45deg);width:1.5px;border-radius:2px;height:100%"></div></div></button><div class="vocs_DesktopTopNav_logoWrapper"><div class="vocs_DesktopTopNav_logo"><a style="align-items:center;display:flex;height:56px;margin-top:4px" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/images/jincubator.png"/></a></div></div><div class="vocs_DesktopTopNav_section"></div><div class="vocs_DesktopTopNav_section"><div class="vocs_DesktopTopNav_group"><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="vocs_NavigationMenu"><div style="position:relative"><ul data-orientation="horizontal" class="vocs_NavigationMenu_list" dir="ltr"><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/research/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Research</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/proposals/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Proposals</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/product/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Product</a><a data-active="false" class="vocs_DesktopTopNav_item vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/partnerships/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Partnerships</a></ul></div></nav></div></div></div><div class="vocs_MobileTopNav"><div class="vocs_MobileTopNav_section"><div class="vocs_MobileTopNav_group"><div class="vocs_MobileTopNav_logo"><a style="align-items:center;display:flex;height:100%" href="/" data-discover="true"><img alt="Logo" class="vocs_NavLogo_logoImage vocs_Logo" src="/images/jincubator.png"/></a></div></div><div class="vocs_MobileTopNav_group"><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="vocs_MobileTopNav_navigation vocs_NavigationMenu"><div style="position:relative"><ul data-orientation="horizontal" class="vocs_NavigationMenu_list" dir="ltr"><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/research/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Research</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/proposals/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Proposals</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/product/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Product</a><a data-active="false" class="vocs_NavigationMenu_link vocs_Link vocs_Link_styleless" href="/partnerships/intro" variant="styleless" data-radix-collection-item="" data-discover="true">Partnerships</a></ul></div></nav><div class="vocs_MobileTopNav_navigation vocs_MobileTopNav_navigation_compact"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-¬´Rkpj¬ª" data-state="closed" class="vocs_MobileTopNav_menuTrigger vocs_MobileTopNav_navigationItem">Menu<div aria-label="Menu" class="vocs_Icon" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Down</title><path d="M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="vocs_MobileTopNav_section"><div class="vocs_MobileTopNav_group" style="margin-right:-8px"><button class="vocs_MobileSearch_searchButton" type="button" aria-label="Search" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-¬´R19j¬ª" data-state="closed"><svg width="21" height="21" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div></div></div></div><div class="vocs_DocsLayout_gutterTopCurtain vocs_DocsLayout_gutterTopCurtain_withSidebar"><div class="vocs_DesktopTopNav_curtain"></div><div class="vocs_MobileTopNav_curtain"><div class="vocs_MobileTopNav_curtainGroup"><div class="vocs_MobileTopNav_curtainItem"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-¬´Rqj¬ª" data-state="closed" class="vocs_MobileTopNav_menuTrigger"><div aria-label="Menu" class="vocs_Icon" role="img" style="--vocs_Icon_size:13px"><svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 79 48" fill="none"><title>Menu</title><path fill="currentColor" d="M19.528 47.232h40.87c1.952 0 3.515-1.562 3.515-3.564a3.5 3.5 0 0 0-3.516-3.516H19.528a3.501 3.501 0 0 0-3.515 3.516c0 2.002 1.562 3.564 3.515 3.564ZM12.057 27.262h55.81a3.501 3.501 0 0 0 3.516-3.516 3.501 3.501 0 0 0-3.515-3.515h-55.81a3.501 3.501 0 0 0-3.516 3.515 3.501 3.501 0 0 0 3.515 3.516ZM4.391 7.34H75.29c2.002 0 3.515-1.563 3.515-3.516 0-2.002-1.513-3.564-3.515-3.564H4.39C2.438.26.876 1.822.876 3.824A3.501 3.501 0 0 0 4.39 7.34Z"></path></svg></div><div class="vocs_MobileTopNav_menuTitle">High Performance Route Evaluation</div></button></div></div><div class="vocs_MobileTopNav_curtainGroup"><div class="vocs_MobileTopNav_curtainItem"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-¬´R5aj¬ª" data-state="closed" class="vocs_MobileTopNav_outlineTrigger">On this page<div aria-label="On this page" class="vocs_Icon" role="img" style="--vocs_Icon_size:16px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Chevron Right</title><path d="M6.1584 3.13508C6.35985 2.94621 6.67627 2.95642 6.86514 3.15788L10.6151 7.15788C10.7954 7.3502 10.7954 7.64949 10.6151 7.84182L6.86514 11.8418C6.67627 12.0433 6.35985 12.0535 6.1584 11.8646C5.95694 11.6757 5.94673 11.3593 6.1356 11.1579L9.565 7.49985L6.1356 3.84182C5.94673 3.64036 5.95694 3.32394 6.1584 3.13508Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button></div></div></div></div><div class="vocs_DocsLayout_gutterRight vocs_DocsLayout_gutterRight_withSidebar"></div><div id="vocs-content" class="vocs_DocsLayout_content vocs_DocsLayout_content_withSidebar vocs_DocsLayout_content_withTopNav"><article class="vocs_Content"><header class="vocs_Header"><h1 class="vocs_H1 vocs_Heading"><div id="solving-arbitrage--market-making" class="vocs_Heading_slugTarget"></div>Solving, Arbitrage &amp; Market Making<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#solving-arbitrage--market-making" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h1></header>
<script>
    // Load zoom script
    if (!document.querySelector('script[src="/zoom-mermaid.js"]')) {
      const script = document.createElement('script');
      script.src = '/zoom-mermaid.js';
      script.defer = true;
      document.head.appendChild(script);
    }
  </script>
<h2 class="vocs_H2 vocs_Heading"><div id="evaluating-over-1000-routes-per-second-and-arbitraging-them-with-no-upfront-capital" class="vocs_Heading_slugTarget"></div>Evaluating over 1000 Routes Per Second and arbitraging them with no upfront capital.<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#evaluating-over-1000-routes-per-second-and-arbitraging-them-with-no-upfront-capital" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">In this article I discuss my personal Journey for 2025. Give an example of a cyclical arbitrage built on the latest high performant solving and market making infrastructure. Discuss how this infrastructure can be applied to Intent Based Solving Sytems (think UniswapX, CowSwap, 1inch) and give a full breakdown of the mathematics and technical implementation of a generic solving infrastructure service that I have been developing.</p>
<p class="vocs_Paragraph">If you are an <strong class="vocs_Strong">investor</strong>, <strong class="vocs_Strong">protocol</strong>, or <strong class="vocs_Strong">market maker</strong>, let‚Äôs connect to:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Investors</strong>: Please help with introductions to portfolio companies and liquidity providers in the space. Also reach out if this technology can be utilized in startups you are currently evaluating.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Protocols</strong>: Please reach out if this technology (or I personally) can help you drive more order flow to your protocol.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Market Makers (and liquidity providers)</strong> please reach out if you want to develop advanced trading strategies and liquicity management functionality using this infrastructure.</li>
</ul>
<p class="vocs_Paragraph">This reserach is also availabe on <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://hackmd.io/@jincubator/arbitrage" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">hackmd.io</a></p>
<blockquote class="vocs_Blockquote">
<p class="vocs_Paragraph"><strong class="vocs_Strong">Disclaimer:</strong> This blog post covers an overview of a high performant solving, arbitrage and market making infrastructure. The example of a cyclical arbitrage is a simple one but useful for demonstration purposes. I really wanted to show the foundation for how to build and think about the foundational layers of collectors, strategies and execution. The codebase is private and at the time of writing has already been enhanced, but the concepts remain solid.</p>
</blockquote>
<hr class="vocs_HorizontalRule"/>
<h2 class="vocs_H2 vocs_Heading"><div id="2025--a-year-of-research-and-growth" class="vocs_Heading_slugTarget"></div>2025 ‚Äì A Year of Research and Growth<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#2025--a-year-of-research-and-growth" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="personal-journey" class="vocs_Heading_slugTarget"></div>Personal Journey<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#personal-journey" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">This year I decided to spend my time coming up to speed on the latest innovations and technologies in crypto. My focus area is real-time market making and solving for intent-based protocols such as UniswapX, 1inch, and Cowswap. I‚Äôve explored breakthroughs in real-time indexing, simulation, and execution pioneered by Tycho.</p>
<p class="vocs_Paragraph">This journey included:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Attending the <strong class="vocs_Strong"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://atrium.academy/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Atrium Uniswap V4 Hook Academy</a></strong></li>
<li class="vocs_ListItem">Hacking on <strong class="vocs_Strong">1inch Limit Order Protocol</strong> <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://hackmd.io/@jincubator/1nchTychoNoLiquiditySwap" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">article here</a></li>
<li class="vocs_ListItem">Prototyping <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.uniswap.org/contracts/uniswapx/overviews" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">UniswapX</a> Fillers and <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.cow.fi/cow-protocol/tutorials/solvers" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">CowSwap</a> Solvers</li>
<li class="vocs_ListItem">Researching cross-chain intents and advanced resource locking using the <strong class="vocs_Strong"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.uniswap.org/contracts/the-compact/overview" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">the-compact</a></strong> (an ERC6909 vault with a robust ecosystem of sponsors, allocators, fillers, arbiters, and relayers)</li>
</ul>
<p class="vocs_Paragraph">I continually refined my understanding of high-performance solving and market-making using <strong class="vocs_Strong"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://alloy.rs/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Alloy</a></strong>, <strong class="vocs_Strong">Rust</strong>, and <strong class="vocs_Strong"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.propellerheads.xyz/tycho/overview" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Tycho‚Äôs architecture</a></strong>, which leverages <strong class="vocs_Strong"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://substreams.dev/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">substreams</a></strong>, advanced <strong class="vocs_Strong">router</strong>, <strong class="vocs_Strong">dispatcher</strong>, and <strong class="vocs_Strong">executor technologies</strong>. These abstractions allow seamless interaction with protocols such as Uniswap, Balancer, SushiSwap, and more.</p>
<p class="vocs_Paragraph">There&#x27;s no better way to come up to speed with the technology used in high performance, market making, solving and arbitrage then to build it. So this is what I set out to do and start with a simple goal.</p>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Goal:</strong> Build an arbitrage bot capable of generating profit with <strong class="vocs_Strong">no upfront capital</strong>.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="result" class="vocs_Heading_slugTarget"></div>Result<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#result" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Below are the details of the first positive (albeit for dust) cyclical arbitrage execeuted on Base <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://basescan.org/tx/0xde470c186d89aa02e6be2c066b99e7f4e39faebbca9ded80be766f64e28eacfa" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">View on BaseScan</a>.</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">üåê</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> BASE</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">  2025-09-13</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> 09:51:39</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">üí∞</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> Profitable</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> route</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> found:</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0x452c93c6f3cc3a10e11571e96bc7c88de3a33ea91a3c28a0d703a04b3bcd309c</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> with</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> profit:</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 959</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (0.1568333333333405%)</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">üèÜ</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> Route:</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> Profit</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0.000941</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> USDC</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (0.156833%) Input Amount: 0.6 [USDC -</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> WETH -</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> MOJO -</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> USDC]</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">üîÑ</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> Route:</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> [USDC -</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> WETH</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> -</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> MOJO</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> -</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> USDC]</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> Route</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> ID:</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0x452c93c6f3cc3a10e11571e96bc7c88de3a33ea91a3c28a0d703a04b3bcd309c</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">‚öôÔ∏è</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> Protocols:</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> [uniswap_v3 -</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> uniswap_v2</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> -</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> uniswap_v2]</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">‚õìÔ∏è</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> Tokens:</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> 0x833589fcd6edb6e08f4c7c32d4f71b54bda02913:0x4200000000000000000000000000000000000006:0x6dba065721435cfca05caa508f3316b637861373:0x833589fcd6edb6e08f4c7c32d4f71b54bda02913</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ü™ô</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> Start</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> token:</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> USDC</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0x833589fcd6edb6e08f4c7c32d4f71b54bda02913</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> decimals:6</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">üíé</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> Input</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> amounts:</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0.600000</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> -</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0.000129</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> -</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 30728417.014588</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">‚≠ê</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> Eval</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> Raw</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> amounts:</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 600000</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> -</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 129458828870424</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> -</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 30728417014587798013457008</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> =</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 600959</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">üîÅ</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> Pools:</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0xd0b53d9277642d899df5c87a3966a349a798f224</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> :</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0x7ef7a6e5b577a1c630e42291c25bca791d402493</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> :</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0xfc49208c1222c8037d4be05890b841ad25ceec60</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">üîÅ</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> Flash</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> pool:</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> pool:0x021235b92a4f52c789f43a1b01453c237c265861</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> token:</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> 2c8c89c442436cc6c0a77943e09c8daf49da3161</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> borrowToken0:</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">false</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span"> fee:0.01%</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="some-statistics" class="vocs_Heading_slugTarget"></div>Some Statistics<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#some-statistics" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<h4 class="vocs_H4 vocs_Heading"><div id="performance-statistics" class="vocs_Heading_slugTarget"></div>Performance Statistics<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#performance-statistics" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">Below show route evaluation (and execution) capabilities of over 1000 routes per second, run on small relatively slow mini pc. This is a summary of several runs executed on mulitple chains over a total of 51 and a half minutes.</p>
<table class="vocs_Table"><thead><tr class="vocs_TableRow"><th class="vocs_TableHeader">üìä Statistic</th><th class="vocs_TableHeader">Value</th></tr></thead><tbody><tr class="vocs_TableRow"><td class="vocs_TableCell">Total Routes Evaluated</td><td class="vocs_TableCell">182,746</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Peak Routes/sec</td><td class="vocs_TableCell">1,146</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Current Routes/sec (last run)</td><td class="vocs_TableCell">1,069</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Average Route Eval Time (¬µs)</td><td class="vocs_TableCell">424</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">DB Throughput (ops/sec)</td><td class="vocs_TableCell">0</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Memory Usage (MB)</td><td class="vocs_TableCell">657</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Batch Size (last run)</td><td class="vocs_TableCell">1</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Execution Success Rate (%)</td><td class="vocs_TableCell">100</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Metrics Capture Duration (s)</td><td class="vocs_TableCell">3,090</td></tr></tbody></table>
<h4 class="vocs_H4 vocs_Heading"><div id="chain-stats" class="vocs_Heading_slugTarget"></div>Chain Stats<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#chain-stats" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">Following are the chains we used for our evaluation, testing multiple chains, hop sizes and protocols to give a well balanced analysis.</p>
<table class="vocs_Table"><thead><tr class="vocs_TableRow"><th class="vocs_TableHeader">üìä Statistic</th><th class="vocs_TableHeader">Base</th><th class="vocs_TableHeader">Ethereum</th><th class="vocs_TableHeader">Unichain</th></tr></thead><tbody><tr class="vocs_TableRow"><td class="vocs_TableCell">Routes Total</td><td class="vocs_TableCell">85,986</td><td class="vocs_TableCell">33,226</td><td class="vocs_TableCell">24,600</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Graph Edges (Pools)</td><td class="vocs_TableCell">5,338</td><td class="vocs_TableCell">4,276</td><td class="vocs_TableCell">114</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Graph Nodes (Tokens)</td><td class="vocs_TableCell">2,477</td><td class="vocs_TableCell">1,593</td><td class="vocs_TableCell">33</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Total Tokens</td><td class="vocs_TableCell">26,061</td><td class="vocs_TableCell">11,824</td><td class="vocs_TableCell">15,300</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">TVL</td><td class="vocs_TableCell">1</td><td class="vocs_TableCell">50</td><td class="vocs_TableCell">1</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Hops</td><td class="vocs_TableCell">4</td><td class="vocs_TableCell">3</td><td class="vocs_TableCell">5</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Protocols</td><td class="vocs_TableCell">2</td><td class="vocs_TableCell">7</td><td class="vocs_TableCell">3</td></tr></tbody></table>
<blockquote class="vocs_Blockquote">
<p class="vocs_Paragraph">Note run on Sep 26th 2025
<strong class="vocs_Strong">Routes</strong>: Represent how many cyclical routes we created (e.g. A -&gt; B -&gt; C -&gt; A)
<strong class="vocs_Strong">Graph Edges (Pools)</strong> the number of pools we are selecting based on TVL and protocol filtering
<strong class="vocs_Strong">Graph Nodes (Tokens)</strong> the number of tokens associated with the selected pools
<strong class="vocs_Strong">TVL</strong> is in ETH and indicates the minimum TVL for the pools we selected
<strong class="vocs_Strong">Hops</strong> how many hops in the route we create, currently we support 2 to 5 hop routes. For prototyping we used different hops for experimentation all chains support up to 5 hops.
<strong class="vocs_Strong">Protocols</strong> the number of protocols we extracted see <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.propellerheads.xyz/tycho/for-solvers/supported-protocols" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Tycho Supported Protocols</a></p>
</blockquote>
<blockquote class="vocs_Blockquote">
<p class="vocs_Paragraph">Note this was run on a Small Computer Linux, AMD Ryzen 7 5700u (8C/16T,up to 4.3 GHz), Mini PC Gamer 64GB DDR4 RAM 2TB PCIe SSD, Mini Desktop Supports 4K@60Hz/Triple Display/WiFi/BT5.0/HDMI+DP+Type C/Home/Office</p>
</blockquote>
<h2 class="vocs_H2 vocs_Heading"><div id="an-overview-of-intent-based-protocols-and-solving" class="vocs_Heading_slugTarget"></div>An Overview of Intent-Based Protocols and Solving<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#an-overview-of-intent-based-protocols-and-solving" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="resource-management-and-capital-efficient-liquidity" class="vocs_Heading_slugTarget"></div>Resource Management and Capital-Efficient Liquidity<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#resource-management-and-capital-efficient-liquidity" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The key to building a high-performance system lies in efficient resource allocation. Pools themselves can act as liquidity sources, and flash-loans allow trades to execute <strong class="vocs_Strong">capital-efficient arbitrage</strong> without requiring upfront capital. With the advances in DeFi protocols such as <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.uniswap.org/contracts/v4/overview" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Uniswap 4</a> with <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.uniswap.org/contracts/v4/quickstart/hooks/setup" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">hook capabilities</a> this allowed me to build custom execution logic on top of large liquidity reserves giving endless opportunities.</p>
<p class="vocs_Paragraph">I started out with a goal of building an intent based hook, which would record the intent (e.g. swap 1 ETH for 4500 USDC) and create an intent which I could solve, if I could solve that intent giving the swapper a better return, than I could keep the profit. For example if the pool offered a swap of 1 ETH for 4500 USDC, but I had a better route that could swap 1 ETH for 4600 USDC, I could solve the intent giving the swapper, say, 4550 USDC take the ETH and then perform the swap netting 50 USDC profit. Whilst this was an interesting idea, I soon came to realize that with V4&#x27;s pool manager settlement functionality, it was better to build the intent outside the protocol (at the router level) rather than as a hook. Or better still build a hook which integrates with an Executor such Tycho with perhaps some Flash Loan functionality, more to come on this.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="streaming-simulation-and-execution" class="vocs_Heading_slugTarget"></div>Streaming, Simulation, and Execution<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#streaming-simulation-and-execution" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The architecture follows the principle: <strong class="vocs_Strong">Collectors ‚Üí Strategies ‚Üí Execution</strong></p>
<h4 class="vocs_H4 vocs_Heading"><div id="collectors-continuously-stream-on-chain-data" class="vocs_Heading_slugTarget"></div>Collectors: Continuously stream on-chain data<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#collectors-continuously-stream-on-chain-data" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The bedrock of the collection architecture is the <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.propellerheads.xyz/tycho/for-solvers/indexer" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Tycho Indexer</a> built on <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.substreams.dev/" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">substreams</a>. It provides real time state updates for multiple protocols filtered by TVL values for those protocols.</p>
<p class="vocs_Paragraph">On top of this we build a graph manager and a route manager using Depth First Search of the graph to create the routes with a little flash_loan_manager to determine the optimal flash loan available. This includes choosing the flash loan with the lowest fee which does not have any locking conflicts with the route.</p>
<p class="vocs_Paragraph">The key point for collection, once again enabled by Tycho streaming technology, is that on a state change to any of the protocols which I am monitoring. I trigger route evaluations for all routes that contain that pool. Evaluating whether a positive arbitrage cycle exists or not. I must admit its tireless work for the route evaluate and its queue manager, evaluating hundreds or even thousands of routes per block, but occasionally, just occasionally an opportunity will be found, which makes it all worthwhile.</p>
<h4 class="vocs_H4 vocs_Heading"><div id="strategies-analyze-and-simulate-opportunities" class="vocs_Heading_slugTarget"></div>Strategies: Analyze and simulate opportunities<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#strategies-analyze-and-simulate-opportunities" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The first (and only thus far) strategy implemented thus far is a cyclical arbitrage. Starting and ending with the same token traversing throough routes we simulate each input and output amount for the route and evaluate if a positve aribtrage exists. If so a Solution for the route with an input amount is Signalled. This will be received by the execution layer.</p>
<p class="vocs_Paragraph">Below is the profitability calculation</p>
<h4 class="vocs_H4 vocs_Heading"><div id="execution-executing-the-transactions" class="vocs_Heading_slugTarget"></div>Execution: Executing the transactions<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#execution-executing-the-transactions" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The exeuction layer receives a Solution including input amount and the route to execute. It performs additional aumentation and encoding.</p>
<p class="vocs_Paragraph">For example in the reference cylical aribtrage the executor maps both the flash loan parameters and swap parameters. It encodes the solution and using alloy binding for flashExecutor creates the calldata for the transaction.</p>
<p class="vocs_Paragraph">The executor itself has pre-flight validation which will capture any identified routes which may no longer be profitabile or error because of other upstream analysis issues. This saves wasting gas on transactions that will revert.</p>
<h2 class="vocs_H2 vocs_Heading"><div id="profitability-calculation" class="vocs_Heading_slugTarget"></div>Profitability Calculation<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#profitability-calculation" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">Let <code class="vocs_Code">A0</code> be amount_in (start token), <code class="vocs_Code">Ak</code> be amount_out (end token), <code class="vocs_Code">fee_hundredths_bip</code> the flash fee in 1e-6 units.</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">swap_profit_percentage = ((Ak ‚àí A0) / A0) √ó 100</li>
<li class="vocs_ListItem">flash_fee_pct = fee_hundredths_bip / 10_000 (as percent)</li>
<li class="vocs_ListItem">net_profit_percentage = swap_profit_percentage ‚àí flash_fee_pct</li>
<li class="vocs_ListItem">net_profit_token = Ak ‚àí A0 ‚àí floor(A0 √ó fee_hundredths_bip / 1_000_000)</li>
</ul>
<p class="vocs_Paragraph">Threshold gating uses <code class="vocs_Code">net_profit_percentage &gt;= profit_threshold</code> (default 0.0%).</p>
<p class="vocs_Paragraph">At this time we then need to optimize the input amount for the route.
This is done using a binary doubling and halving algorithm until the optimal amount is found.</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Execution</strong>: Optimistically execute profitable paths</li>
</ul>
<hr class="vocs_HorizontalRule"/>
<h2 class="vocs_H2 vocs_Heading"><div id="building-a-liquidity-mapping-layer" class="vocs_Heading_slugTarget"></div>Building a Liquidity Mapping Layer<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#building-a-liquidity-mapping-layer" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<p class="vocs_Paragraph">Conceptually this was farly straight forward, create a graph with Tokens as Nodes, Pools as edges and then create routes for that graph. With the protocol abstraction offered by tycho&#x27;s component and state model. A pool is a pool is a pool regardles of what the underlying protocol is. This simplified the implementation considerably</p>
<hr class="vocs_HorizontalRule"/>
<h2 class="vocs_H2 vocs_Heading"><div id="my-first-strategy-cyclical-arbitrage" class="vocs_Heading_slugTarget"></div>My First Strategy: Cyclical Arbitrage<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#my-first-strategy-cyclical-arbitrage" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="hello-bellman-ford" class="vocs_Heading_slugTarget"></div>(Hello Bellman-Ford)<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#hello-bellman-ford" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Analytical optimization for multi-hop routes</li>
<li class="vocs_ListItem">Supports <strong class="vocs_Strong">2‚Äì5 hop cycles</strong></li>
<li class="vocs_ListItem">Prioritizes <strong class="vocs_Strong">profitability and performance</strong> (~1000 routes/sec)</li>
</ul>
<blockquote class="vocs_Blockquote">
<p class="vocs_Paragraph">An open strategy framework is under development with the Cyclica Arbitrage (CARB) implemented and a TOKEN (token based arbitrage which groups all the routes for the input token and selects the route with the highest profitability) currently being tested in production.</p>
</blockquote>
<hr class="vocs_HorizontalRule"/>
<h2 class="vocs_H2 vocs_Heading"><div id="the-execution-layer--making-it-happen" class="vocs_Heading_slugTarget"></div>The Execution Layer ‚Äì Making It Happen<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#the-execution-layer--making-it-happen" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="some-flash-loan-magic" class="vocs_Heading_slugTarget"></div>Some Flash Loan Magic<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#some-flash-loan-magic" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Borrow liquidity directly from pools for capital-efficient trades</li>
<li class="vocs_ListItem">Near-zero fees, instant execution</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="the-beauty-of-routes-single-and-sequential-swaps" class="vocs_Heading_slugTarget"></div>The Beauty of Routes: Single and Sequential Swaps<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#the-beauty-of-routes-single-and-sequential-swaps" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Atomic Execution</strong>: Trades revert if not profitable</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Optimistic Recursive Execution</strong>: Capture secondary opportunities generated by large trades</li>
</ul>
<hr class="vocs_HorizontalRule"/>
<h3 class="vocs_H3 vocs_Heading"><div id="summary-of-features" class="vocs_Heading_slugTarget"></div>Summary of Features<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#summary-of-features" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Multi-chain, multi-protocol route evaluation</li>
<li class="vocs_ListItem">Multi-hop arbitrage support</li>
<li class="vocs_ListItem">Flash-loan enabled trades</li>
<li class="vocs_ListItem">Persistent storage for faster startup</li>
<li class="vocs_ListItem">Modular queues for streaming, graph, route management, evaluation, and execution</li>
</ul>
<hr class="vocs_HorizontalRule"/>
<h3 class="vocs_H3 vocs_Heading"><div id="key-milestones" class="vocs_Heading_slugTarget"></div>Key Milestones<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#key-milestones" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">First Working Transaction:</strong> <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://basescan.org/tx/0xde470c186d89aa02e6be2c066b99e7f4e39faebbca9ded80be766f64e28eacfa" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">View on BaseScan</a></li>
<li class="vocs_ListItem">Support for <strong class="vocs_Strong">2‚Äì5 hop routes</strong></li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Standalone persistence</strong> for tokens, graphs, and routes</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Multi-protocol support</strong>:<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Ethereum: Uniswap v2/v3/v4, Balancer v2, Curve, Sushiswap v2, Pancakeswap v2/v3, Ekubo v2</li>
<li class="vocs_ListItem">Base: Uniswap v2/v3</li>
<li class="vocs_ListItem">Unichain Uniswap v2/v3/v4</li>
</ul>
</li>
<li class="vocs_ListItem">SingleSwap Support takes advantage of complex routes using Uniswap V4 advanced Execution</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Performance</strong>: ~1000 route evaluations per second</li>
<li class="vocs_ListItem">Prototype <strong class="vocs_Strong">v4 Flash Loans</strong> (near-zero fees)</li>
</ul>
<hr class="vocs_HorizontalRule"/>
<h3 class="vocs_H3 vocs_Heading"><div id="still-to-come" class="vocs_Heading_slugTarget"></div>Still to Come<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#still-to-come" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">At time of writing these features are being evaluated and/or implemented</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Gas manager</li>
<li class="vocs_ListItem">MEV bundling</li>
<li class="vocs_ListItem">Token based evaluation (grouping of all routes for a token to ensure the most profitable arbitrage)</li>
<li class="vocs_ListItem">Additional protocol integrations</li>
<li class="vocs_ListItem">Further performance optimizations</li>
<li class="vocs_ListItem">Uniswap V4 Flash Hook (Access to V4 Liquidity integrated with complex routing and exeuction strategies)</li>
<li class="vocs_ListItem">Liquidity Management (ERC-6909 based liquidity manageer build on <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.uniswap.org/contracts/the-compact/overview" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">the-compact</a> from Uniswap)</li>
</ul>
<hr class="vocs_HorizontalRule"/>
<h2 class="vocs_H2 vocs_Heading"><div id="whats-next--opportunities--integrations" class="vocs_Heading_slugTarget"></div>What‚Äôs Next ‚Äì Opportunities &amp; Integrations<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#whats-next--opportunities--integrations" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="filling-strategies" class="vocs_Heading_slugTarget"></div>Filling Strategies<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#filling-strategies" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Multi protocol solver integrations including</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<strong class="vocs_Strong">UniswapX Solving</strong>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">1inch Limit Order Solver Integration</strong>
</li>
<li class="vocs_ListItem">
<strong class="vocs_Strong">Cowswap Solving</strong>
</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="flash-liquidity" class="vocs_Heading_slugTarget"></div>Flash Liquidity<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#flash-liquidity" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">
<strong class="vocs_Strong">Uniswap / Tycho Limit Order Hook Integration</strong>
</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="protocol-order-flow" class="vocs_Heading_slugTarget"></div>Protocol Order Flow<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#protocol-order-flow" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Adding additional protocols to the simulation and execution framework to drive order flow.</p>
<h3 class="vocs_H3 vocs_Heading"><div id="liquidity-management" class="vocs_Heading_slugTarget"></div>Liquidity Management<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#liquidity-management" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Introducing an advanced liquidity management infrastructure with real time settlement, JIT liqidity provioning and support for advanced trading strategies. (ERC-6909 based liquidity manageer build on <a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://docs.uniswap.org/contracts/the-compact/overview" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">the-compact</a> from Uniswap)</p>
<h3 class="vocs_H3 vocs_Heading"><div id="miscellaneous" class="vocs_Heading_slugTarget"></div>Miscellaneous<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#miscellaneous" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Hosted services for Market Makers and Solvers</li>
<li class="vocs_ListItem">Collaboration and Consulting for Protocols looking to attract more order flow.</li>
<li class="vocs_ListItem">Strategy development for Solving, Market Making and Liquidation Engines.</li>
</ul>
<header class="vocs_Header"><h1 class="vocs_H1 vocs_Heading"><div id="appendices" class="vocs_Heading_slugTarget"></div>Appendices<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#appendices" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h1></header>
<h2 class="vocs_H2 vocs_Heading"><div id="appendix-a-mathematics" class="vocs_Heading_slugTarget"></div>Appendix A: Mathematics<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#appendix-a-mathematics" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="route-manager" class="vocs_Heading_slugTarget"></div>Route Manager<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#route-manager" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The Route Manager enumerates all possible multi-hop routes through the liquidity graph. We use a modified Depth-First Search (DFS) traversal to explore potential sequences of swaps, iterating through multiple nodes while avoiding revisiting tokens in the same route.</p>
<p class="vocs_Paragraph">Mathematically, for a graph <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-0.566ex" xmlns="http://www.w3.org/2000/svg" width="11.03ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 4875.2 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-I-1D43A" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q492 659 471 656T418 643T357 615T294 567T236 496T189 394T158 260Q156 242 156 221Q156 173 170 136T206 79T256 45T308 28T353 24Q407 24 452 47T514 106Q517 114 529 161T541 214Q541 222 528 224T468 227H431Q425 233 425 235T427 254Q431 267 437 273H454Q494 271 594 271Q634 271 659 271T695 272T707 272Q721 272 721 263Q721 261 719 249Q714 230 709 228Q706 227 694 227Q674 227 653 224Q646 221 643 215T629 164Q620 131 614 108Q589 6 586 3Q584 1 581 1Q571 1 553 21T530 52Q530 53 528 52T522 47Q448 -22 322 -22Q201 -22 126 55T50 252Z"></path><path id="MJX-1-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-1-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-1-TEX-I-1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path><path id="MJX-1-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-1-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-1-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D43A" xlink:href="#MJX-1-TEX-I-1D43A"></use></g><g data-mml-node="mo" transform="translate(1063.8,0)"><use data-c="3D" xlink:href="#MJX-1-TEX-N-3D"></use></g><g data-mml-node="mo" transform="translate(2119.6,0)"><use data-c="28" xlink:href="#MJX-1-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(2508.6,0)"><use data-c="1D449" xlink:href="#MJX-1-TEX-I-1D449"></use></g><g data-mml-node="mo" transform="translate(3277.6,0)"><use data-c="2C" xlink:href="#MJX-1-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(3722.2,0)"><use data-c="1D438" xlink:href="#MJX-1-TEX-I-1D438"></use></g><g data-mml-node="mo" transform="translate(4486.2,0)"><use data-c="29" xlink:href="#MJX-1-TEX-N-29"></use></g></g></g></svg></mjx-container> with vertices <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-0.05ex" xmlns="http://www.w3.org/2000/svg" width="1.74ex" height="1.595ex" role="img" focusable="false" viewBox="0 -683 769 705" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-2-TEX-I-1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D449" xlink:href="#MJX-2-TEX-I-1D449"></use></g></g></g></svg></mjx-container> representing tokens and edges <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="1.729ex" height="1.538ex" role="img" focusable="false" viewBox="0 -680 764 680" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-3-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-3-TEX-I-1D438"></use></g></g></g></svg></mjx-container> representing liquidity pools, DFS can be described recursively as:</p>
<p class="vocs_Paragraph">DFS(v) = visit all neighbors of v recursively without revisiting nodes in the current path</p>
<p class="vocs_Paragraph">Our implementation supports two main modes:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Full Graph Rebuild:</strong> Clears all existing graph data and rebuilds from scratch, adding pools in bulk or individually depending on dataset size. V4 eligibility of tokens is processed for all pools.</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Incremental Updates:</strong> Adds new pools to the existing graph without clearing prior data. Optimized for <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-0.566ex" xmlns="http://www.w3.org/2000/svg" width="4.844ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2141 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-4-TEX-I-1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path id="MJX-4-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-4-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-4-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D442" xlink:href="#MJX-4-TEX-I-1D442"></use></g><g data-mml-node="mo" transform="translate(763,0)"><use data-c="28" xlink:href="#MJX-4-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(1152,0)"><use data-c="1D45B" xlink:href="#MJX-4-TEX-I-1D45B"></use></g><g data-mml-node="mo" transform="translate(1752,0)"><use data-c="29" xlink:href="#MJX-4-TEX-N-29"></use></g></g></g></svg></mjx-container> complexity relative to the number of new pools.</li>
</ol>
<p class="vocs_Paragraph">Edges are bidirectional between token pairs:</p>
<mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align:-0.025ex" xmlns="http://www.w3.org/2000/svg" width="6.933ex" height="1.645ex" role="img" focusable="false" viewBox="0 -716 3064.6 727" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5-TEX-I-1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path id="MJX-5-TEX-N-2194" d="M263 479Q267 501 271 506T288 511Q308 511 308 500Q308 493 303 475Q293 438 278 406T246 352T215 315T185 287T165 270H835Q729 349 696 475Q691 493 691 500Q691 511 711 511Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H165Q167 228 182 216T211 189T244 152T277 96T303 25Q308 7 308 0Q308 -11 288 -11Q281 -11 278 -11T272 -7T267 2T263 21Q245 94 195 151T73 236Q58 242 55 247Q55 254 59 257T73 264Q144 292 194 349T263 479Z"></path><path id="MJX-5-TEX-I-1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D434" xlink:href="#MJX-5-TEX-I-1D434"></use></g><g data-mml-node="mo" transform="translate(1027.8,0)"><use data-c="2194" xlink:href="#MJX-5-TEX-N-2194"></use></g><g data-mml-node="mi" transform="translate(2305.6,0)"><use data-c="1D435" xlink:href="#MJX-5-TEX-I-1D435"></use></g></g></g></svg></mjx-container>
<p class="vocs_Paragraph">Each edge stores metadata including the pool identifier, output token, protocol, and fee basis points.</p>
<h4 class="vocs_H4 vocs_Heading"><div id="modified-dfs-traversal" class="vocs_Heading_slugTarget"></div>Modified DFS Traversal<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#modified-dfs-traversal" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">Instead of a simple recursive DFS, the route manager iteratively explores each node while accounting for:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Pool and token blacklists to prevent invalid routes</li>
<li class="vocs_ListItem">Multi-protocol support (Uniswap V2/V3/V4, Sushiswap, Pancakeswap, Ekubo, Balancer, Curve)</li>
<li class="vocs_ListItem">Flash loan constraints to avoid locking conflicts</li>
<li class="vocs_ListItem">Real-time V4 eligibility of tokens</li>
</ul>
<p class="vocs_Paragraph">The traversal maintains a stack of paths, extending each path by iterating over neighbor tokens. If a neighbor has already been visited in the current path, it is skipped to prevent cycles that do not start and end at the same token.</p>
<h4 class="vocs_H4 vocs_Heading"><div id="graph-construction-overview" class="vocs_Heading_slugTarget"></div>Graph Construction Overview<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#graph-construction-overview" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Assign unique identifiers for each pool and token</li>
<li class="vocs_ListItem">Create bidirectional edges connecting the token pair</li>
<li class="vocs_ListItem">Update adjacency structures for fast neighbor lookup</li>
<li class="vocs_ListItem">Persist edges to storage in both compact and legacy formats</li>
</ul>
<h4 class="vocs_H4 vocs_Heading"><div id="dfs-context" class="vocs_Heading_slugTarget"></div>DFS Context<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#dfs-context" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">Depth-first search is an algorithm for traversing or searching tree or graph structures. Starting at a root node (or an arbitrary node in a general graph), DFS explores as far as possible along each branch before backtracking. A stack (explicit or via recursion) tracks the nodes visited along the current branch.</p>
<p class="vocs_Paragraph">In the arbitrage solver, DFS enumerates all candidate routes for evaluation by the Route Evaluator, ensuring that profitable multi-hop cycles are identified while respecting token and pool constraints.</p>
<hr class="vocs_HorizontalRule"/>
<h3 class="vocs_H3 vocs_Heading"><div id="route-evaluator" class="vocs_Heading_slugTarget"></div>Route Evaluator<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#route-evaluator" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The route evaluation process leverages the Bellman‚ÄìFord algorithm to detect negative-weight cycles that correspond to profitable arbitrage opportunities:</p>
<p class="vocs_Paragraph"><code class="vocs_Code">d(v) = min_{(u,v) in E} [ d(u) + w(u,v) ]</code></p>
<p class="vocs_Paragraph">Negative-weight cycles represent opportunities where the sequence of swaps results in a net gain after accounting for fees.</p>
<blockquote class="vocs_Blockquote">
<p class="vocs_Paragraph">Token Evaluation is in progress this groups all the routes for the input token and selects the route with the highest profitability</p>
</blockquote>
<hr class="vocs_HorizontalRule"/>
<h3 class="vocs_H3 vocs_Heading"><div id="optimal-amount-calculator" class="vocs_Heading_slugTarget"></div>Optimal Amount Calculator<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#optimal-amount-calculator" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The function <code class="vocs_Code">find_optimal_input_amount</code> computes the <strong class="vocs_Strong">capital-efficient input amount</strong> for a given arbitrage or swap route to maximize profit.<br/>
<!-- -->Mathematically, it is an <strong class="vocs_Strong">iterative optimization problem</strong> combining <strong class="vocs_Strong">exponential search</strong> and <strong class="vocs_Strong">binary search</strong> over discrete input amounts.</p>
<hr class="vocs_HorizontalRule"/>
<h4 class="vocs_H4 vocs_Heading"><div id="step-0-initialization" class="vocs_Heading_slugTarget"></div>Step 0: Initialization<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#step-0-initialization" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">Let:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">A_min</code> = initial minimum input (e.g., 0.1 token)</li>
<li class="vocs_ListItem"><code class="vocs_Code">A_max</code> = upper bound (initialized as <code class="vocs_Code">A_min</code>)</li>
<li class="vocs_ListItem"><code class="vocs_Code">P_best = 0</code> = best observed profit</li>
<li class="vocs_ListItem"><code class="vocs_Code">A_best = A_min</code> = best input amount</li>
<li class="vocs_ListItem"><code class="vocs_Code">Œµ</code> = minimum input resolution (based on token decimals, e.g., 0.001 token)</li>
</ul>
<p class="vocs_Paragraph">Define:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">profit(amount)</code> = evaluation function that returns absolute profit from using <code class="vocs_Code">amount</code> on the route.</li>
</ul>
<hr class="vocs_HorizontalRule"/>
<h4 class="vocs_H4 vocs_Heading"><div id="phase-1-doubling-search-exponential-growth" class="vocs_Heading_slugTarget"></div>Phase 1: Doubling Search (Exponential Growth)<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#phase-1-doubling-search-exponential-growth" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Goal:</strong> Quickly find an <strong class="vocs_Strong">upper bound</strong> for profitable input.</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Set <code class="vocs_Code">A = A_min</code></li>
<li class="vocs_ListItem">Repeat for a maximum number of iterations:<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Evaluate profit: <code class="vocs_Code">P = profit(A)</code></li>
<li class="vocs_ListItem">If <code class="vocs_Code">P &gt; P_best</code>, update:<!-- -->
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">P_best = P</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">A_best = A</span></span></code></pre></div></div>
</li>
<li class="vocs_ListItem">If profit drops below threshold or declines significantly, stop doubling</li>
<li class="vocs_ListItem">Else, double the input:<!-- -->
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">A = 2 * A</span></span></code></pre></div></div>
</li>
</ol>
</li>
</ol>
<strong class="vocs_Strong">Result:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">A_max = A</code> (approximate upper bound)</li>
<li class="vocs_ListItem"><code class="vocs_Code">A_min</code> = last profitable input from doubling</li>
</ul>
<blockquote class="vocs_Blockquote">
<p class="vocs_Paragraph">This phase is equivalent to an <strong class="vocs_Strong">exponential search</strong> to find the range where the optimal input lies.</p>
</blockquote>
<hr class="vocs_HorizontalRule"/>
<h4 class="vocs_H4 vocs_Heading"><div id="phase-2-binary-search-refinement" class="vocs_Heading_slugTarget"></div>Phase 2: Binary Search (Refinement)<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#phase-2-binary-search-refinement" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Goal:</strong> Refine the optimal input within <code class="vocs_Code">[A_min, A_max]</code>.</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">While <code class="vocs_Code">A_max - A_min &gt; Œµ</code> and iterations &lt; <code class="vocs_Code">max_search_iterations</code>:<!-- -->
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Compute midpoint:<!-- -->
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">A_mid = (A_min + A_max) / 2</span></span></code></pre></div></div>
</li>
<li class="vocs_ListItem">Evaluate profit at midpoint: <code class="vocs_Code">P = profit(A_mid)</code></li>
<li class="vocs_ListItem">Update best:<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">If <code class="vocs_Code">P &gt; P_best</code>, then:<!-- -->
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">A_best = A_mid</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">P_best = P</span></span></code></pre></div></div>
</li>
</ul>
</li>
<li class="vocs_ListItem">Update bounds for next iteration:<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">If midpoint profit &gt; previous profit ‚Üí search higher: <code class="vocs_Code">A_min = A_mid</code></li>
<li class="vocs_ListItem">Else ‚Üí search lower: <code class="vocs_Code">A_max = A_mid</code></li>
</ul>
</li>
</ol>
</li>
</ol>
<strong class="vocs_Strong">Result:</strong>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><code class="vocs_Code">A_best</code> approximates the <strong class="vocs_Strong">input amount that maximizes profit</strong> within desired precision.</li>
</ul>
<hr class="vocs_HorizontalRule"/>
<h4 class="vocs_H4 vocs_Heading"><div id="mathematical-summary" class="vocs_Heading_slugTarget"></div>Mathematical Summary<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#mathematical-summary" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Exponential search:</strong> Quickly find search range <code class="vocs_Code">[A_min, A_max]</code></li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Binary search:</strong> Efficiently refine the optimum within that range</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Profit metric:</strong> Absolute profit (<code class="vocs_Code">output - input</code>) used to select best amount</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Dynamic adjustments:</strong> Optional function to tweak inputs if routes behave non-linearly or have state-dependent constraints.</li>
</ul>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">maximize P(A) = profit from route given input A</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">subject to:</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    A_min &lt;= A &lt;= A_max</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    P(A) &gt;= profit_threshold</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">where:</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    A_max is found via exponential doubling</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    A_best is refined via binary search</span></span></code></pre></div></div>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Exponential search:</strong> Quickly find search range <code class="vocs_Code">[A_min, A_max]</code></li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Binary search:</strong> Efficiently refine the optimum within that range</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Profit metric:</strong> Absolute profit (<code class="vocs_Code">output - input</code>) used to select best amount</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Dynamic adjustments:</strong> Optional function to tweak inputs if routes behave non-linearly or have state-dependent constraints.</li>
</ul>
<hr class="vocs_HorizontalRule"/>
<h3 class="vocs_H3 vocs_Heading"><div id="arbitrage-profit-calculation" class="vocs_Heading_slugTarget"></div>Arbitrage Profit Calculation<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#arbitrage-profit-calculation" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Net profit percentage for a route:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">swap_profit_pct = (A_k - A_0) / A_0 * 100</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">flash_fee_pct = fee_hundredths_bip / 10,000</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">net_profit_pct = swap_profit_pct - flash_fee_pct</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">net_profit_token = A_k - A_0 - floor( A_0 * fee_hundredths_bip / 1,000,000 )</span></span></code></pre></div></div>
<h2 class="vocs_H2 vocs_Heading"><div id="appendix-b-performance" class="vocs_Heading_slugTarget"></div>Appendix B: Performance<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#appendix-b-performance" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="chain-breakdown" class="vocs_Heading_slugTarget"></div>Chain Breakdown<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#chain-breakdown" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<table class="vocs_Table"><thead><tr class="vocs_TableRow"><th class="vocs_TableHeader">üìä Statistic</th><th class="vocs_TableHeader">Base</th><th class="vocs_TableHeader">Ethereum</th><th class="vocs_TableHeader">Unichain</th></tr></thead><tbody><tr class="vocs_TableRow"><td class="vocs_TableCell">Total Tokens</td><td class="vocs_TableCell">26,061</td><td class="vocs_TableCell">11,824</td><td class="vocs_TableCell">15,300</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Graph Nodes (Tokens)</td><td class="vocs_TableCell">2,477</td><td class="vocs_TableCell">1,593</td><td class="vocs_TableCell">33</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Graph Nodes (V4 Eligible)</td><td class="vocs_TableCell">838</td><td class="vocs_TableCell">826</td><td class="vocs_TableCell">33</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Graph Nodes (V4 Ineligible)</td><td class="vocs_TableCell">1,639</td><td class="vocs_TableCell">767</td><td class="vocs_TableCell">0</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Graph Edges (Pools)</td><td class="vocs_TableCell">5,338</td><td class="vocs_TableCell">4,276</td><td class="vocs_TableCell">114</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Routes Total</td><td class="vocs_TableCell">85,986</td><td class="vocs_TableCell">33,226</td><td class="vocs_TableCell">24,600</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Routes Flash V4</td><td class="vocs_TableCell">85,616</td><td class="vocs_TableCell">19,284</td><td class="vocs_TableCell">68</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Routes Flash Other</td><td class="vocs_TableCell">2</td><td class="vocs_TableCell">11,762</td><td class="vocs_TableCell">19,162</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Routes Flash Error</td><td class="vocs_TableCell">368</td><td class="vocs_TableCell">2,180</td><td class="vocs_TableCell">5,370</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell"><strong class="vocs_Strong">TVL</strong></td><td class="vocs_TableCell">1</td><td class="vocs_TableCell">50</td><td class="vocs_TableCell">1</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell"><strong class="vocs_Strong">HOPS</strong></td><td class="vocs_TableCell">4</td><td class="vocs_TableCell">3</td><td class="vocs_TableCell">5</td></tr></tbody></table>
<h3 class="vocs_H3 vocs_Heading"><div id="performance-summary" class="vocs_Heading_slugTarget"></div>Performance Summary<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#performance-summary" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<table class="vocs_Table"><thead><tr class="vocs_TableRow"><th class="vocs_TableHeader">üìä Statistic</th><th class="vocs_TableHeader">Value</th></tr></thead><tbody><tr class="vocs_TableRow"><td class="vocs_TableCell">Total Routes Evaluated</td><td class="vocs_TableCell">182,746</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Peak Routes/sec</td><td class="vocs_TableCell">1,146</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Current Routes/sec (last run)</td><td class="vocs_TableCell">1,069</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Average Route Eval Time (¬µs)</td><td class="vocs_TableCell">424</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">DB Throughput (ops/sec)</td><td class="vocs_TableCell">0</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Memory Usage (MB)</td><td class="vocs_TableCell">657</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Batch Size (last run)</td><td class="vocs_TableCell">1</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Execution Success Rate (%)</td><td class="vocs_TableCell">100</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">Metrics Capture Duration (s)</td><td class="vocs_TableCell">3,090</td></tr></tbody></table>
<h3 class="vocs_H3 vocs_Heading"><div id="performance-detail" class="vocs_Heading_slugTarget"></div>Performance Detail<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#performance-detail" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<table class="vocs_Table"><thead><tr class="vocs_TableRow"><th class="vocs_TableHeader">Timestamp</th><th class="vocs_TableHeader">Total Routes</th><th class="vocs_TableHeader">Avg Eval Time (¬µs)</th><th class="vocs_TableHeader">Peak Routes/sec</th><th class="vocs_TableHeader">Current Routes/sec</th><th class="vocs_TableHeader">DB Throughput (ops/sec)</th><th class="vocs_TableHeader">Memory (MB)</th><th class="vocs_TableHeader">Batch Size</th><th class="vocs_TableHeader">Success Rate (%)</th><th class="vocs_TableHeader">Metrics Capture Duration (s)</th></tr></thead><tbody><tr class="vocs_TableRow"><td class="vocs_TableCell">2025-09-26T18:02:16</td><td class="vocs_TableCell">9,248</td><td class="vocs_TableCell">57,020</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">190</td><td class="vocs_TableCell">3,122</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0.10</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">2025-09-27T01:27:13</td><td class="vocs_TableCell">33,042</td><td class="vocs_TableCell">1,159</td><td class="vocs_TableCell">576</td><td class="vocs_TableCell">507</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">279</td><td class="vocs_TableCell">1</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">31.60</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">2025-09-27T01:28:31</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">142</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0.10</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">2025-09-27T01:29:52</td><td class="vocs_TableCell">13,896</td><td class="vocs_TableCell">4,799</td><td class="vocs_TableCell">464</td><td class="vocs_TableCell">10</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">247</td><td class="vocs_TableCell">1</td><td class="vocs_TableCell">100</td><td class="vocs_TableCell">36.82</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">2025-09-27T02:28:52</td><td class="vocs_TableCell">8,508</td><td class="vocs_TableCell">3,188</td><td class="vocs_TableCell">483</td><td class="vocs_TableCell">334</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">243</td><td class="vocs_TableCell">1</td><td class="vocs_TableCell">100</td><td class="vocs_TableCell">36.02</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">2025-09-27T05:26:44</td><td class="vocs_TableCell">24,262</td><td class="vocs_TableCell">1,160</td><td class="vocs_TableCell">641</td><td class="vocs_TableCell">90</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">248</td><td class="vocs_TableCell">1</td><td class="vocs_TableCell">40</td><td class="vocs_TableCell">38.74</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">2025-09-27T06:10:32</td><td class="vocs_TableCell">57</td><td class="vocs_TableCell">1,456,807</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">207</td><td class="vocs_TableCell">57</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0.24</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">2025-09-27T06:25:54</td><td class="vocs_TableCell">928</td><td class="vocs_TableCell">185,317</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">302</td><td class="vocs_TableCell">928</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0.16</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">2025-09-27T06:39:39</td><td class="vocs_TableCell">2,138</td><td class="vocs_TableCell">289,502</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">418</td><td class="vocs_TableCell">2,138</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0.25</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">2025-09-27T07:51:53</td><td class="vocs_TableCell">38,810</td><td class="vocs_TableCell">605</td><td class="vocs_TableCell">1,023</td><td class="vocs_TableCell">674</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">412</td><td class="vocs_TableCell">1</td><td class="vocs_TableCell">100</td><td class="vocs_TableCell">226.02</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">2025-09-27T10:36:00</td><td class="vocs_TableCell">3,135</td><td class="vocs_TableCell">2,514,005</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">450</td><td class="vocs_TableCell">3,135</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">7,885.70</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">2025-09-27T16:51:53</td><td class="vocs_TableCell">182,746</td><td class="vocs_TableCell">354</td><td class="vocs_TableCell">1,146</td><td class="vocs_TableCell">1,069</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">657</td><td class="vocs_TableCell">1</td><td class="vocs_TableCell">100</td><td class="vocs_TableCell">3,090.32</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell">2025-09-27T17:08:56</td><td class="vocs_TableCell">60,618</td><td class="vocs_TableCell">424</td><td class="vocs_TableCell">1,033</td><td class="vocs_TableCell">968</td><td class="vocs_TableCell">0</td><td class="vocs_TableCell">494</td><td class="vocs_TableCell">1</td><td class="vocs_TableCell">87</td><td class="vocs_TableCell">416.48</td></tr></tbody></table>
<h2 class="vocs_H2 vocs_Heading"><div id="appendix-c-reference-implementation" class="vocs_Heading_slugTarget"></div>Appendix C: Reference Implementation<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#appendix-c-reference-implementation" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<h3 class="vocs_H3 vocs_Heading"><div id="architecture-overview" class="vocs_Heading_slugTarget"></div>Architecture Overview<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#architecture-overview" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The Tycho solver system implements a sophisticated arbitrage bot capable of generating profit with <strong class="vocs_Strong">no upfront capital</strong> through flash loan-based execution. The architecture follows a <strong class="vocs_Strong">streaming-first approach</strong> that processes real-time blockchain data to identify and execute profitable arbitrage opportunities.</p>
<h4 class="vocs_H4 vocs_Heading"><div id="core-design-principles" class="vocs_Heading_slugTarget"></div>Core Design Principles<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#core-design-principles" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Collectors ‚Üí Strategies ‚Üí Execution</strong>: Modular architecture with clear separation of concerns</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Real-time Processing</strong>: Live blockchain data streaming via Tycho protocol streams</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Capital Efficiency</strong>: Flash loan integration eliminates upfront capital requirements</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Multi-protocol Support</strong>: Uniswap V2, V3, V4 with extensible protocol framework</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Performance Optimization</strong>: Microsecond-level route evaluation and execution</li>
</ol>
<h4 class="vocs_H4 vocs_Heading"><div id="system-architecture" class="vocs_Heading_slugTarget"></div>System Architecture<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#system-architecture" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph"><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 2272.484375 1435" style="max-width:2272.484375px" class="flowchart" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-0"><style>#mermaid-0{font-family:arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-0 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-0 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-0 .error-icon{fill:#552222;}#mermaid-0 .error-text{fill:#552222;stroke:#552222;}#mermaid-0 .edge-thickness-normal{stroke-width:1px;}#mermaid-0 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-0 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-0 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-0 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-0 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-0 .marker{fill:#333333;stroke:#333333;}#mermaid-0 .marker.cross{stroke:#333333;}#mermaid-0 svg{font-family:arial,sans-serif;font-size:16px;}#mermaid-0 p{margin:0;}#mermaid-0 .label{font-family:arial,sans-serif;color:#333;}#mermaid-0 .cluster-label text{fill:#333;}#mermaid-0 .cluster-label span{color:#333;}#mermaid-0 .cluster-label span p{background-color:transparent;}#mermaid-0 .label text,#mermaid-0 span{fill:#333;color:#333;}#mermaid-0 .node rect,#mermaid-0 .node circle,#mermaid-0 .node ellipse,#mermaid-0 .node polygon,#mermaid-0 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-0 .rough-node .label text,#mermaid-0 .node .label text,#mermaid-0 .image-shape .label,#mermaid-0 .icon-shape .label{text-anchor:middle;}#mermaid-0 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-0 .rough-node .label,#mermaid-0 .node .label,#mermaid-0 .image-shape .label,#mermaid-0 .icon-shape .label{text-align:center;}#mermaid-0 .node.clickable{cursor:pointer;}#mermaid-0 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#mermaid-0 .arrowheadPath{fill:#333333;}#mermaid-0 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-0 .flowchart-link{stroke:#333333;fill:none;}#mermaid-0 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-0 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#mermaid-0 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-0 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaid-0 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-0 .cluster text{fill:#333;}#mermaid-0 .cluster span{color:#333;}#mermaid-0 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-0 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-0 rect.text{fill:none;stroke-width:0;}#mermaid-0 .icon-shape,#mermaid-0 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-0 .icon-shape p,#mermaid-0 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#mermaid-0 .icon-shape rect,#mermaid-0 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-0 .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#mermaid-0 .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#mermaid-0 :root{--mermaid-font-family:arial,sans-serif;}</style><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-0_flowchart-v2-pointEnd"><path style="stroke-width:1;stroke-dasharray:1, 0" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-0_flowchart-v2-pointStart"><path style="stroke-width:1;stroke-dasharray:1, 0" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-0_flowchart-v2-circleEnd"><circle style="stroke-width:1;stroke-dasharray:1, 0" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-0_flowchart-v2-circleStart"><circle style="stroke-width:1;stroke-dasharray:1, 0" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-0_flowchart-v2-crossEnd"><path style="stroke-width:2;stroke-dasharray:1, 0" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-0_flowchart-v2-crossStart"><path style="stroke-width:2;stroke-dasharray:1, 0" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="subGraph8" class="cluster"><rect height="104" width="602.5625" y="8" x="735.5"></rect><g transform="translate(1003.578125, 8)" class="cluster-label"><foreignObject height="24" width="66.40625"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">CLI Tools</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph7" class="cluster"><rect height="208" width="236.71875" y="1219" x="1895.03125"></rect><g transform="translate(1955.59375, 1219)" class="cluster-label"><foreignObject height="24" width="115.59375"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Smart Contracts</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph6" class="cluster"><rect height="1007" width="2169.45703125" y="162" x="53.625"></rect><g transform="translate(1055.220703125, 162)" class="cluster-label"><foreignObject height="24" width="166.265625"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">solver_driver (Runtime)</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph1" class="cluster"><rect height="104" width="906.421875" y="8" x="1358.0625"></rect><g transform="translate(1724.125, 8)" class="cluster-label"><foreignObject height="24" width="174.296875"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">solver_core (Pure Logic)</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph0" class="cluster"><rect height="104" width="707.5" y="8" x="8"></rect><g transform="translate(281.7109375, 8)" class="cluster-label"><foreignObject height="24" width="160.078125"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">External Data Sources</p></span></div></foreignObject></g></g><g data-look="classic" id="Persistence" class="cluster"><rect height="104" width="551.66015625" y="678" x="507.28125"></rect><g transform="translate(741.314453125, 678)" class="cluster-label"><foreignObject height="24" width="83.59375"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Persistence</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph4" class="cluster"><rect height="312" width="269.046875" y="832" x="1878.8671875"></rect><g transform="translate(1947.5703125, 832)" class="cluster-label"><foreignObject height="24" width="131.640625"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Execution Pipeline</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph3" class="cluster"><rect height="337" width="1116.5078125" y="445" x="1078.94140625"></rect><g transform="translate(1566.9296875, 445)" class="cluster-label"><foreignObject height="24" width="140.53125"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Processing Pipeline</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph2" class="cluster"><rect height="208" width="998.23046875" y="187" x="73.625"></rect><g transform="translate(518.490234375, 187)" class="cluster-label"><foreignObject height="24" width="108.5"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Data Collection</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_TYCHO_STREAMING_0" d="M157.922,87L157.922,91.167C157.922,95.333,157.922,103.667,157.922,112C157.922,120.333,157.922,128.667,157.922,137C157.922,145.333,157.922,153.667,157.922,162C157.922,170.333,157.922,178.667,193.939,188.805C229.957,198.943,301.992,210.886,338.009,216.857L374.027,222.829"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_RPC_COLLECTORS_0" d="M410.648,87L410.648,91.167C410.648,95.333,410.648,103.667,436.146,112C461.643,120.333,512.638,128.667,538.135,137C563.633,145.333,563.633,153.667,563.633,162C563.633,170.333,563.633,178.667,583.214,187.775C602.796,196.883,641.959,206.766,661.54,211.708L681.122,216.649"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_API_COLLECTORS_0" d="M614.477,87L614.477,91.167C614.477,95.333,614.477,103.667,640.345,112C666.214,120.333,717.951,128.667,743.819,137C769.688,145.333,769.688,153.667,769.688,162C769.688,170.333,769.688,178.667,769.688,186.333C769.688,194,769.688,201,769.688,204.5L769.688,208"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_STREAMING_STORE_0" d="M471.566,266L471.566,270.167C471.566,274.333,471.566,282.667,525.254,293.929C578.941,305.191,686.316,319.382,740.003,326.478L793.691,333.573"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_STORE_GRAPH_0" d="M919.265,370L927.637,374.167C936.009,378.333,952.752,386.667,1019.415,395C1086.077,403.333,1202.658,411.667,1260.948,420C1319.238,428.333,1319.238,436.667,1319.238,444.333C1319.238,452,1319.238,459,1319.238,462.5L1319.238,466"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_GRAPH_ROUTES_0" d="M1256.854,524L1247.226,528.167C1237.599,532.333,1218.344,540.667,1208.717,548.333C1199.09,556,1199.09,563,1199.09,566.5L1199.09,570"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_ROUTES_ANALYZER_0" d="M1271.859,628L1283.089,632.167C1294.319,636.333,1316.779,644.667,1328.008,653C1339.238,661.333,1339.238,669.667,1436.889,681.366C1534.54,693.064,1729.843,708.129,1827.494,715.661L1925.145,723.193"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_ANALYZER_ENCODER_0" d="M2013.391,757L2013.391,761.167C2013.391,765.333,2013.391,773.667,2013.391,782C2013.391,790.333,2013.391,798.667,2013.391,807C2013.391,815.333,2013.391,823.667,2013.391,831.333C2013.391,839,2013.391,846,2013.391,849.5L2013.391,853"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_ENCODER_EXECUTOR_0" d="M2013.391,911L2013.391,915.167C2013.391,919.333,2013.391,927.667,2013.391,935.333C2013.391,943,2013.391,950,2013.391,953.5L2013.391,957"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_EXECUTOR_SENDER_0" d="M2013.391,1015L2013.391,1019.167C2013.391,1023.333,2013.391,1031.667,2013.391,1039.333C2013.391,1047,2013.391,1054,2013.391,1057.5L2013.391,1061"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_STORE_DB_0" d="M797.656,354.024L755.927,360.853C714.198,367.683,630.74,381.341,589.01,392.337C547.281,403.333,547.281,411.667,547.281,420C547.281,428.333,547.281,436.667,547.281,449.5C547.281,462.333,547.281,479.667,547.281,497C547.281,514.333,547.281,531.667,547.281,549C547.281,566.333,547.281,583.667,547.281,601C547.281,618.333,547.281,635.667,547.281,648.5C547.281,661.333,547.281,669.667,568.552,679.51C589.822,689.354,632.364,700.708,653.634,706.385L674.905,712.062"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_ROUTES_DB_0" d="M1199.09,628L1199.09,632.167C1199.09,636.333,1199.09,644.667,1199.09,653C1199.09,661.333,1199.09,669.667,1134.147,681.223C1069.204,692.78,939.318,707.56,874.374,714.95L809.431,722.34"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_GRAPH_DB_0" d="M1319.238,524L1319.238,528.167C1319.238,532.333,1319.238,540.667,1319.238,553.5C1319.238,566.333,1319.238,583.667,1319.238,601C1319.238,618.333,1319.238,635.667,1319.238,648.5C1319.238,661.333,1319.238,669.667,1234.272,681.489C1149.306,693.311,979.373,708.622,894.407,716.278L809.441,723.934"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_SENDER_ROUTER_0" d="M2013.391,1119L2013.391,1123.167C2013.391,1127.333,2013.391,1135.667,2013.391,1144C2013.391,1152.333,2013.391,1160.667,2013.391,1169C2013.391,1177.333,2013.391,1185.667,2013.391,1194C2013.391,1202.333,2013.391,1210.667,2013.391,1218.333C2013.391,1226,2013.391,1233,2013.391,1236.5L2013.391,1240"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_ROUTER_POOLS_0" d="M2013.391,1298L2013.391,1302.167C2013.391,1306.333,2013.391,1314.667,2013.391,1322.333C2013.391,1330,2013.391,1337,2013.391,1340.5L2013.391,1344"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_ARBITRAGER_STREAMING_0" d="M835.625,87L835.625,91.167C835.625,95.333,835.625,103.667,747.785,112C659.944,120.333,484.263,128.667,396.423,137C308.582,145.333,308.582,153.667,308.582,162C308.582,170.333,308.582,178.667,321.007,186.797C333.431,194.928,358.28,202.856,370.705,206.82L383.129,210.784"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_ROUTE_EXEC_ANALYZER_0" d="M1217.922,87L1217.922,91.167C1217.922,95.333,1217.922,103.667,1271.854,112C1325.785,120.333,1433.648,128.667,1487.58,137C1541.512,145.333,1541.512,153.667,1541.512,162C1541.512,170.333,1541.512,178.667,1541.512,191.5C1541.512,204.333,1541.512,221.667,1541.512,239C1541.512,256.333,1541.512,273.667,1541.512,291C1541.512,308.333,1541.512,325.667,1541.512,343C1541.512,360.333,1541.512,377.667,1541.512,390.5C1541.512,403.333,1541.512,411.667,1541.512,420C1541.512,428.333,1541.512,436.667,1541.512,449.5C1541.512,462.333,1541.512,479.667,1541.512,497C1541.512,514.333,1541.512,531.667,1541.512,549C1541.512,566.333,1541.512,583.667,1541.512,601C1541.512,618.333,1541.512,635.667,1541.512,648.5C1541.512,661.333,1541.512,669.667,1605.453,680.879C1669.393,692.092,1797.275,706.185,1861.216,713.231L1925.157,720.277"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_TYCHO_CLI_DB_0" d="M1016.766,87L1016.766,91.167C1016.766,95.333,1016.766,103.667,1029.281,112C1041.796,120.333,1066.826,128.667,1079.34,137C1091.855,145.333,1091.855,153.667,1091.855,162C1091.855,170.333,1091.855,178.667,1091.855,191.5C1091.855,204.333,1091.855,221.667,1091.855,239C1091.855,256.333,1091.855,273.667,1091.855,291C1091.855,308.333,1091.855,325.667,1091.855,343C1091.855,360.333,1091.855,377.667,1045.021,390.5C998.186,403.333,904.517,411.667,857.682,420C810.848,428.333,810.848,436.667,810.848,449.5C810.848,462.333,810.848,479.667,810.848,497C810.848,514.333,810.848,531.667,810.848,549C810.848,566.333,810.848,583.667,810.848,601C810.848,618.333,810.848,635.667,810.848,648.5C810.848,661.333,810.848,669.667,805.872,677.598C800.896,685.529,790.944,693.058,785.968,696.822L780.992,700.587"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_TYPES_STREAMING_0" d="M1474.055,87L1474.055,91.167C1474.055,95.333,1474.055,103.667,1318.984,112C1163.914,120.333,853.773,128.667,698.703,137C543.633,145.333,543.633,153.667,543.633,162C543.633,170.333,543.633,178.667,538.399,186.61C533.165,194.553,522.697,202.106,517.463,205.883L512.229,209.659"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_TRAITS_ANALYZER_0" d="M1916.82,87L1916.82,91.167C1916.82,95.333,1916.82,103.667,1916.82,112C1916.82,120.333,1916.82,128.667,1916.82,137C1916.82,145.333,1916.82,153.667,1916.82,162C1916.82,170.333,1916.82,178.667,1916.82,191.5C1916.82,204.333,1916.82,221.667,1916.82,239C1916.82,256.333,1916.82,273.667,1916.82,291C1916.82,308.333,1916.82,325.667,1916.82,343C1916.82,360.333,1916.82,377.667,1916.82,390.5C1916.82,403.333,1916.82,411.667,1916.82,420C1916.82,428.333,1916.82,436.667,1916.82,449.5C1916.82,462.333,1916.82,479.667,1916.82,497C1916.82,514.333,1916.82,531.667,1916.82,549C1916.82,566.333,1916.82,583.667,1916.82,601C1916.82,618.333,1916.82,635.667,1916.82,648.5C1916.82,661.333,1916.82,669.667,1923.971,677.684C1931.122,685.701,1945.424,693.402,1952.575,697.253L1959.726,701.104"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_MATH_ANALYZER_0" d="M2141.68,87L2141.68,91.167C2141.68,95.333,2141.68,103.667,2141.68,112C2141.68,120.333,2141.68,128.667,2141.68,137C2141.68,145.333,2141.68,153.667,2141.68,162C2141.68,170.333,2141.68,178.667,2141.68,191.5C2141.68,204.333,2141.68,221.667,2141.68,239C2141.68,256.333,2141.68,273.667,2141.68,291C2141.68,308.333,2141.68,325.667,2141.68,343C2141.68,360.333,2141.68,377.667,2141.68,390.5C2141.68,403.333,2141.68,411.667,2141.68,420C2141.68,428.333,2141.68,436.667,2141.68,449.5C2141.68,462.333,2141.68,479.667,2141.68,497C2141.68,514.333,2141.68,531.667,2141.68,549C2141.68,566.333,2141.68,583.667,2141.68,601C2141.68,618.333,2141.68,635.667,2141.68,648.5C2141.68,661.333,2141.68,669.667,2132.018,677.75C2122.356,685.832,2103.033,693.665,2093.371,697.581L2083.709,701.497"></path><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_PROTOCOL_STORE_0" d="M1692.406,87L1692.406,91.167C1692.406,95.333,1692.406,103.667,1571.921,112C1451.436,120.333,1210.466,128.667,1089.981,137C969.496,145.333,969.496,153.667,969.496,162C969.496,170.333,969.496,178.667,969.496,191.5C969.496,204.333,969.496,221.667,969.496,239C969.496,256.333,969.496,273.667,961.721,286.203C953.946,298.739,938.396,306.478,930.621,310.348L922.846,314.218"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" class="labelBkg vocs_Div" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel vocs_Span"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(157.921875, 60)" id="flowchart-TYCHO-0" class="node default"><rect height="54" width="229.84375" y="-27" x="-114.921875" class="basic label-container"></rect><g transform="translate(-84.921875, -12)" class="label"><rect></rect><foreignObject height="24" width="169.84375"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Tycho Protocol Streams</p></span></div></foreignObject></g></g><g transform="translate(410.6484375, 60)" id="flowchart-RPC-1" class="node default"><rect height="54" width="175.609375" y="-27" x="-87.8046875" class="basic label-container"></rect><g transform="translate(-57.8046875, -12)" class="label"><rect></rect><foreignObject height="24" width="115.609375"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Blockchain RPC</p></span></div></foreignObject></g></g><g transform="translate(614.4765625, 60)" id="flowchart-API-2" class="node default"><rect height="54" width="132.046875" y="-27" x="-66.0234375" class="basic label-container"></rect><g transform="translate(-36.0234375, -12)" class="label"><rect></rect><foreignObject height="24" width="72.046875"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Tycho API</p></span></div></foreignObject></g></g><g transform="translate(1474.0546875, 60)" id="flowchart-TYPES-3" class="node default"><rect height="54" width="161.984375" y="-27" x="-80.9921875" class="basic label-container"></rect><g transform="translate(-50.9921875, -12)" class="label"><rect></rect><foreignObject height="24" width="101.984375"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Domain Types</p></span></div></foreignObject></g></g><g transform="translate(1916.8203125, 60)" id="flowchart-TRAITS-4" class="node default"><rect height="54" width="174.109375" y="-27" x="-87.0546875" class="basic label-container"></rect><g transform="translate(-57.0546875, -12)" class="label"><rect></rect><foreignObject height="24" width="114.109375"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Interfaces/Traits</p></span></div></foreignObject></g></g><g transform="translate(2141.6796875, 60)" id="flowchart-MATH-5" class="node default"><rect height="54" width="175.609375" y="-27" x="-87.8046875" class="basic label-container"></rect><g transform="translate(-57.8046875, -12)" class="label"><rect></rect><foreignObject height="24" width="115.609375"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">FixedPoint Math</p></span></div></foreignObject></g></g><g transform="translate(1692.40625, 60)" id="flowchart-PROTOCOL-6" class="node default"><rect height="54" width="174.71875" y="-27" x="-87.359375" class="basic label-container"></rect><g transform="translate(-57.359375, -12)" class="label"><rect></rect><foreignObject height="24" width="114.71875"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Protocol Models</p></span></div></foreignObject></g></g><g transform="translate(471.56640625, 239)" id="flowchart-STREAMING-7" class="node default"><rect height="54" width="187.1875" y="-27" x="-93.59375" class="basic label-container"></rect><g transform="translate(-63.59375, -12)" class="label"><rect></rect><foreignObject height="24" width="127.1875"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Streaming Engine</p></span></div></foreignObject></g></g><g transform="translate(769.6875, 239)" id="flowchart-COLLECTORS-8" class="node default"><rect height="54" width="169.375" y="-27" x="-84.6875" class="basic label-container"></rect><g transform="translate(-54.6875, -12)" class="label"><rect></rect><foreignObject height="24" width="109.375"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Data Collectors</p></span></div></foreignObject></g></g><g transform="translate(865.015625, 343)" id="flowchart-STORE-9" class="node default"><rect height="54" width="134.71875" y="-27" x="-67.359375" class="basic label-container"></rect><g transform="translate(-37.359375, -12)" class="label"><rect></rect><foreignObject height="24" width="74.71875"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Pool Store</p></span></div></foreignObject></g></g><g transform="translate(1319.23828125, 497)" id="flowchart-GRAPH-10" class="node default"><rect height="54" width="172.0625" y="-27" x="-86.03125" class="basic label-container"></rect><g transform="translate(-56.03125, -12)" class="label"><rect></rect><foreignObject height="24" width="112.0625"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Graph Manager</p></span></div></foreignObject></g></g><g transform="translate(1199.08984375, 601)" id="flowchart-ROUTES-11" class="node default"><rect height="54" width="170.296875" y="-27" x="-85.1484375" class="basic label-container"></rect><g transform="translate(-55.1484375, -12)" class="label"><rect></rect><foreignObject height="24" width="110.296875"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Route Manager</p></span></div></foreignObject></g></g><g transform="translate(2013.390625, 730)" id="flowchart-ANALYZER-12" class="node default"><rect height="54" width="168.515625" y="-27" x="-84.2578125" class="basic label-container"></rect><g transform="translate(-54.2578125, -12)" class="label"><rect></rect><foreignObject height="24" width="108.515625"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Route Analyzer</p></span></div></foreignObject></g></g><g transform="translate(2013.390625, 884)" id="flowchart-ENCODER-13" class="node default"><rect height="54" width="181.859375" y="-27" x="-90.9296875" class="basic label-container"></rect><g transform="translate(-60.9296875, -12)" class="label"><rect></rect><foreignObject height="24" width="121.859375"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Solution Encoder</p></span></div></foreignObject></g></g><g transform="translate(2013.390625, 988)" id="flowchart-EXECUTOR-14" class="node default"><rect height="54" width="184.53125" y="-27" x="-92.265625" class="basic label-container"></rect><g transform="translate(-62.265625, -12)" class="label"><rect></rect><foreignObject height="24" width="124.53125"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Execution Engine</p></span></div></foreignObject></g></g><g transform="translate(2013.390625, 1092)" id="flowchart-SENDER-15" class="node default"><rect height="54" width="199.046875" y="-27" x="-99.5234375" class="basic label-container"></rect><g transform="translate(-69.5234375, -12)" class="label"><rect></rect><foreignObject height="24" width="139.046875"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Transaction Sender</p></span></div></foreignObject></g></g><g transform="translate(742.11328125, 730)" id="flowchart-DB-16" class="node default"><rect height="54" width="126.6875" y="-27" x="-63.34375" class="basic label-container"></rect><g transform="translate(-33.34375, -12)" class="label"><rect></rect><foreignObject height="24" width="66.6875"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">RocksDB</p></span></div></foreignObject></g></g><g transform="translate(939.69921875, 730)" id="flowchart-CACHE-17" class="node default"><rect height="54" width="168.484375" y="-27" x="-84.2421875" class="basic label-container"></rect><g transform="translate(-54.2421875, -12)" class="label"><rect></rect><foreignObject height="24" width="108.484375"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Memory Cache</p></span></div></foreignObject></g></g><g transform="translate(2013.390625, 1271)" id="flowchart-ROUTER-18" class="node default"><rect height="54" width="166.71875" y="-27" x="-83.359375" class="basic label-container"></rect><g transform="translate(-53.359375, -12)" class="label"><rect></rect><foreignObject height="24" width="106.71875"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">FlashV3Router</p></span></div></foreignObject></g></g><g transform="translate(2013.390625, 1375)" id="flowchart-POOLS-19" class="node default"><rect height="54" width="137.375" y="-27" x="-68.6875" class="basic label-container"></rect><g transform="translate(-38.6875, -12)" class="label"><rect></rect><foreignObject height="24" width="77.375"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">DEX Pools</p></span></div></foreignObject></g></g><g transform="translate(835.625, 60)" id="flowchart-ARBITRAGER-20" class="node default"><rect height="54" width="130.25" y="-27" x="-65.125" class="basic label-container"></rect><g transform="translate(-35.125, -12)" class="label"><rect></rect><foreignObject height="24" width="70.25"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Arbitrager</p></span></div></foreignObject></g></g><g transform="translate(1217.921875, 60)" id="flowchart-ROUTE_EXEC-21" class="node default"><rect height="54" width="170.28125" y="-27" x="-85.140625" class="basic label-container"></rect><g transform="translate(-55.140625, -12)" class="label"><rect></rect><foreignObject height="24" width="110.28125"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Route Executor</p></span></div></foreignObject></g></g><g transform="translate(1016.765625, 60)" id="flowchart-TYCHO_CLI-22" class="node default"><rect height="54" width="132.03125" y="-27" x="-66.015625" class="basic label-container"></rect><g transform="translate(-36.015625, -12)" class="label"><rect></rect><foreignObject height="24" width="72.03125"><div style="display:table-cell;white-space:nowrap;line-height:1.5;max-width:200px;text-align:center" xmlns="http://www.w3.org/1999/xhtml" class="vocs_Div"><span class="nodeLabel vocs_Span"><p class="vocs_Paragraph">Tycho CLI</p></span></div></foreignObject></g></g></g></g></g></svg></p>
<h3 class="vocs_H3 vocs_Heading"><div id="liquidity-mapping-collector" class="vocs_Heading_slugTarget"></div>Liquidity Mapping Collector<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#liquidity-mapping-collector" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The liquidity mapping collector system provides comprehensive chain indexing capabilities through integration with Tycho protocol streams, enabling real-time monitoring of blockchain state changes across multiple supported chains.</p>
<h4 class="vocs_H4 vocs_Heading"><div id="persistence" class="vocs_Heading_slugTarget"></div>Persistence<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#persistence" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The system uses <strong class="vocs_Strong">RocksDB</strong> as its primary database engine with a column family architecture optimized for high-performance operations:</p>
<table class="vocs_Table"><thead><tr class="vocs_TableRow"><th class="vocs_TableHeader">Column Family</th><th class="vocs_TableHeader">Purpose</th><th class="vocs_TableHeader">Key Format</th><th class="vocs_TableHeader">Value Format</th></tr></thead><tbody><tr class="vocs_TableRow"><td class="vocs_TableCell"><code class="vocs_Code">tokens</code></td><td class="vocs_TableCell">Token metadata</td><td class="vocs_TableCell"><code class="vocs_Code">token:&lt;address&gt;</code></td><td class="vocs_TableCell">Serialized <code class="vocs_Code">Token</code> struct</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell"><code class="vocs_Code">graph</code></td><td class="vocs_TableCell">Graph edges</td><td class="vocs_TableCell"><code class="vocs_Code">graph:&lt;token_address&gt;</code></td><td class="vocs_TableCell">Serialized <code class="vocs_Code">Vec&lt;CompactEdge&gt;</code></td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell"><code class="vocs_Code">routes</code></td><td class="vocs_TableCell">Calculated routes</td><td class="vocs_TableCell"><code class="vocs_Code">route:&lt;route_id&gt;</code></td><td class="vocs_TableCell">Serialized <code class="vocs_Code">Route</code> struct</td></tr><tr class="vocs_TableRow"><td class="vocs_TableCell"><code class="vocs_Code">signals</code></td><td class="vocs_TableCell">Route signals</td><td class="vocs_TableCell"><code class="vocs_Code">signal:&lt;signal_id&gt;</code></td><td class="vocs_TableCell">Serialized <code class="vocs_Code">RouteSignal</code> struct</td></tr></tbody></table>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Performance Optimizations</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Write Batching</strong>: 100 operations per batch with 100ms flush interval</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Asynchronous Writes</strong>: Non-blocking write operations via dedicated writer thread</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Memory Caching</strong>: In-memory route storage with O(1) pool index lookup</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Incremental Updates</strong>: Only recalculates affected routes on state changes</li>
</ul>
<h4 class="vocs_H4 vocs_Heading"><div id="graph-manager" class="vocs_Heading_slugTarget"></div>Graph Manager<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#graph-manager" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The Graph Manager constructs and maintains trading graphs using tokens as nodes and pools as edges in a multi-graph structure:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> GraphManager</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    token_to_id</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> HashMap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Bytes</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">u32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    id_to_token</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> HashMap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">u32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Bytes</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    pool_to_id</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> HashMap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">u32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    id_to_pool</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> HashMap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">u32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    next_token_id</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> u32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    next_pool_id</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> u32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">#[derive(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Debug</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Clone</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Serialize</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Deserialize</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)]</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> CompactEdge</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> pool_id</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> u32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> token_out</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> u32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> protocol</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> u8</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// 0=UniV2, 1=UniV3, 2=UniV4, etc.</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> fee_bps</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> u32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Key Features</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Dynamic Graph Building</strong>: Real-time graph construction with generic <code class="vocs_Code">build_or_update_graph()</code> function</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Edge Management</strong>: Pool rate edges with metadata</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Node Management</strong>: Token nodes with properties</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Graph Traversal</strong>: Efficient path finding algorithms using Depth-First Search (DFS)</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Cycle Detection</strong>: Arbitrage cycle identification</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Incremental Updates</strong>: Optimized for streaming performance with every-block updates</li>
</ul>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Graph Building Performance</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">193¬µs</strong> for 37 pools</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">33¬µs</strong> for 2 pools</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">O(deg)</strong> updates for efficient streaming</li>
</ul>
<h4 class="vocs_H4 vocs_Heading"><div id="flash-loan-manager" class="vocs_Heading_slugTarget"></div>Flash Loan Manager<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#flash-loan-manager" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The Flash Loan Manager selects optimal flash loan pools based on fee structure and compatibility rules:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">#[derive(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Debug</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Clone</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">PartialEq</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)]</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> enum</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> FlashLoanProvider</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Uniswap V3 flash loans - always available for all routes</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    UniswapV3</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// Uniswap V4 flash loans - conditionally available</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    ///</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// **IMPORTANT ELIGIBILITY RULE**:</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// V4 flash loans are only allowed when the route does NOT contain Uniswap V4 pools.</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    /// This prevents recursive dependencies and potential locking issues.</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    UniswapV4</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">#[derive(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Debug</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Clone</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)]</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> FlashLoanCriteria</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> min_liquidity_eth</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> f64</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> max_fee_bps</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> u32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> preferred_providers</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Vec</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">FlashLoanProvider</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Flash Loan Selection Logic</strong>:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">V3 Flash Loans</strong>: Always compatible with any route (30 bps fee)</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">V4 Flash Loans</strong>: Only compatible with routes that do NOT contain V4 pools (0 bps fee)</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Priority Order</strong>: V3 (priority 1), V4 (priority 2)</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Liquidity Requirements</strong>: Minimum 0.1 ETH liquidity for testing</li>
</ol>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Compatibility Rules</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">‚úÖ Route [USDC ‚Üí WETH ‚Üí WBTC] (V2/V3 only) ‚Üí V4 flash loans allowed</li>
<li class="vocs_ListItem">‚ùå Route [USDC ‚Üí WETH (V4) ‚Üí DAI] ‚Üí V4 flash loans blocked, fallback to V3</li>
</ul>
<h4 class="vocs_H4 vocs_Heading"><div id="route-manager-1" class="vocs_Heading_slugTarget"></div>Route Manager<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#route-manager-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The Route Manager discovers and manages arbitrage routes using sophisticated algorithms:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> EnhancedRouteManager</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    cache</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> AHashMap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">RouteCacheEntry</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;, </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// route_id -&gt; cache entry</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    token_routes</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> AHashMap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Bytes</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">AHashSet</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;&gt;, </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// token -&gt; route_ids</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    route_deps</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> AHashMap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">AHashSet</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;&gt;, </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// pool_id -&gt; route_ids</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    max_hops</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> usize</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    config</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> RouteManagerConfig</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Route Discovery Process</strong>:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">BFS-based Discovery</strong>: Uses Breadth-First Search for efficient route generation</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Incremental Updates</strong>: Only processes affected routes when pools change</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Pruning Heuristics</strong>: Applies smart filtering to prevent route explosion</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Cycle Detection</strong>: Identifies profitable arbitrage cycles</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Flash Loan Integration</strong>: Automatically selects compatible flash loans</li>
</ol>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Route Performance</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">2.42¬µs</strong> for 3-hop routes</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">833ns</strong> for 4-hop routes</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">791ns</strong> for 5-hop routes</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">1,983,160 routes</strong> (3-hop) generated in ~222 seconds</li>
</ul>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Pruning Heuristics</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Avoid cycles (unless for cycle arbitrage)</li>
<li class="vocs_ListItem">Check for duplicate pools in route</li>
<li class="vocs_ListItem">Limit routes per token to prevent explosion</li>
<li class="vocs_ListItem">Protocol-specific pruning (V4 overflow protection)</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="streaming-engine-collector" class="vocs_Heading_slugTarget"></div>Streaming Engine Collector<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#streaming-engine-collector" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The MinimalStreamingEngine serves as the central orchestrator for the entire arbitrage system, coordinating real-time data ingestion, route discovery, profitability evaluation, and transaction execution.</p>
<h4 class="vocs_H4 vocs_Heading"><div id="core-components" class="vocs_Heading_slugTarget"></div>Core Components<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#core-components" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> MinimalStreamingEngine</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    streamed_pools</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Arc</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Mutex</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HashMap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">ProtocolComponent</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;&gt;&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    streamed_states</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Arc</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">dyn</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> PoolStore</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    routes_in_memory</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Arc</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Mutex</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HashMap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">MinimalRoute</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;&gt;&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    route_pool_index</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Arc</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Mutex</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HashMap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">HashSet</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;&gt;&gt;&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    evaluation_sender</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Option</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">UnboundedSender</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">MinimalRoute</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    execution_queue</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Arc</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Mutex</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Vec</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">MinimalRoute</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">RouteEvaluation</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)&gt;&gt;&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Key Features</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">WebSocket Integration</strong>: Direct connection to Tycho protocol streams</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Real-time State Processing</strong>: Live protocol state updates from blockchain</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Incremental Graph Building</strong>: Dynamic graph construction with new pools</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Route Discovery</strong>: Automatic route calculation for new trading pairs</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Performance Optimization</strong>: Microsecond-level processing with memory caching</li>
</ul>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Initialization Process</strong>:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Initialize token store from RPC</li>
<li class="vocs_ListItem">Start Tycho streaming connection</li>
<li class="vocs_ListItem">Build initial graph from pool data</li>
<li class="vocs_ListItem">Find routes with flash loans</li>
<li class="vocs_ListItem">Start route evaluation loop</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="stream-and-state-updates" class="vocs_Heading_slugTarget"></div>Stream and State Updates<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#stream-and-state-updates" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The streaming system processes real-time blockchain data through a sophisticated pipeline:</p>
<h4 class="vocs_H4 vocs_Heading"><div id="stream-message-processing" class="vocs_Heading_slugTarget"></div>Stream Message Processing<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#stream-message-processing" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">async</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> process_stream_message</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;mut</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, message</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> StreamMessage</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Result</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;()&gt; {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Update pool states</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">    self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">update_pool_states</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">message)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Check for new trading pairs</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">has_new_pairs</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">message) {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">process_new_pools</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">message)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Re-evaluate existing routes if state changed</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">has_state_updates</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">message) {</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">re_evaluate_routes</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h4 class="vocs_H4 vocs_Heading"><div id="state-update-flow" class="vocs_Heading_slugTarget"></div>State Update Flow<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#state-update-flow" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph"><svg aria-roledescription="sequence" role="graphics-document document" viewBox="-50 -10 1568 479" style="max-width:1568px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-1"><g><rect class="actor actor-bottom" ry="3" rx="3" name="EE" height="65" width="150" stroke="#666" fill="#eaeaea" y="393" x="1318"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="425.5" x="1393"><tspan dy="0" x="1393">Execution Engine</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="RA" height="65" width="150" stroke="#666" fill="#eaeaea" y="393" x="1063"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="425.5" x="1138"><tspan dy="0" x="1138">Route Analyzer</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="RM" height="65" width="150" stroke="#666" fill="#eaeaea" y="393" x="863"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="425.5" x="938"><tspan dy="0" x="938">Route Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="GM" height="65" width="150" stroke="#666" fill="#eaeaea" y="393" x="635"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="425.5" x="710"><tspan dy="0" x="710">Graph Manager</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="PS" height="65" width="150" stroke="#666" fill="#eaeaea" y="393" x="435"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="425.5" x="510"><tspan dy="0" x="510">Pool Store</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="SE" height="65" width="150" stroke="#666" fill="#eaeaea" y="393" x="235"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="425.5" x="310"><tspan dy="0" x="310">Streaming Engine</tspan></text></g><g><rect class="actor actor-bottom" ry="3" rx="3" name="T" height="65" width="150" stroke="#666" fill="#eaeaea" y="393" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="425.5" x="75"><tspan dy="0" x="75">Tycho Stream</tspan></text></g><g><line name="EE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="393" x2="1393" y1="65" x1="1393" id="actor6"></line><g id="root-6"><rect class="actor actor-top" ry="3" rx="3" name="EE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1318"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1393"><tspan dy="0" x="1393">Execution Engine</tspan></text></g></g><g><line name="RA" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="393" x2="1138" y1="65" x1="1138" id="actor5"></line><g id="root-5"><rect class="actor actor-top" ry="3" rx="3" name="RA" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="1063"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="1138"><tspan dy="0" x="1138">Route Analyzer</tspan></text></g></g><g><line name="RM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="393" x2="938" y1="65" x1="938" id="actor4"></line><g id="root-4"><rect class="actor actor-top" ry="3" rx="3" name="RM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="863"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="938"><tspan dy="0" x="938">Route Manager</tspan></text></g></g><g><line name="GM" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="393" x2="710" y1="65" x1="710" id="actor3"></line><g id="root-3"><rect class="actor actor-top" ry="3" rx="3" name="GM" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="635"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="710"><tspan dy="0" x="710">Graph Manager</tspan></text></g></g><g><line name="PS" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="393" x2="510" y1="65" x1="510" id="actor2"></line><g id="root-2"><rect class="actor actor-top" ry="3" rx="3" name="PS" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="435"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="510"><tspan dy="0" x="510">Pool Store</tspan></text></g></g><g><line name="SE" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="393" x2="310" y1="65" x1="310" id="actor1"></line><g id="root-1"><rect class="actor actor-top" ry="3" rx="3" name="SE" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="235"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="310"><tspan dy="0" x="310">Streaming Engine</tspan></text></g></g><g><line name="T" stroke="#999" stroke-width="0.5px" class="actor-line 200" y2="393" x2="75" y1="65" x1="75" id="actor0"></line><g id="root-0"><rect class="actor actor-top" ry="3" rx="3" name="T" height="65" width="150" stroke="#666" fill="#eaeaea" y="0" x="0"></rect><text style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial, sans-serif" class="actor actor-box" alignment-baseline="central" dominant-baseline="central" y="32.5" x="75"><tspan dy="0" x="75">Tycho Stream</tspan></text></g></g><style>#mermaid-1{font-family:arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-1 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-1 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-1 .error-icon{fill:#552222;}#mermaid-1 .error-text{fill:#552222;stroke:#552222;}#mermaid-1 .edge-thickness-normal{stroke-width:1px;}#mermaid-1 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-1 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1 .marker{fill:#333333;stroke:#333333;}#mermaid-1 .marker.cross{stroke:#333333;}#mermaid-1 svg{font-family:arial,sans-serif;font-size:16px;}#mermaid-1 p{margin:0;}#mermaid-1 .actor{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mermaid-1 text.actor>tspan{fill:black;stroke:none;}#mermaid-1 .actor-line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);}#mermaid-1 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#mermaid-1 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#mermaid-1 #arrowhead path{fill:#333;stroke:#333;}#mermaid-1 .sequenceNumber{fill:white;}#mermaid-1 #sequencenumber{fill:#333;}#mermaid-1 #crosshead path{fill:#333;stroke:#333;}#mermaid-1 .messageText{fill:#333;stroke:none;}#mermaid-1 .labelBox{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mermaid-1 .labelText,#mermaid-1 .labelText>tspan{fill:black;stroke:none;}#mermaid-1 .loopText,#mermaid-1 .loopText>tspan{fill:black;stroke:none;}#mermaid-1 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);}#mermaid-1 .note{stroke:#aaaa33;fill:#fff5ad;}#mermaid-1 .noteText,#mermaid-1 .noteText>tspan{fill:black;stroke:none;}#mermaid-1 .activation0{fill:#f4f4f4;stroke:#666;}#mermaid-1 .activation1{fill:#f4f4f4;stroke:#666;}#mermaid-1 .activation2{fill:#f4f4f4;stroke:#666;}#mermaid-1 .actorPopupMenu{position:absolute;}#mermaid-1 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4));}#mermaid-1 .actor-man line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mermaid-1 .actor-man circle,#mermaid-1 line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;stroke-width:2px;}#mermaid-1 :root{--mermaid-font-family:arial,sans-serif;}</style><g></g><defs><symbol height="24" width="24" id="computer"><path d="M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z" transform="scale(.5)"></path></symbol></defs><defs><symbol clip-rule="evenodd" fill-rule="evenodd" id="database"><path d="M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z" transform="scale(.5)"></path></symbol></defs><defs><symbol height="24" width="24" id="clock"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z" transform="scale(.5)"></path></symbol></defs><defs><marker orient="auto-start-reverse" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="7.9" id="arrowhead"><path d="M -1 0 L 10 5 L 0 10 z"></path></marker></defs><defs><marker refY="4.5" refX="4" orient="auto" markerHeight="8" markerWidth="15" id="crosshead"><path style="stroke-dasharray:0, 0" d="M 1,2 L 6,7 M 6,2 L 1,7" stroke-width="1pt" stroke="#000000" fill="none"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="15.5" id="filled-head"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="40" markerWidth="60" refY="15" refX="15" id="sequencenumber"><circle r="6" cy="15" cx="15"></circle></marker></defs><text style="font-family:arial, sans-serif;font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="80" x="191">Protocol State Updates</text><line style="fill:none" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="109" x2="306" y1="109" x1="76"></line><text style="font-family:arial, sans-serif;font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="124" x="409">Store Pool States</text><line style="fill:none" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="153" x2="506" y1="153" x1="311"></line><text style="font-family:arial, sans-serif;font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="168" x="509">Update Graph</text><line style="fill:none" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="197" x2="706" y1="197" x1="311"></line><text style="font-family:arial, sans-serif;font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="212" x="823">Calculate New Routes</text><line style="fill:none" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="241" x2="934" y1="241" x1="711"></line><text style="font-family:arial, sans-serif;font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="256" x="1037">Evaluate Routes</text><line style="fill:none" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="285" x2="1134" y1="285" x1="939"></line><text style="font-family:arial, sans-serif;font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="300" x="1264">Execute Profitable Routes</text><line style="fill:none" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="329" x2="1389" y1="329" x1="1139"></line><text style="font-family:arial, sans-serif;font-size:16px;font-weight:400" dy="1em" class="messageText" alignment-baseline="middle" dominant-baseline="middle" text-anchor="middle" y="344" x="736">Transaction Results</text><line style="fill:none" marker-end="url(#arrowhead)" stroke="none" stroke-width="2" class="messageLine0" y2="373" x2="79" y1="373" x1="1392"></line></svg></p>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Processing Stages</strong>:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">State Updates</strong>: Pool states updated in real-time</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Graph Updates</strong>: Trading graph rebuilt incrementally</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Route Calculation</strong>: New routes calculated for affected pools</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Route Evaluation</strong>: Routes evaluated for profitability</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Execution</strong>: Profitable routes executed automatically</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="route-evaluation-triggering" class="vocs_Heading_slugTarget"></div>Route Evaluation Triggering<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#route-evaluation-triggering" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Route evaluation is triggered by state changes in the streaming system:</p>
<h4 class="vocs_H4 vocs_Heading"><div id="evaluation-conditions" class="vocs_Heading_slugTarget"></div>Evaluation Conditions<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#evaluation-conditions" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">Routes are evaluated when:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">New Pools Detected</strong>: New trading pairs added to the system</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Pool State Changes</strong>: Liquidity or rate changes in existing pools</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Periodic Re-evaluation</strong>: Scheduled evaluation of all routes</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Manual Triggers</strong>: CLI-triggered evaluation for testing</li>
</ol>
<h4 class="vocs_H4 vocs_Heading"><div id="evaluation-pipeline" class="vocs_Heading_slugTarget"></div>Evaluation Pipeline<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#evaluation-pipeline" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">async</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> evaluate_routes_continuously</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;mut</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Result</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;()&gt; {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    loop</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Get routes from queue</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        if</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> let</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Some</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(route) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">route_evaluation_queue</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">pop</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">            // Evaluate route</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> evaluation </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">route_analyzer</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">evaluate_route</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">route)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">            // Check if profitable</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> evaluation</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">execution_viable {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">                // Queue for execution</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">                self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">execution_queue</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">push</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">((route, evaluation))</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Process execution queue</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">        self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">process_execution_queue</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Small delay to prevent busy waiting</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">        tokio</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">time</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">sleep</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Duration</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">from_millis</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">10</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">))</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="cyclical-arbitrage-strategy" class="vocs_Heading_slugTarget"></div>Cyclical Arbitrage Strategy<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#cyclical-arbitrage-strategy" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The cyclical arbitrage strategy implements sophisticated route evaluation algorithms that analyze potential arbitrage opportunities across multiple DEX protocols.</p>
<h4 class="vocs_H4 vocs_Heading"><div id="route-evaluation-for-profitability" class="vocs_Heading_slugTarget"></div>Route Evaluation for Profitability<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#route-evaluation-for-profitability" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The RouteAnalyzer component uses real-time protocol states to calculate accurate swap amounts and profitability metrics:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">impl</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> RouteAnalyzer</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> async</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> evaluate_route</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        &amp;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        route</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Route</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        pool_store</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;dyn</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> PoolStore</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    ) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Result</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">RouteEvaluation</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt; {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Get current pool states</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> pool_states </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> pool_store</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">get_pool_states</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">route</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pools)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Calculate optimal input amount</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> optimal_amount </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">find_optimal_input_amount</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(route, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pool_states)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Calculate swap amounts using ProtocolSim</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> swap_result </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">protocol_sim</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">calculate_swap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            route,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            optimal_amount,</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            &amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">pool_states,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        )</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Apply V4 overflow protection</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> protected_amounts </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">apply_v4_overflow_protection</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            route,</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            &amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">swap_result,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        )</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Calculate profitability</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> profit </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">calculate_profitability</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            route,</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            &amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">protected_amounts,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        )</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">        Ok</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">RouteEvaluation</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            route_id</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> route</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">id</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">clone</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            input_amount</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> optimal_amount,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            output_amount</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> protected_amounts</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">final_output,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            profit</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> profit</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">net_profit,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            roi_percentage</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> profit</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">roi_percentage,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            gas_cost</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> profit</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">estimated_gas_cost,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            flash_loan_fee</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> profit</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">flash_loan_fee,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            execution_viable</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> profit</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">net_profit </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&gt;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0.0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        })</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h4 class="vocs_H4 vocs_Heading"><div id="optimal-amount-calculation" class="vocs_Heading_slugTarget"></div>Optimal Amount Calculation<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#optimal-amount-calculation" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The system uses a sophisticated <strong class="vocs_Strong">exponential search + binary search</strong> algorithm to find the optimal input amount:</p>
<h5 class="vocs_H5 vocs_Heading"><div id="phase-1-doubling-search-exponential-growth-1" class="vocs_Heading_slugTarget"></div>Phase 1: Doubling Search (Exponential Growth)<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#phase-1-doubling-search-exponential-growth-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h5>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Goal</strong>: Quickly find an upper bound for profitable input.</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">Set <code class="vocs_Code">A = A_min</code></li>
<li class="vocs_ListItem">Repeat for maximum iterations:<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Evaluate profit: <code class="vocs_Code">P = profit(A)</code></li>
<li class="vocs_ListItem">If <code class="vocs_Code">P &gt; P_best</code>, update best values</li>
<li class="vocs_ListItem">If profit drops below threshold, stop doubling</li>
<li class="vocs_ListItem">Else, double the input: <code class="vocs_Code">A = 2 * A</code></li>
</ul>
</li>
</ol>
<h5 class="vocs_H5 vocs_Heading"><div id="phase-2-binary-search-refinement-1" class="vocs_Heading_slugTarget"></div>Phase 2: Binary Search (Refinement)<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#phase-2-binary-search-refinement-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h5>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Goal</strong>: Refine the optimal input within <code class="vocs_Code">[A_min, A_max]</code>.</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem">While <code class="vocs_Code">A_max - A_min &gt; Œµ</code> and iterations &lt; max:<!-- -->
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem">Compute midpoint: <code class="vocs_Code">A_mid = (A_min + A_max) / 2</code></li>
<li class="vocs_ListItem">Evaluate profit at midpoint</li>
<li class="vocs_ListItem">Update best if midpoint is better</li>
<li class="vocs_ListItem">Update bounds based on profit comparison</li>
</ul>
</li>
</ol>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Mathematical Summary</strong>:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">maximize P(A) = profit from route given input A</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">subject to A_min ‚â§ A ‚â§ A_max, P(A) ‚â• profit_threshold</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">where A_max found via exponential doubling and A_best refined via binary search.</span></span></code></pre></div></div>
<h4 class="vocs_H4 vocs_Heading"><div id="solution-creation" class="vocs_Heading_slugTarget"></div>Solution Creation<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#solution-creation" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">Solution encoding transforms route evaluations into executable smart contract calldata:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> encode_solution</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(solution</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Solution</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, chain</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Chain</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> anyhow</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Result</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">EncodedSolution</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt; {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> encoder </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> TychoRouterEncoderBuilder</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">new</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        .</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">chain</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(chain)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        .</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">user_transfer_type</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">UserTransferType</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">TransferFrom</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        .</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">build</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> encoded_vec </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> encoder</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encode_solutions</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">vec!</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[solution])</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    Ok</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(encoded_vec</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">into_iter</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">next</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">expect</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Expected at least one encoded solution&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">))</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Key Features</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">TychoRouterEncoderBuilder</strong>: Uses Tycho&#x27;s encoder for ABI-compliant calldata</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Flash Loan Integration</strong>: Encodes flash loan parameters and sequential swaps</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Gas Optimization</strong>: Optimizes transaction parameters for execution</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Multi-protocol Support</strong>: Handles V2, V3, V4 protocol differences</li>
</ul>
<h4 class="vocs_H4 vocs_Heading"><div id="signal-generation" class="vocs_Heading_slugTarget"></div>Signal Generation<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#signal-generation" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The system generates execution signals for profitable routes:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">#[derive(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Debug</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Clone</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Serialize</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Deserialize</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)]</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> RouteSignal</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> route_id</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> route</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> MinimalRoute</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> evaluation</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> RouteEvaluation</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> timestamp</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> SystemTime</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> execution_attempts</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> u32</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> priority_score</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> f64</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> status</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> SignalStatus</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">#[derive(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Debug</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Clone</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Serialize</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Deserialize</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)]</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> enum</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> SignalStatus</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    Pending</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    Evaluating</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    ReadyForExecution</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    Executing</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    Executed</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    Failed</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    Expired</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Signal Flow</strong>:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Route Discovery</strong> ‚Üí Create RouteSignal</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Evaluation Phase</strong> ‚Üí Check profitability</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Execution Phase</strong> ‚Üí Execute if profitable</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Result Processing</strong> ‚Üí Update signal status</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="execution-engine" class="vocs_Heading_slugTarget"></div>Execution Engine<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#execution-engine" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The Execution Engine handles the actual transaction execution with comprehensive error handling and retry logic:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">impl</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> ExecutionEngine</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> async</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> execute_signal</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;mut</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, signal</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">RouteSignal</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Result</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">EvaluationResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt; {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Pre-flight simulation</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> simulation_result </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">preflight_simulation</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(signal)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        if</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> !</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">simulation_result</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">success {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            return</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Err</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">anyhow</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">anyhow!</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Pre-flight simulation failed&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">));</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Check account balance</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> balance_check </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">check_account_balance</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(signal)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        if</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> !</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">balance_check</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">sufficient {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">            return</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Err</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">anyhow</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">anyhow!</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Insufficient balance&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">));</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Encode solution</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> encoded_solution </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encode_solution</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(signal)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Send transaction</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> tx_hash </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">send_flash_transaction</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(signal, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">encoded_solution)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Wait for confirmation</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> receipt </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">wait_for_confirmation</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(tx_hash)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">        // Parse execution result</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> result </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">parse_execution_result</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">receipt, signal)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">        Ok</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(result)</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Key Features</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">EIP-1559 Support</strong>: Modern transaction format with dynamic gas pricing</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Balance Validation</strong>: Pre-execution balance checks</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Retry Logic</strong>: Automatic retry with nonce synchronization</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Gas Optimization</strong>: Optimized gas parameters for cost efficiency</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Transaction Monitoring</strong>: Real-time transaction status tracking</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="flash-loan-and-sequential-swap-mappings" class="vocs_Heading_slugTarget"></div>Flash Loan and Sequential Swap Mappings<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#flash-loan-and-sequential-swap-mappings" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The system implements sophisticated flash loan integration with sequential swap execution:</p>
<h4 class="vocs_H4 vocs_Heading"><div id="flash-loan-selection" class="vocs_Heading_slugTarget"></div>Flash Loan Selection<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#flash-loan-selection" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">async</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> find_best_flash_loan_pool_with_v4_eligibility</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    &amp;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    token</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Bytes</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    _amount_needed</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> u128</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    streamed_states</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;dyn</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> PoolStore</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    excluded_pool_ids</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Option</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    route_info</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Option</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">str</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    route_tokens</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Option</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Bytes</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">]&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    route_has_v4_pools</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> bool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    input_token_is_v4_eligible</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> bool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Result</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Option</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">FlashLoanCandidate</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;&gt; {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    let</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> mut</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> flash_loan_candidates </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Vec</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">new</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">();</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // V4 Addition: If input token is v4 eligible and route has no V4 pools</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> input_token_is_v4_eligible </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;&amp;</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> !</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">route_has_v4_pools {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> synthetic_pool </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">create_v4_pool_manager_synthetic_pool</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(token);</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> candidate </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> FlashLoanCandidate</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">new</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            synthetic_pool,</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">            FlashLoanProvider</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">UniswapV4</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">            1000000.0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">// Assume very high liquidity for PoolManager</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        );</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        flash_loan_candidates</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">push</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(candidate);</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // V3 Additions: Find all V3 pools containing the token</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // ... V3 pool selection logic</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Return best candidate based on score</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    flash_loan_candidates</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">sort_by</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">|</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">a, b</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">|</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> b</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">score</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">partial_cmp</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">a</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">score)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">unwrap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">());</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    Ok</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(flash_loan_candidates</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">first</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">cloned</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">())</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h4 class="vocs_H4 vocs_Heading"><div id="sequential-swap-execution" class="vocs_Heading_slugTarget"></div>Sequential Swap Execution<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#sequential-swap-execution" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The system executes multi-hop swaps atomically through flash loans:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Flash Loan Borrow</strong>: Borrow required tokens from selected pool</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Sequential Swaps</strong>: Execute swaps in sequence through route</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Flash Loan Repay</strong>: Repay borrowed tokens with profit</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Profit Capture</strong>: Keep remaining profit after repayment</li>
</ol>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Example Execution Flow</strong>:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">Route: [USDC ‚Üí WETH ‚Üí MOJO ‚Üí USDC]</span></span>
<span class="line vocs_Span"><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">1.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> Borrow 1000 USDC via flash loan</span></span>
<span class="line vocs_Span"><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">2.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> Swap 1000 USDC ‚Üí 0.4 WETH (Uniswap V3)</span></span>
<span class="line vocs_Span"><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">3.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> Swap 0.4 WETH ‚Üí 1000 MOJO (Uniswap V2)</span></span>
<span class="line vocs_Span"><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">4.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> Swap 1000 MOJO ‚Üí 1000.96 USDC (Uniswap V2)</span></span>
<span class="line vocs_Span"><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">5.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> Repay 1000 USDC + 0.9 USDC fee = 1000.9 USDC</span></span>
<span class="line vocs_Span"><span style="color:#E36209;--shiki-dark:#F69D50" class="vocs_Span">6.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> Keep 0.06 USDC profit</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="encoding" class="vocs_Heading_slugTarget"></div>Encoding<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#encoding" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The encoding system converts route evaluations into executable smart contract calldata:</p>
<h4 class="vocs_H4 vocs_Heading"><div id="tychorouterencoderbuilder-integration" class="vocs_Heading_slugTarget"></div>TychoRouterEncoderBuilder Integration<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#tychorouterencoderbuilder-integration" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> encode_solution</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(solution</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Solution</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, chain</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Chain</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> anyhow</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Result</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">EncodedSolution</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt; {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> encoder </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> TychoRouterEncoderBuilder</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">new</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        .</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">chain</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(chain)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        .</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">user_transfer_type</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">UserTransferType</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">TransferFrom</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        .</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">build</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> encoded_vec </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> encoder</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encode_solutions</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">vec!</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[solution])</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    Ok</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(encoded_vec</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">into_iter</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">next</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">expect</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;Expected at least one encoded solution&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">))</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Encoding Features</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">ABI Compliance</strong>: Standardized function call encoding</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Multi-protocol Support</strong>: Handles V2, V3, V4 protocol differences</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Gas Optimization</strong>: Minimizes calldata size</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Error Handling</strong>: Comprehensive validation and error reporting</li>
</ul>
<h4 class="vocs_H4 vocs_Heading"><div id="calldata-structure" class="vocs_Heading_slugTarget"></div>Calldata Structure<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#calldata-structure" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The encoded calldata includes:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Flash Loan Parameters</strong>: Pool address, token, amount, fee</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Swap Parameters</strong>: Route, amounts, protocols</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Execution Metadata</strong>: Gas limits, deadlines, slippage</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Callback Data</strong>: Post-swap execution parameters</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="execution" class="vocs_Heading_slugTarget"></div>Execution<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#execution" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The execution system manages transaction lifecycle from creation to confirmation:</p>
<h4 class="vocs_H4 vocs_Heading"><div id="transaction-building" class="vocs_Heading_slugTarget"></div>Transaction Building<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#transaction-building" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">async</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> build_transaction</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, signal</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">RouteSignal</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Result</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">TransactionRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt; {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> encoded_solution </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encode_solution</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(signal)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">    Ok</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">TransactionRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        to</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Some</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">config</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">router_address</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">into</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        data</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Some</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(encoded_solution</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">calldata</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">into</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        gas</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Some</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">U256</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">from</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">estimate_gas</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(signal)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        gas_price</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Some</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">get_current_gas_price</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        value</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Some</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">U256</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">ZERO</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        from</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Some</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">signer</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()),</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        ..</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Default</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">default</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    })</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h4 class="vocs_H4 vocs_Heading"><div id="execution-flow" class="vocs_Heading_slugTarget"></div>Execution Flow<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#execution-flow" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Pre-flight Validation</strong>: Simulate transaction before sending</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Gas Estimation</strong>: Calculate optimal gas parameters</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Transaction Submission</strong>: Send to network</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Confirmation Waiting</strong>: Monitor transaction status</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Result Parsing</strong>: Extract execution results</li>
</ol>
<h3 class="vocs_H3 vocs_Heading"><div id="preflight-evaluation" class="vocs_Heading_slugTarget"></div>PreFlight Evaluation<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#preflight-evaluation" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">Pre-flight evaluation simulates transactions before execution to validate profitability:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">async</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> preflight_simulation</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, signal</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">RouteSignal</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Result</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">SimulationResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt; {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> encoded_solution </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">encode_solution</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(signal)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Create simulation transaction</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> simulation_tx </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> TransactionRequest</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        to</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Some</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">config</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">router_address</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">into</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        data</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Some</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(encoded_solution</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">calldata</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">into</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        gas</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Some</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">U256</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">from</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">config</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">preflight_gas_limit)),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        gas_price</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Some</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">get_current_gas_price</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        value</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Some</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">U256</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">ZERO</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        from</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Some</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">signer</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">address</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()),</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        ..</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">Default</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">default</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">()</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    };</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Execute simulation</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    match</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">client</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">call</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">simulation_tx, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">None</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">        Ok</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(_) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Ok</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">SimulationResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            success</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> true</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            error_message</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> String</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">new</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            gas_used</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        }),</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">        Err</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(e) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=&gt;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">            // Log the failure but don&#x27;t stop execution</span></span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">            tracing</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">warn!</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">                &quot;Pre-flight simulation failed for route {}: {}&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">                signal</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">route_id,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">                e</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            );</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">            Ok</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">SimulationResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">                success</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> false</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">                error_message</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> e</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">to_string</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(),</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">                gas_used</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            })</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Critical Issue</strong>: There is a <strong class="vocs_Strong">critical issue</strong> in the current preflight simulation implementation where <code class="vocs_Code">eth_call</code> failures are logged but <strong class="vocs_Strong">not used to stop execution</strong>. This can lead to failed transactions being sent to the network.</p>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Recommended Fix</strong>:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">async</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> execute_signal</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;mut</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, signal</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">RouteSignal</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Result</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">EvaluationResult</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt; {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Pre-flight simulation</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> simulation_result </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> self</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">preflight_simulation</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(signal)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.await?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // CRITICAL FIX: Actually check simulation result</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    if</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> !</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">simulation_result</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">success {</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">        return</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Err</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">anyhow</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">anyhow!</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span></span>
<span class="line vocs_Span"><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">            &quot;Pre-flight simulation failed: {}&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">            simulation_result</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">error_message</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">        ));</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    }</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Continue with execution...</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="profitability-logging" class="vocs_Heading_slugTarget"></div>Profitability Logging<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#profitability-logging" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The system provides comprehensive profitability logging and analysis:</p>
<h4 class="vocs_H4 vocs_Heading"><div id="profitability-calculation-1" class="vocs_Heading_slugTarget"></div>Profitability Calculation<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#profitability-calculation-1" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h4>
<p class="vocs_Paragraph">The mathematical formulas for profitability calculation:</p>
<h5 class="vocs_H5 vocs_Heading"><div id="1-swap-profit-percentage" class="vocs_Heading_slugTarget"></div>1. Swap Profit Percentage<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#1-swap-profit-percentage" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h5>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">swap_profit_percentage = ((amount_out - amount_in) / amount_in) * 100</span></span></code></pre></div></div>
<h5 class="vocs_H5 vocs_Heading"><div id="2-flash-fee-percentage" class="vocs_Heading_slugTarget"></div>2. Flash Fee Percentage<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#2-flash-fee-percentage" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h5>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">flash_fee_pct = (flash_loan_fee / amount_in) * 100</span></span></code></pre></div></div>
<h5 class="vocs_H5 vocs_Heading"><div id="3-net-profit-percentage" class="vocs_Heading_slugTarget"></div>3. Net Profit Percentage<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#3-net-profit-percentage" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h5>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">net_profit_percentage = swap_profit_percentage - flash_fee_pct - gas_cost_pct</span></span></code></pre></div></div>
<h5 class="vocs_H5 vocs_Heading"><div id="4-net-profit-in-token-units" class="vocs_Heading_slugTarget"></div>4. Net Profit in Token Units<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#4-net-profit-in-token-units" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h5>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">net_profit_token = amount_out - amount_in - flash_loan_fee - gas_cost_token</span></span></code></pre></div></div>
<h3 class="vocs_H3 vocs_Heading"><div id="persistence-mechanism" class="vocs_Heading_slugTarget"></div>Persistence Mechanism<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#persistence-mechanism" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The persistence system uses RocksDB with optimized column families for different data types:</p>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Database Configuration</strong>:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> cf_names </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> vec!</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">[</span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;tokens&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;graph&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;routes&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#032F62;--shiki-dark:#96D0FF" class="vocs_Span">&quot;signals&quot;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">];</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> db </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> Arc</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">new</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">DB</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">::</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span">open_cf</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">opts, db_path, </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">cf_names)</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">?</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span></code></pre></div></div>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Write Optimization</strong>:</p>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Batch Writes</strong>: 100 operations per batch</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Async Flushing</strong>: 100ms flush interval</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Memory Buffering</strong>: In-memory caching before persistence</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Incremental Updates</strong>: Only persist changed data</li>
</ul>
<h3 class="vocs_H3 vocs_Heading"><div id="queuing-configuration" class="vocs_Heading_slugTarget"></div>Queuing Configuration<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#queuing-configuration" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h3>
<p class="vocs_Paragraph">The system uses multiple queues for different processing stages:</p>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Queue Types</strong>:</p>
<ol class="vocs_List vocs_List_ordered">
<li class="vocs_ListItem"><strong class="vocs_Strong">Streaming Queue</strong>: Raw blockchain data processing</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Evaluation Queue</strong>: Route profitability evaluation</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Execution Queue</strong>: Transaction execution</li>
<li class="vocs_ListItem"><strong class="vocs_Strong">Signal Queue</strong>: Arbitrage opportunity signals</li>
</ol>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Queue Management</strong>:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">pub</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> struct</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> ExecutionQueue</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    queue</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> VecDeque</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;(</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">MinimalRoute</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">RouteEvaluation</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">)&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    max_queue_size</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> usize</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    priority_scores</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> HashMap</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&lt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">String</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, </span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">f64</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">&gt;,</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<p class="vocs_Paragraph"><strong class="vocs_Strong">Priority Calculation</strong>:</p>
<div class="vocs_CodeBlock"><div class="vocs_Pre_wrapper"><pre style="background-color:#fff;--shiki-dark-bg:#22272e;color:#24292e;--shiki-dark:#adbac7" tabindex="0" class="shiki shiki-themes github-light github-dark-dimmed vocs_Pre"><button class="vocs_CopyButton" data-copied="false" type="button"><div aria-label="Copy" class="vocs_Icon" role="img" style="--vocs_Icon_size:18px"><svg width="100%" height="100%" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M5 2V1H10V2H5ZM4.75 0C4.33579 0 4 0.335786 4 0.75V1H3.5C2.67157 1 2 1.67157 2 2.5V12.5C2 13.3284 2.67157 14 3.5 14H7V13H3.5C3.22386 13 3 12.7761 3 12.5V2.5C3 2.22386 3.22386 2 3.5 2H4V2.25C4 2.66421 4.33579 3 4.75 3H10.25C10.6642 3 11 2.66421 11 2.25V2H11.5C11.7761 2 12 2.22386 12 2.5V7H13V2.5C13 1.67157 12.3284 1 11.5 1H11V0.75C11 0.335786 10.6642 0 10.25 0H4.75ZM9 8.5C9 8.77614 8.77614 9 8.5 9C8.22386 9 8 8.77614 8 8.5C8 8.22386 8.22386 8 8.5 8C8.77614 8 9 8.22386 9 8.5ZM10.5 9C10.7761 9 11 8.77614 11 8.5C11 8.22386 10.7761 8 10.5 8C10.2239 8 10 8.22386 10 8.5C10 8.77614 10.2239 9 10.5 9ZM13 8.5C13 8.77614 12.7761 9 12.5 9C12.2239 9 12 8.77614 12 8.5C12 8.22386 12.2239 8 12.5 8C12.7761 8 13 8.22386 13 8.5ZM14.5 9C14.7761 9 15 8.77614 15 8.5C15 8.22386 14.7761 8 14.5 8C14.2239 8 14 8.22386 14 8.5C14 8.77614 14.2239 9 14.5 9ZM15 10.5C15 10.7761 14.7761 11 14.5 11C14.2239 11 14 10.7761 14 10.5C14 10.2239 14.2239 10 14.5 10C14.7761 10 15 10.2239 15 10.5ZM14.5 13C14.7761 13 15 12.7761 15 12.5C15 12.2239 14.7761 12 14.5 12C14.2239 12 14 12.2239 14 12.5C14 12.7761 14.2239 13 14.5 13ZM14.5 15C14.7761 15 15 14.7761 15 14.5C15 14.2239 14.7761 14 14.5 14C14.2239 14 14 14.2239 14 14.5C14 14.7761 14.2239 15 14.5 15ZM8.5 11C8.77614 11 9 10.7761 9 10.5C9 10.2239 8.77614 10 8.5 10C8.22386 10 8 10.2239 8 10.5C8 10.7761 8.22386 11 8.5 11ZM9 12.5C9 12.7761 8.77614 13 8.5 13C8.22386 13 8 12.7761 8 12.5C8 12.2239 8.22386 12 8.5 12C8.77614 12 9 12.2239 9 12.5ZM8.5 15C8.77614 15 9 14.7761 9 14.5C9 14.2239 8.77614 14 8.5 14C8.22386 14 8 14.2239 8 14.5C8 14.7761 8.22386 15 8.5 15ZM11 14.5C11 14.7761 10.7761 15 10.5 15C10.2239 15 10 14.7761 10 14.5C10 14.2239 10.2239 14 10.5 14C10.7761 14 11 14.2239 11 14.5ZM12.5 15C12.7761 15 13 14.7761 13 14.5C13 14.2239 12.7761 14 12.5 14C12.2239 14 12 14.2239 12 14.5C12 14.7761 12.2239 15 12.5 15Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div></button><code class="vocs_Code"><span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">fn</span><span style="color:#6F42C1;--shiki-dark:#DCBDFB" class="vocs_Span"> calculate_priority</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">(</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">&amp;</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span">self</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, route</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">MinimalRoute</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">, evaluation</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">:</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> &amp;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span">RouteEvaluation</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">) </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">-&gt;</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> f64</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> {</span></span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Higher profit = higher priority</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> profit_score </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> evaluation</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">net_profit_percentage;</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Shorter routes = higher priority (less gas)</span></span>
<span class="line vocs_Span"><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">    let</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> gas_score </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">=</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 1.0</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> /</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> (route</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">.</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">hops </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">as</span><span style="color:#6F42C1;--shiki-dark:#F69D50" class="vocs_Span"> f64</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> +</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 1.0</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">);</span></span>
<span class="line vocs_Span" data-empty-line="true"> </span>
<span class="line vocs_Span"><span style="color:#6A737D;--shiki-dark:#768390" class="vocs_Span">    // Combine scores</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">    profit_score </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0.7</span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span"> +</span><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span"> gas_score </span><span style="color:#D73A49;--shiki-dark:#F47067" class="vocs_Span">*</span><span style="color:#005CC5;--shiki-dark:#6CB6FF" class="vocs_Span"> 0.3</span></span>
<span class="line vocs_Span"><span style="color:#24292E;--shiki-dark:#ADBAC7" class="vocs_Span">}</span></span></code></pre></div></div>
<h2 class="vocs_H2 vocs_Heading"><div id="references" class="vocs_Heading_slugTarget"></div>References<a class="vocs_Anchor vocs_Autolink" aria-hidden="true" tabindex="-1" href="/research/solving/solving#references" data-discover="true"><div data-autolink-icon="true" class="vocs_Div vocs_AutolinkIcon" style="--vocs_AutolinkIcon_iconUrl:url(/.vocs/icons/link.svg)"></div></a></h2>
<ul class="vocs_List vocs_List_unordered">
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://en.wikipedia.org/wiki/Bellman%E2%80%93Ford_algorithm" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Bellman-Ford Alogorithm</a></li>
<li class="vocs_ListItem"><a class="vocs_Anchor vocs_Link vocs_Link_accent" href="https://en.wikipedia.org/wiki/Depth-first_search" target="_blank" rel="noopener noreferrer" style="--vocs_ExternalLink_iconUrl:url(/.vocs/icons/arrow-diagonal.svg)">Depth First Search Algorithm</a></li>
</ul><style>
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}
</style></article><footer class="vocs_Footer" data-layout="docs"><div class="vocs_Footer_container"></div></footer></div><div data-bottom-observer="true"></div></div></div>
  </body>
</html>
